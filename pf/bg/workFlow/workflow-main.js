(function(e){function t(t){for(var r,i,s=t[0],c=t[1],u=t[2],d=0,p=[];d<s.length;d++)i=s[d],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&p.push(o[i][0]),o[i]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);l&&l(t);while(p.length)p.shift()();return a.push.apply(a,u||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],r=!0,s=1;s<n.length;s++){var c=n[s];0!==o[c]&&(r=!1)}r&&(a.splice(t--,1),e=i(i.s=n[0]))}return e}var r={},o={app:0},a=[];function i(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=r,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var u=0;u<s.length;u++)t(s[u]);var l=c;a.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("cd49")},"357e":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"i",(function(){return onSignSuccess})),__webpack_require__.d(__webpack_exports__,"g",(function(){return EnvInit})),__webpack_require__.d(__webpack_exports__,"f",(function(){return EnvExit})),__webpack_require__.d(__webpack_exports__,"j",(function(){return start})),__webpack_require__.d(__webpack_exports__,"d",(function(){return ESeaL_InsertStamp})),__webpack_require__.d(__webpack_exports__,"h",(function(){return checkKey})),__webpack_require__.d(__webpack_exports__,"e",(function(){return ESeaL_SetSealPosAndSign})),__webpack_require__.d(__webpack_exports__,"c",(function(){return ESeaL_GetSignatureData})),__webpack_require__.d(__webpack_exports__,"a",(function(){return ESeaL_GetMethod})),__webpack_require__.d(__webpack_exports__,"b",(function(){return ESeaL_GetPic}));var C_Users_yuan_Desktop_jquery_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("c97b"),C_Users_yuan_Desktop_jquery_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(C_Users_yuan_Desktop_jquery_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__),ant_design_vue_es_message_style__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("a5a5"),ant_design_vue_es_message__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("5473"),_XTXSAB__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("7cfd");function asyncGeneratorStep(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,o)}function _asyncToGenerator(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){asyncGeneratorStep(a,r,o,i,s,"next",e)}function s(e){asyncGeneratorStep(a,r,o,i,s,"throw",e)}i(void 0)}))}}var $_$sealImg=new Image,$_$bPos=!1,$_$WebSocketConnectState=!1,$_$WebSign_AppObj=null,$_$WebSign_WebSocketObj=null,$_$WebSign_CurrentObj=null,$_$Org_Data="",$_$Signature="",$_$Org_Data_field_name="",$_$Cur_CertID="",$_$bReSign=!1,$_$Seal_Pic_Main_Div_Name="",$_$Seal_Pic_Div_Name="",$_$Seal_Img_Name="",$_$Signature_Element_Name="",$_$OriginData_Element_Name="",$_$Method_Element_Name="",$_$Method_Name="",$_$bJustShow=!1,$_$bUseSHA256=!1,$_$SGD_SM3_RSA=65537,$_$SGD_SHA1_RSA=65538,$_$SGD_SHA256_RSA=65540,$_$SGD_SM3_SM2=131329,$_$SELECT_OPTION_VALUE="------select------",$_$container_Element_Name="",cur_cert_id="",ctx=null,signSuccessCallback,signDefaultText,webSignRequired=!1,password="",maxConntectServerTimes=3;function onSignSuccess(e){signSuccessCallback=e}function EnvInit(){return _EnvInit.apply(this,arguments)}function _EnvInit(){return _EnvInit=_asyncToGenerator(C_Users_yuan_Desktop_jquery_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark((function e(){return C_Users_yuan_Desktop_jquery_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(console.log("EnvInit"),webSignRequired=!0,_XTXSAB__WEBPACK_IMPORTED_MODULE_3__["b"](),window.isWebSignReady?$_$WebSign_WebSocketObj=window.webSignSocketObject:(maxConntectServerTimes=3,window.webSignSocketObject=$_$WebSign_WebSocketObj=CreateWebSocketObject_WebSign()),null==$_$WebSign_WebSocketObj){e.next=7;break}return $_$WebSign_CurrentObj=$_$WebSign_WebSocketObj,e.abrupt("return");case 7:$_$WebSign_AppObj=CreateAppObject_WebSign("SignObj",null,null,null,null,null,null),null!=$_$WebSign_AppObj&&($_$WebSign_CurrentObj=$_$WebSign_AppObj);case 9:case"end":return e.stop()}}),e)}))),_EnvInit.apply(this,arguments)}function EnvExit(){console.log("EnvExit"),webSignRequired=!1,_XTXSAB__WEBPACK_IMPORTED_MODULE_3__["a"]()}function start(e,t){return _start.apply(this,arguments)}function _start(){return _start=_asyncToGenerator(C_Users_yuan_Desktop_jquery_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark((function e(t,n){var r,o;return C_Users_yuan_Desktop_jquery_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(signDefaultText=t,_XTXSAB__WEBPACK_IMPORTED_MODULE_3__["i"]()){e.next=7;break}return e.next=4,setTimeout((function(){}),1e3);case 4:if(_XTXSAB__WEBPACK_IMPORTED_MODULE_3__["i"]()){e.next=7;break}return ant_design_vue_es_message__WEBPACK_IMPORTED_MODULE_2__["a"].error("检查证书应用环境出错"),e.abrupt("return");case 7:if(r=0,$_$WebSocketConnectState){e.next=12;break}return o=function e(){$_$WebSocketConnectState?n():r>3?ant_design_vue_es_message__WEBPACK_IMPORTED_MODULE_2__["a"].error("初始化签章核心服务出错!"):(r++,e())},setTimeout(o,1e3),e.abrupt("return");case 12:return n(),e.abrupt("return");case 14:case"end":return e.stop()}}),e)}))),_start.apply(this,arguments)}function $myOKRtnFunc(e,t,n){if("function"==typeof t){var r={retVal:e,ctx:n};t(r)}return e}function $myErrorRtnFunc(e,t,n){if("function"==typeof t){var r={retVal:e,ctx:n};t(r)}return e}function $SelectSealDlg(e,t,n,r,o,a,i,s){var c=300,u=135,l="#336699",d=document.body.offsetWidth+document.body.scrollLeft,p=screen.height+document.body.scrollHeight,f=document.createElement("div");f.setAttribute("id","bgDiv"),f.style.position="absolute",f.style.top="0",f.style.background="#777",f.style.filter="progid:DXImageTransform.Microsoft.Alpha(style=3,opacity=25,finishOpacity=75",f.style.opacity="0.6",f.style.left="0",f.style.width=d+"px",f.style.height=p+"px",f.style.zIndex="10000",document.body.appendChild(f);var h=document.createElement("div");h.setAttribute("id","msgDiv"),h.setAttribute("align","center"),h.style.background="white",h.style.border="1px solid "+l,h.style.position="absolute",h.style.left="50%",h.style.top="50%",h.style.font="12px/1.6em Verdana, Geneva, Arial, Helvetica, sans-serif",h.style.marginLeft="-125px",h.style.marginTop=-75+document.body.scrollTop+"px",h.style.width=c+"px",h.style.height=u+"px",h.style.textAlign="center",h.style.lineHeight="25px",h.style.zIndex="10001";var y=document.createElement("h4");y.setAttribute("id","msgTitle"),y.setAttribute("align","left"),y.style.margin="0",y.style.padding="3px",y.style.background=l,y.style.filter="progid:DXImageTransform.Microsoft.Alpha(startX=20, startY=20, finishX=100, finishY=100,style=1,opacity=75,finishOpacity=100);",y.style.opacity="0.75",y.style.border="1px solid "+l,y.style.height="18px",y.style.font="12px Verdana, Geneva, Arial, Helvetica, sans-serif",y.style.color="white",y.style.cursor="default",y.innerHTML="网页签章";var m=document.createElement("div");function _(e,t){var n=document.createElement("select");n.setAttribute("id","selectSeal");var r=document.createElement("option");r.value=$_$SELECT_OPTION_VALUE,r.text=$_$SELECT_OPTION_VALUE,r.innerHTML=$_$SELECT_OPTION_VALUE,n.appendChild(r);for(var o=0;o<t.length;o++){var a=t[o],i=new Option(a.certName,a.certID);n.options.add(i)}return n}m.setAttribute("id","selectText"),m.setAttribute("align","center"),m.style.background="white",m.style.position="absolute",m.style.left="8%",m.style.top="25%",m.style.font="12px/1.6em Verdana, Geneva, Arial, Helvetica, sans-serif",m.innerHTML="请选择印章：",m.appendChild(_("------请选择------",e));var b=document.createElement("input");function g(){var e=document.getElementById("selectSeal");cur_cert_id=e.options[e.selectedIndex].value,document.getElementById("msgDiv").removeChild(m),document.body.removeChild(f),document.body.removeChild(h),cur_cert_id!=$_$SELECT_OPTION_VALUE?($_$Cur_CertID=cur_cert_id,""!=$_$Cur_CertID?GetPic($_$Cur_CertID,(function(e){if(""!=e.retVal){var c=document.getElementById(r);c.src="data:image/gif;base64,"+e.retVal,$_$sealImg.src="data:image/gif;base64,"+e.retVal,o?(document.getElementById(n).style.display="block",document.getElementById(t).style.display="block",$_$bPos=!1,$_$bReSign=!1):$SignDataPKCS1(n,a,i,s)}else $GetLastErr()}),null):alert("CertID为空！")):alert("证书选择错误!")}b.setAttribute("type","button"),b.setAttribute("value","确定"),b.style.width="60px",b.style.height="28px",b.style.textAlign="center",b.style.position="absolute",b.style.left="15%",b.style.top="75%",b.style.background=l,b.style.border="1px solid "+l,b.style.color="white",b.onclick=g;var v=document.createElement("input");function w(){cur_cert_id="",document.body.removeChild(f),document.body.removeChild(h),document.getElementById(n).style.display="none"}v.setAttribute("type","button"),v.setAttribute("value","取消"),v.style.width="60px",v.style.height="28px",v.style.textAlign="center",v.style.position="absolute",v.style.left="65%",v.style.top="75%",v.style.background=l,v.style.border="1px solid "+l,v.style.color="white",v.onclick=w,document.body.appendChild(h),document.getElementById("msgDiv").appendChild(y),document.getElementById("msgDiv").appendChild(m),document.getElementById("msgDiv").appendChild(v),document.getElementById("msgDiv").appendChild(b)}function $DragSeal(e,t,n){_XTXSAB__WEBPACK_IMPORTED_MODULE_3__["e"]((function(r){if(""!=r.retVal){var o=r.retVal,a=[];while(1){var i=o.indexOf("&&&");if(i<=0)break;var s=o.substring(0,i),c=s.substring(0,s.indexOf("||")),u=s.substring(s.indexOf("||")+2,s.length);a.push({certName:c,certID:u});var l=o.length;o=o.substring(i+3,l)}var d=a.length;if(0==d)ant_design_vue_es_message__WEBPACK_IMPORTED_MODULE_2__["a"].error("未能检测到usbkey！");else if(1==d){var p=a[0];if($_$Cur_CertID=p.certID,""==$_$Cur_CertID)return void ant_design_vue_es_message__WEBPACK_IMPORTED_MODULE_2__["a"].error("CertID为空！");GetPic($_$Cur_CertID,(function(r){if(""!=r.retVal){var o=document.getElementById(n);o.src="data:image/gif;base64,"+r.retVal,$_$sealImg.src="data:image/gif;base64,"+r.retVal;var a=document.getElementById(t);a.style.display="block";var i=document.getElementById(e);i.style.display="block",$_$bPos=!1,$_$bReSign=!1}else $GetLastErr()}),null)}else $SelectSealDlg(a,e,t,n,!0,null,null,null)}else ant_design_vue_es_message__WEBPACK_IMPORTED_MODULE_2__["a"].error("没有发现用户key！")}))}function GetPic(e,t,n){return null!=$_$WebSign_WebSocketObj&&void 0!=$_$WebSign_WebSocketObj.ESeaL_GetStampPic?$_$WebSign_WebSocketObj.ESeaL_GetStampPic(e,t,n):null!=$_$WebSign_AppObj&&void 0!=$_$WebSign_AppObj.GetStampPicFromUKey?$_$WebSign_AppObj.GetStampPicFromUKey(e,t,n):$myErrorRtnFunc("",t,n)}function GetSignMethod(){var e;return null!=$_$WebSign_WebSocketObj?e=$_$Method_Name:null!=$_$WebSign_AppObj&&void 0!=$_$WebSign_AppObj.GetSignMethod&&$_$WebSign_AppObj.GetSignMethod((function(t){""!=t.retVal?e=t.retVal:$GetLastErr()}),null),e}function ESeaL_InsertStamp(e,t,n,r){if(""!=n){var o=document.getElementById(n).value||signDefaultText;if(""!=o){deleteSigDiv(e);var a="sealPicMain"+e,i=document.createElement("div");if(i.setAttribute("id",a),i.className=a,t){var s=document.getElementById(t);s&&s.appendChild(i)}else t="BODY",document.body.appendChild(i);var c="sealPicDiv"+e,u=document.createElement("div");u.setAttribute("id",c),u.className=c,u.style.position="absolute",u.style.left="100px",u.style.top="100px",u.style.display="none",document.getElementById(a).appendChild(u);var l="sealImg"+e,d=document.createElement("img");d.setAttribute("id",l),document.getElementById(c).appendChild(d);var p="signatureElement"+e,f=document.createElement("input");f.type="hidden",f.setAttribute("id",p),f.className=p,document.getElementById(a).appendChild(f);var h="originDataElement"+e,y=document.createElement("input");y.type="hidden",y.setAttribute("id",h),y.className=h,document.getElementById(a).appendChild(y),document.getElementById(h).value=n;var m="methodElement"+e,_=document.createElement("input");_.type="hidden",_.setAttribute("id",m),_.className=m,document.getElementById(a).appendChild(_),document.getElementById(m).value="无信息";var b="containerElement"+e,g=document.createElement("input");g.type="hidden",g.setAttribute("id",b),g.className=b,document.getElementById(a).appendChild(g),document.getElementById(b).value=t,$_$Seal_Pic_Main_Div_Name=a,$_$Seal_Pic_Div_Name=c,$_$Signature_Element_Name=p,$_$OriginData_Element_Name=h,$_$Seal_Img_Name=l,$_$Method_Element_Name=m,$_$container_Element_Name=b;e=$_$Seal_Pic_Div_Name.substr(10);$CreateSignMenu(e),r?($DragSeal($_$Seal_Pic_Main_Div_Name,$_$Seal_Pic_Div_Name,$_$Seal_Img_Name),$_$bJustShow=!1):($_$bPos=!1,$_$bReSign=!1),document.ondragstart=function(){return!1}}else ant_design_vue_es_message__WEBPACK_IMPORTED_MODULE_2__["a"].error("表单原数据为空！")}else ant_design_vue_es_message__WEBPACK_IMPORTED_MODULE_2__["a"].error("表单名称为空！")}function deleteSigDiv(e){var t="sealPicMain"+e,n=document.getElementById(t);null!=n&&n.parentNode.removeChild(n)}function $SignData(e,t,n,r){ctx=null,_XTXSAB__WEBPACK_IMPORTED_MODULE_3__["g"](e,n,(function(n){if(""==n.retVal)return alert("xtx签名失败"),$_$bReSign||(document.getElementById(t).style.display="none"),$myErrorRtnFunc("",r,ctx);_XTXSAB__WEBPACK_IMPORTED_MODULE_3__["f"](0,(function(t){return 0!=t.retVal?(alert("xtx设置签名算法失败"),$myErrorRtnFunc("",r,ctx)):$_$WebSign_WebSocketObj.ESeaL_GetSignature(e,n.retVal,r,ctx)}))}))}function ESeaL_Sign(e,t,n,r){if(ctx=null,null==$_$WebSign_WebSocketObj)return null!=$_$WebSign_AppObj&&void 0!=$_$WebSign_AppObj.SignEx?$_$WebSign_AppObj.SignEx(e,n,!0,r,ctx):$myErrorRtnFunc("",r,ctx);$_$WebSign_WebSocketObj.ESeaL_GetDataForSign(e,n,(function(n){if(""==n.retVal)return $GetLastErr(),$_$bReSign||(document.getElementById(t).style.display="none"),$myErrorRtnFunc("",r,ctx);_XTXSAB__WEBPACK_IMPORTED_MODULE_3__["c"](e,(function(o){if(""==o.retVal)return ant_design_vue_es_message__WEBPACK_IMPORTED_MODULE_2__["a"].error("xtx获取用户证书失败"),$myErrorRtnFunc("",r,ctx);_XTXSAB__WEBPACK_IMPORTED_MODULE_3__["d"](o.retVal,3,(function(o){if(""==o.retVal)return ant_design_vue_es_message__WEBPACK_IMPORTED_MODULE_2__["a"].error("xtx获取证书信息失败"),$myErrorRtnFunc("",r,ctx);if("RSA"==o.retVal){if(!$_$bUseSHA256)return $_$Method_Name="SHA1WithRSA",$SignData(e,t,n.retVal,r);_XTXSAB__WEBPACK_IMPORTED_MODULE_3__["f"]($_$SGD_SHA256_RSA,(function(o){return 0!=o.retVal?(ant_design_vue_es_message__WEBPACK_IMPORTED_MODULE_2__["a"].error("xtx设置签名算法失败"),$myErrorRtnFunc("",r,ctx)):($_$Method_Name="SHA256WithRSA",$SignData(e,t,n.retVal,r))}))}else _XTXSAB__WEBPACK_IMPORTED_MODULE_3__["f"]($_$SGD_SM3_SM2,(function(o){return 0!=o.retVal?(ant_design_vue_es_message__WEBPACK_IMPORTED_MODULE_2__["a"].error("xtx设置签名算法失败"),$myErrorRtnFunc("",r,ctx)):($_$Method_Name="SM3WithSM2",$SignData(e,t,n.retVal,r))}))}),null)}),null)}),ctx)}function $PassWdDlg(e,t,n,r){var o=200,a=135,i="#336699",s=document.body.offsetWidth+document.body.scrollLeft,c=screen.height+document.body.scrollHeight,u=document.createElement("div");u.setAttribute("id","bgDiv"),u.style.position="absolute",u.style.left="0",u.style.top="0",u.style.background="#777",u.style.filter="progid:DXImageTransform.Microsoft.Alpha(style=3,opacity=25,finishOpacity=75",u.style.opacity="0.6",u.style.width=s+"px",u.style.height=c+"px",u.style.zIndex="10000",document.body.appendChild(u);var l=document.createElement("div");l.setAttribute("id","msgDiv"),l.setAttribute("align","center"),l.style.background="white",l.style.border="1px solid "+i,l.style.position="absolute",l.style.left="50%",l.style.top="50%",l.style.font="12px/1.6em Verdana, Geneva, Arial, Helvetica, sans-serif",l.style.marginLeft="-125px",l.style.marginTop=-75+document.body.scrollTop+"px",l.style.width=o+"px",l.style.height=a+"px",l.style.textAlign="center",l.style.lineHeight="25px",l.style.zIndex="10001",document.body.appendChild(l);var d=document.createElement("h3");d.setAttribute("id","msgTitle"),d.setAttribute("align","left"),d.style.margin="0",d.style.padding="3px",d.style.background=i,d.style.opacity="0.75",d.style.border="1px solid "+i,d.style.height="28px",d.style.font="12px Verdana, Geneva, Arial, Helvetica, sans-serif",d.style.color="white",d.style.cursor="default",d.innerHTML="请输入密码",document.getElementById("msgDiv").appendChild(d);var p=document.createElement("input");p.setAttribute("id","passwdInput"),p.setAttribute("type","password"),p.setAttribute("align","left"),p.setAttribute("maxlength","16"),p.style.margin="0",p.style.height="25px",p.style.width="160px",p.style.position="absolute",p.style.left="10%",p.style.top="35%",document.getElementById("msgDiv").appendChild(p);var f=document.createElement("input");function h(){var o=p.value;if(""==o)return ant_design_vue_es_message__WEBPACK_IMPORTED_MODULE_2__["a"].error("请输入用户口令"),void p.focus();_XTXSAB__WEBPACK_IMPORTED_MODULE_3__["h"]($_$Cur_CertID,o,(function(o){if(!o.retVal)return ant_design_vue_es_message__WEBPACK_IMPORTED_MODULE_2__["a"].error("密码错误!"),void p.focus();document.body.removeChild(u),document.body.removeChild(l),ESeaL_Sign($_$Cur_CertID,e,t,(function(t){if(""==t.retVal)$GetLastErr(),$_$bReSign||(document.getElementById(e).style.display="none");else{document.getElementById(e).style.display="block",ant_design_vue_es_message__WEBPACK_IMPORTED_MODULE_2__["a"].success("签名成功！"),$_$Signature=t.retVal,document.getElementById(n).value=$_$Signature;var o="";if(o=GetSignMethod(),""==o)return;document.getElementById(r).value=o,$_$bReSign=!0,signSuccessCallback&&"function"==typeof signSuccessCallback&&signSuccessCallback()}}))}))}f.setAttribute("type","button"),f.setAttribute("value","确定"),f.style.width="60px",f.style.height="28px",f.style.textAlign="center",f.style.position="absolute",f.style.left="10%",f.style.top="65%",f.style.background=i,f.style.border="1px solid "+i,f.style.color="white",f.onclick=h,document.getElementById("msgDiv").appendChild(f);var y=document.createElement("input");function m(){cur_cert_id="",document.body.removeChild(u),document.body.removeChild(l),document.getElementById(e).style.display="none"}y.setAttribute("type","button"),y.setAttribute("value","取消"),y.style.width="60px",y.style.height="28px",y.style.textAlign="center",y.style.position="absolute",y.style.left="65%",y.style.top="65%",y.style.background=i,y.style.border="1px solid "+i,y.style.color="white",y.onclick=m,document.getElementById("msgDiv").appendChild(y)}function $SignDataPKCS1(e,t,n,r){var o=document.getElementById(t).value;if(""!=o){var a=document.getElementById(o).value||signDefaultText;""!=a?""!=$_$Cur_CertID?password?_XTXSAB__WEBPACK_IMPORTED_MODULE_3__["h"]($_$Cur_CertID,password,(function(t){ESeaL_Sign($_$Cur_CertID,e,a,(function(o){if(t.retVal)if(""==o.retVal)$GetLastErr(),$_$bReSign||(document.getElementById(e).style.display="none");else{document.getElementById(e).style.display="block",ant_design_vue_es_message__WEBPACK_IMPORTED_MODULE_2__["a"].success("签名成功！"),$_$Signature=o.retVal,document.getElementById(n).value=$_$Signature;var i="";if(i=GetSignMethod(),""==i)return;document.getElementById(r).value=i,$_$bReSign=!0,signSuccessCallback&&"function"==typeof signSuccessCallback&&signSuccessCallback()}else $PassWdDlg(e,a,n,r)}))})):$PassWdDlg(e,a,n,r):ant_design_vue_es_message__WEBPACK_IMPORTED_MODULE_2__["a"].error("CertID为空！"):ant_design_vue_es_message__WEBPACK_IMPORTED_MODULE_2__["a"].error("表单原数据为空！")}else ant_design_vue_es_message__WEBPACK_IMPORTED_MODULE_2__["a"].error("表单原数据标签ID为空！")}function $VerifyPKCS1(e,t,n,r,o,a,i,s,c,u,l){ctx=null;var d=document.getElementById(t).value;if(""!=d){var p=document.getElementById(d).value;if(""!=p){var f=document.getElementById(n).value;if(""!=f){var h=document.getElementById(r).value;if(""==h&&(h="无信息"),null!=$_$WebSign_WebSocketObj)$_$WebSign_WebSocketObj.ESeaL_Verify(p,f,(function(t){if("true"==t.retVal){var n="验证成功，数据有效！\r\n签名算法："+h;ant_design_vue_es_message__WEBPACK_IMPORTED_MODULE_2__["a"].error(n)}else{n="验证失败，数据无效！\r\n签名算法："+h;ant_design_vue_es_message__WEBPACK_IMPORTED_MODULE_2__["a"].error(n)}$_$WebSign_WebSocketObj.ESeaL_GetStampPicAfterVerified(t.retVal,f,(function(t){if(t.retVal){var n=document.getElementById(o);n.src="data:image/gif;base64,"+t.retVal,$_$sealImg.src="data:image/gif;base64,"+t.retVal,null!=i&&ESeaL_SetOffsetPos(a,i,s,c,u,l,!0);var r=document.getElementById(e);r.style.display="block"}else $GetLastErr()}),ctx)}),ctx);else{if(null==$_$WebSign_AppObj||void 0==$_$WebSign_AppObj.Verify||void 0==$_$WebSign_AppObj.GetStampPicAfterVerified)return;$_$WebSign_AppObj.Verify(p,f,(function(t){if(t.retVal){var n="验证成功，数据有效！\r\n签名算法："+h;ant_design_vue_es_message__WEBPACK_IMPORTED_MODULE_2__["a"].error(n),$_$WebSign_AppObj.GetStampPicAfterVerified((function(t){if(""!=t.retVal){var n=document.getElementById(o);n.src="data:image/gif;base64,"+t.retVal,$_$sealImg.src="data:image/gif;base64,"+t.retVal,null!=i&&ESeaL_SetOffsetPos(a,i,s,c,u,l,!0);var r=document.getElementById(e);r.style.display="block"}else $GetLastErr()}),ctx)}else{n="验证失败，数据无效！\r\n签名算法："+h;ant_design_vue_es_message__WEBPACK_IMPORTED_MODULE_2__["a"].error(n),$_$WebSign_AppObj.GetStampPicAfterVerified((function(t){if(""!=t.retVal){var n=document.getElementById(o);n.src="data:image/gif;base64,"+t.retVal,$_$sealImg.src="data:image/gif;base64,"+t.retVal,null!=i&&ESeaL_SetOffsetPos(a,i,s,c,u,l,!0);var r=document.getElementById(e);r.style.display="block"}else $GetLastErr()}),ctx)}}),ctx)}}else ant_design_vue_es_message__WEBPACK_IMPORTED_MODULE_2__["a"].error("签章数据为空！")}else ant_design_vue_es_message__WEBPACK_IMPORTED_MODULE_2__["a"].error("表单原数据为空！")}else ant_design_vue_es_message__WEBPACK_IMPORTED_MODULE_2__["a"].error("表单原数据标签ID为空！")}function $CheckRemoveRight(e,t){ctx=null;var n=document.getElementById(e).value;if(""!=n)if(""!=t){var r=t.substr(10);if(null!=$_$WebSign_WebSocketObj)$_$WebSign_WebSocketObj.ESeaL_CheckRemoveRight(n,(function(e){"true"==e.retVal?(document.getElementById(t).style.display="none",deleteSigDiv(r),ant_design_vue_es_message__WEBPACK_IMPORTED_MODULE_2__["a"].error("撤销签章成功！")):""==e.retVal?$GetLastErr():ant_design_vue_es_message__WEBPACK_IMPORTED_MODULE_2__["a"].error(e.retVal)}),ctx);else{if(null==$_$WebSign_AppObj||void 0==$_$WebSign_AppObj.CheckRemoveRight)return;$_$WebSign_AppObj.CheckRemoveRight(n,(function(e){"true"==e.retVal?(document.getElementById(t).style.display="none",deleteSigDiv(r),ant_design_vue_es_message__WEBPACK_IMPORTED_MODULE_2__["a"].error("撤销签章成功！")):""==e.retVal?$GetLastErr():ant_design_vue_es_message__WEBPACK_IMPORTED_MODULE_2__["a"].error(e.retVal)}),ctx)}}else ant_design_vue_es_message__WEBPACK_IMPORTED_MODULE_2__["a"].error("签章DIV异常！");else ant_design_vue_es_message__WEBPACK_IMPORTED_MODULE_2__["a"].error("签章数据为空！")}function $ShowUserCerInfo(e){ctx=null;var t=document.getElementById(e).value;if(""!=t)if(null!=$_$WebSign_WebSocketObj)$_$WebSign_WebSocketObj.ESeaL_ShowUserCerInfo(t,(function(e){""==e.retVal?$GetLastErr():$AlertDlg(e.retVal,2)}),ctx);else{if(null==$_$WebSign_AppObj||void 0==$_$WebSign_AppObj.ShowSignerCertInfoEx)return;$_$WebSign_AppObj.ShowSignerCertInfoEx(t,(function(e){""==e.retVal?$GetLastErr():$AlertDlg(e.retVal,2)}),ctx)}else ant_design_vue_es_message__WEBPACK_IMPORTED_MODULE_2__["a"].error("签章数据为空！")}function $ShowSignTime(e){ctx=null;var t=document.getElementById(e).value;if(""!=t)if(null!=$_$WebSign_WebSocketObj)$_$WebSign_WebSocketObj.ESeaL_ShowSignTime(t,(function(e){""==e.retVal?$GetLastErr():$AlertDlg(e.retVal,1)}),ctx);else{if(null==$_$WebSign_AppObj||void 0==$_$WebSign_AppObj.ShowSignTimeEx)return;$_$WebSign_AppObj.ShowSignTimeEx(t,(function(e){""==e.retVal?$GetLastErr():$AlertDlg(e.retVal,1)}),ctx)}else ant_design_vue_es_message__WEBPACK_IMPORTED_MODULE_2__["a"].error("签章数据为空！")}function $GetVersion(){if(ctx=null,null!=$_$WebSign_WebSocketObj)$_$WebSign_WebSocketObj.ESeaL_GetGetVersion((function(e){""==e.retVal?$GetLastErr():$AlertDlg("BJCA网页签章V"+e.retVal,1)}),ctx);else{if(null==$_$WebSign_AppObj||void 0==$_$WebSign_AppObj.GetVersion)return;$_$WebSign_AppObj.GetVersion((function(e){""==e.retVal?$GetLastErr():$AlertDlg("BJCA网页签章V"+e.retVal,1)}),ctx)}}function $GetLastErr(){if(ctx=null,null!=$_$WebSign_WebSocketObj)$_$WebSign_WebSocketObj.ESeaL_GetLastErr((function(e){""==e.retVal?alert("获取错误信息失败"):alert(e.retVal)}),ctx);else{if(null==$_$WebSign_AppObj||void 0==$_$WebSign_AppObj.GetLastErr)return;$_$WebSign_AppObj.GetLastErr((function(e){""==e.retVal?alert("获取错误信息失败"):alert(e.retVal)}),ctx)}}function ESeaL_SetCertID(e){$_$Cur_CertID="",""!=e?$_$Cur_CertID=e:alert("请先登录！")}function ESeaL_SetOrgDataEx(e,t){if($_$Org_Data="",""!=t){var n="originDataElement"+e;document.getElementById(n).value=t;var r=document.getElementById(t).value;""!=r?($_$Org_Data_field_name=t,$_$Org_Data=r):ant_design_vue_es_message__WEBPACK_IMPORTED_MODULE_2__["a"].error("表单原数据为空！")}else ant_design_vue_es_message__WEBPACK_IMPORTED_MODULE_2__["a"].error("表单名称为空！")}function ESeaL_SetOrgData(e){$_$Org_Data=e}function ESeaL_SetData(e,t,n,r,o,a,i,s,c){""!=e&&""!=t&&""!=n&&""!=o&&""!=a&&""!=i?($_$Signature=n,$_$Signature_Element_Name="signatureElement"+e,document.getElementById($_$Signature_Element_Name).value=$_$Signature,$_$Method_Element_Name="methodElement"+e,document.getElementById($_$Method_Element_Name).value=r,$_$OriginData_Element_Name="originDataElement"+e,document.getElementById($_$OriginData_Element_Name).value=t,$_$Seal_Pic_Main_Div_Name="sealPicMain"+e,$_$Seal_Pic_Div_Name="sealPicDiv"+e,$_$Seal_Img_Name="sealImg"+e,$VerifyPKCS1($_$Seal_Pic_Div_Name,$_$OriginData_Element_Name,$_$Signature_Element_Name,$_$Method_Element_Name,$_$Seal_Img_Name,e,o,a,i,s,c),$_$bJustShow=!0,$_$bPos=!0):alert("参数不可为空！")}function checkKey(e,t,n){console.log("checkKey","production"),_XTXSAB__WEBPACK_IMPORTED_MODULE_3__["e"]((function(e){if(""==e.retVal)return ant_design_vue_es_message__WEBPACK_IMPORTED_MODULE_2__["a"].error("没有发现用户key, 请插入后重试."),void(n&&n());t&&t()}))}function ESeaL_SetSealPosAndSign(e,t,n,r,o,a){""!=e&&""!=t&&""!=n&&""!=r?(_XTXSAB__WEBPACK_IMPORTED_MODULE_3__["e"]((function(t){if(console.log("lib.GetUserList",t),""!=t.retVal){var n=t.retVal,r=[];while(1){var o=n.indexOf("&&&");if(o<=0)break;var a=n.substring(0,o),i=a.substring(0,a.indexOf("||")),s=a.substring(a.indexOf("||")+2,a.length);r.push({certName:i,certID:s});var c=n.length;n=n.substring(o+3,c)}var u=r.length;if($_$Seal_Pic_Main_Div_Name="sealPicMain"+e,$_$OriginData_Element_Name="originDataElement"+e,$_$Seal_Pic_Div_Name="sealPicDiv"+e,$_$Seal_Img_Name="sealImg"+e,$_$Signature_Element_Name="signatureElement"+e,$_$Method_Element_Name="methodElement"+e,0==u)ant_design_vue_es_message__WEBPACK_IMPORTED_MODULE_2__["a"].error("未能检测到usbkey！");else if(1==u){var l=r[0];if($_$Cur_CertID!==l.certID&&(password=""),$_$Cur_CertID=l.certID,""==$_$Cur_CertID)return void ant_design_vue_es_message__WEBPACK_IMPORTED_MODULE_2__["a"].error("CertID为空！");GetPic($_$Cur_CertID,(function(e){if(""!=e.retVal){var t=document.getElementById($_$Seal_Img_Name);t.src="data:image/gif;base64,"+e.retVal,$_$sealImg.src="data:image/gif;base64,"+e.retVal,$SignDataPKCS1($_$Seal_Pic_Div_Name,$_$OriginData_Element_Name,$_$Signature_Element_Name,$_$Method_Element_Name)}else $GetLastErr()}),null)}else $SelectSealDlg(r,$_$Seal_Pic_Main_Div_Name,$_$Seal_Pic_Div_Name,$_$Seal_Img_Name,!1,$_$OriginData_Element_Name,$_$Signature_Element_Name,$_$Method_Element_Name)}else ant_design_vue_es_message__WEBPACK_IMPORTED_MODULE_2__["a"].error("没有发现用户key！")})),ESeaL_SetOffsetPos(e,t,n,r,o,a,!1),$_$bJustShow=!0,$_$bPos=!0):ant_design_vue_es_message__WEBPACK_IMPORTED_MODULE_2__["a"].error("参数不可为空！")}function ESeaL_GetSignatureData(e){$_$Signature_Element_Name="signatureElement"+e;var t=document.getElementById($_$Signature_Element_Name);return t?($_$Signature=t.value,$_$Signature):(alert("签章值为空！"),"")}function ESeaL_GetMethod(e){$_$Method_Element_Name="methodElement"+e;var t=document.getElementById($_$Method_Element_Name);if(t){var n=t.value;return n}alert("签名算法为空！")}function ESeaL_GetOrgData(e){$_$OriginData_Element_Name="originDataElement"+e;var t=document.getElementById($_$OriginData_Element_Name);if(t){var n=document.getElementById(t.value);return $_$Org_Data=n.value,$_$Org_Data}return alert("原文数据为空！"),""}function ESeaL_GetPic(e){var t="sealImg"+e,n=document.getElementById(t);if(n){var r=n.src,o=r.substr(22);return o}return ant_design_vue_es_message__WEBPACK_IMPORTED_MODULE_2__["a"].error("原文数据为空！"),""}function getLeft(e){var t=e.offsetLeft;return null!=e.offsetParent&&(t+=getLeft(e.offsetParent)),t}function getTop(e){var t=e.offsetTop;return null!=e.offsetParent&&(t+=getTop(e.offsetParent)),t}function ESeaL_SetOffsetPos(e,t,n,r,o,a,i){var s="sealPicDiv"+e,c="sealImg"+e,u="containerElement"+e,l=document.getElementById(s),d=window.document.getElementById(c),p=(document.getElementById(t),window.document.getElementById(u));if((!i||null!=d&&""!=$_$sealImg.src)&&null!=p&&null!=l)if("BODY"==p.value);else{var f=window.document.getElementById(p.value);if(null==f)return;o&&a&&(l.style.maxWidth=o,l.style.maxHeight=a)}}function $checkBrowserISIE(){return!(!window.ActiveXObject&&!("ActiveXObject"in window))}function $AlertDlg(e,t){var n=300,r=165;2==t&&(r=250);var o="#336699",a=document.body.offsetWidth+document.body.scrollLeft,i=screen.height+document.body.scrollHeight,s=document.createElement("div");s.setAttribute("id","bgDiv"),s.style.position="absolute",s.style.left="0",s.style.top="0",s.style.background="#777",s.style.filter="progid:DXImageTransform.Microsoft.Alpha(style=3,opacity=25,finishOpacity=75",s.style.opacity="0.6",s.style.width=a+"px",s.style.height=i+"px",s.style.zIndex="10000",document.body.appendChild(s);var c=document.createElement("div");c.setAttribute("id","msgDiv"),c.setAttribute("align","center"),c.style.background="white",c.style.border="1px solid "+o,c.style.position="absolute",c.style.left="50%",c.style.top="50%",c.style.font="12px/1.6em Verdana, Geneva, Arial, Helvetica, sans-serif",c.style.marginLeft="-125px",c.style.marginTop=-75+document.body.scrollTop+"px",c.style.width=n+"px",c.style.height=r+"px",c.style.textAlign="center",c.style.lineHeight="25px",c.style.zIndex="10001",document.body.appendChild(c);var u=document.createElement("h3");u.setAttribute("id","msgTitle"),u.setAttribute("align","left"),u.style.margin="0",u.style.padding="3px",u.style.background=o,u.style.opacity="0.75",u.style.border="1px solid "+o,u.style.height="18px",u.style.font="12px Verdana, Geneva, Arial, Helvetica, sans-serif",u.style.color="white",u.style.cursor="default",u.innerHTML="提示",2==t&&(u.innerHTML="证书信息"),document.getElementById("msgDiv").appendChild(u);var l=document.createElement("div");l.setAttribute("id","info"),l.setAttribute("align","left"),l.style.background="white",l.style.position="absolute",l.style.left="15%",l.style.top="40%",l.style.right="15%",2==t&&(l.style.left="7%",l.style.top="20%",l.style.right="7%"),l.style.font="12px/1.6em Verdana, Geneva, Arial, Helvetica, sans-serif";var d=e.indexOf("\r\n");if(d>0){var p=e,f="",h="",y="";while(d>0)f=p.substring(0,d),h=p.substring(d+2,p.length),y+=f+"<br/>",p=h,d=p.indexOf("\r\n");y+=h,l.innerHTML=y}else l.innerHTML=e;var m=document.createElement("input");function _(){document.getElementById("msgDiv").removeChild(u),document.getElementById("msgDiv").removeChild(l),document.body.removeChild(s),document.body.removeChild(c)}m.setAttribute("type","button"),m.setAttribute("value","确定"),m.style.width="60px",m.style.height="28px",m.style.textAlign="center",m.style.position="absolute",m.style.left="40%",m.style.top="75%",m.style.background=o,m.style.border="1px solid "+o,m.style.color="white",2==t&&(m.style.top="80%"),m.onclick=_,document.getElementById("msgDiv").appendChild(l),document.getElementById("msgDiv").appendChild(m)}function $AttachForIE11Event(e,t,n){var r=document.createElement("script");r.setAttribute("for",e),r.setAttribute("event",t),r.appendChild(document.createTextNode(n)),document.body.appendChild(r)}function $LoadControl(CLSID,ctlName,testFuncName,addEvent,OnSignCallbackFun,OnSignCallbackFunString,OnVerifyCallbackFun,OnVerifyCallbackFunString,OnSignRemovedCallbackFun,OnSignRemovedCallbackFunString){var pluginDiv=document.getElementById("pluginDiv"+ctlName);pluginDiv&&(document.body.removeChild(pluginDiv),pluginDiv.innerHTML="",pluginDiv=null),pluginDiv=document.createElement("div"),pluginDiv.id="pluginDiv"+ctlName,document.body.appendChild(pluginDiv);try{if($checkBrowserISIE()){if("Win32"==window.navigator.platform?pluginDiv.innerHTML='<object id="'+ctlName+'" classid="CLSID:'+CLSID+'" codeBase="BJCAWebSign.CAB" style="POSITION: absolute; TOP: 10px; LEFT: 10px;"> <PARAM NAME="Visible" VALUE="false"> </object>':pluginDiv.innerHTML='<object id="'+ctlName+'" classid="CLSID:'+CLSID+'" codeBase="BJCAWebSignX64.CAB" style="POSITION: absolute; TOP: 10px; LEFT: 10px;"> <PARAM NAME="Visible" VALUE="false"> </object>',addEvent){var clt=eval(ctlName);clt.attachEvent?(clt.attachEvent("OnSign",OnSignCallbackFun),clt.attachEvent("OnVerify",OnVerifyCallbackFun),clt.attachEvent("OnSignRemoved",OnSignRemovedCallbackFun)):($AttachForIE11Event(ctlName,"OnSign",OnSignCallbackFunString),$AttachForIE11Event(ctlName,"OnVerify",OnVerifyCallbackFunString),$AttachForIE11Event(ctlName,"OnSignRemoved",OnSignRemovedCallbackFunString))}}else{var chromeVersion=window.navigator.userAgent.match(/Chrome\/(\d+)\./);if(chromeVersion&&chromeVersion[1]&&parseInt(chromeVersion[1],10)>=42)return document.body.removeChild(pluginDiv),pluginDiv.innerHTML="",pluginDiv=null,!1;pluginDiv.innerHTML="<embed id="+ctlName+" type=application/x-xtx-axhost clsid={"+CLSID+"} width=0 height=0 />"}return null==testFuncName||""==testFuncName||void 0!=eval(ctlName+"."+testFuncName)||(document.body.removeChild(pluginDiv),pluginDiv.innerHTML="",pluginDiv=null,!1)}catch(e){return document.body.removeChild(pluginDiv),pluginDiv.innerHTML="",pluginDiv=null,!1}}function CreateAppObject_WebSign(objectIDString,OnSignCallbackFun,OnSignCallbackFunString,OnVerifyCallbackFun,OnVerifyCallbackFunString,OnSignRemovedCallbackFun,OnSignRemovedCallbackFunString){var bOK=$LoadControl("820390E5-1C07-483D-AEED-6A0EDF640AA2",objectIDString,null,!1,OnSignCallbackFun,OnSignCallbackFunString,OnVerifyCallbackFun,OnVerifyCallbackFunString,OnSignRemovedCallbackFun,OnSignRemovedCallbackFunString);if(!bOK)return null;var o=new Object,clt=eval(objectIDString);return o.Sign=function(e,t,n){var r=clt.Sign(e);return $myOKRtnFunc(r,t,n)},o.Verify=function(e,t,n,r){var o=clt.Verify(e,t);return $myOKRtnFunc(o,n,r)},o.SetCtrlPos=function(e,t,n,r){var o=clt.SetCtrlPos(e,t);return $myOKRtnFunc(o,n,r)},o.SetOffsetPos=function(e,t,n,r,o){var a=clt.SetOffsetPos(e,t,n);return $myOKRtnFunc(a,r,o)},o.SetDisplayRect=function(e,t,n,r,o,a){var i=clt.SetDisplayRect(e,t,n,r);return $myOKRtnFunc(i,o,a)},o.ShowLastVerifyResult=function(e,t){var n=clt.ShowLastVerifyResult();return $myOKRtnFunc(n,e,t)},o.GetSignature=function(e,t){var n=clt.GetSignature();return $myOKRtnFunc(n,e,t)},o.SetSignature=function(e,t,n){var r=clt.SetSignature(e);return $myOKRtnFunc(r,t,n)},o.IsSigned=function(e,t){var n=clt.IsSigned();return $myOKRtnFunc(n,e,t)},o.SetVisible=function(e,t,n){var r=clt.SetVisible(e);return $myOKRtnFunc(r,t,n)},o.GetVisible=function(e,t){var n=clt.GetVisible();return $myOKRtnFunc(n,e,t)},o.IsKeyReady=function(e,t){var n=clt.IsKeyReady();return $myOKRtnFunc(n,e,t)},o.SignFormFields=function(e,t,n,r,o){var a=clt.SignFormFields(e,t,n);return $myOKRtnFunc(a,r,o)},o.VerifyFormFields=function(e,t){var n=clt.VerifyFormFields();return $myOKRtnFunc(n,e,t)},o.GetSignTime=function(e,t){var n=clt.GetSignTime();return $myOKRtnFunc(n,e,t)},o.GetStampPicAfterVerified=function(e,t){var n=clt.GetStampPicAfterVerified();return $myOKRtnFunc(n,e,t)},o.SetWebServiceURL=function(e,t,n){var r=clt.SetWebServiceURL(e);return $myOKRtnFunc(r,t,n)},o.ShowSignerCertInfo=function(e,t){var n=clt.ShowSignerCertInfo();return $myOKRtnFunc(n,e,t)},o.RemoveESign=function(e,t,n){var r=clt.RemoveESign(e);return $myOKRtnFunc(r,t,n)},o.ShowSignerCertInfoEx=function(e,t,n){var r=clt.ShowSignerCertInfoEx(e);return $myOKRtnFunc(r,t,n)},o.AboutBox=function(e,t){var n="";return clt.AboutBox(),$myOKRtnFunc(n,e,t)},o.GetStampPicFromUKey=function(e,t,n){var r=clt.GetStampPicFromUKey(e);return $myOKRtnFunc(r,t,n)},o.ShowSignTimeEx=function(e,t,n){var r=clt.ShowSignTimeEx(e);return $myOKRtnFunc(r,t,n)},o.CheckRemoveRight=function(e,t,n){var r=clt.CheckRemoveRight(e);return $myOKRtnFunc(r,t,n)},o.SignEx=function(e,t,n,r,o){var a=clt.SignEx(e,t,n);return $myOKRtnFunc(a,r,o)},o.GetVersion=function(e,t){var n=clt.GetVersion();return $myOKRtnFunc(n,e,t)},o.GetLastErr=function(e,t){var n=clt.GetLastErr();return $myOKRtnFunc(n,e,t)},o.GetSignMethod=function(e,t){var n=clt.GetSignMethod();return $myOKRtnFunc(n,e,t)},o}function CreateWebSocketObject_WebSign(){var e=new Object;return e.ws_obj=null,e.ws_heartbeat_id=0,e.ws_queue_id=0,e.ws_queue_list={},e.ws_queue_ctx={},e.xtx_version="",e.load_websocket=function(){var t;t="ws://127.0.0.1:21051/websign/";try{e.ws_obj=new WebSocket(t)}catch(n){return}return e.ws_obj.onopen=function(t){clearInterval(e.ws_heartbeat_id),e.ws_heartbeat_id=setInterval((function(){}),1e4),$_$WebSocketConnectState=!0,window.isWebSignReady=!0},e.ws_obj.onclose=function(e){$_$WebSocketConnectState=!1,window.isWebSignReady=!1},e.ws_obj.onmessage=function(t){var n=JSON.parse(t.data);n["set-cookie"]&&(document.cookie=n["set-cookie"]);var r=n["call_cmd_id"];if(r){var o=e.ws_queue_list[r];if("function"==typeof o){var a,i=e.ws_queue_ctx[n["call_cmd_id"]];i=i||{returnType:"string"},a="bool"==i.returnType?"true"==n.retVal:"number"==i.returnType?Number(n.retVal):n.retVal;var s={retVal:a,ctx:i};o(s),"onUsbkeyChange"!=n["call_cmd_id"]&&delete e.ws_queue_list[n["call_cmd_id"]],delete e.ws_queue_ctx[n["call_cmd_id"]]}}},e.ws_obj.onerror=function(t){webSignRequired&&!window.isWebSignReady&&maxConntectServerTimes>0&&(e.load_websocket(),--maxConntectServerTimes),$_$WebSocketConnectState=!1,window.isWebSignReady=!1},!0},e.sendMessage=function(t){e.ws_obj.readyState==WebSocket.OPEN?e.ws_obj.send(JSON.stringify(t)):console.log("Can't connect to WebSocket server!")},e.callMethod=function(t,n,r,o,a){e.ws_queue_id++,"function"==typeof n&&(e.ws_queue_list["i_"+e.ws_queue_id]=n,r=r||{},r.returnType=o,e.ws_queue_ctx["i_"+e.ws_queue_id]=r);var i={};i["cookie"]=document.cookie,i["websign_func_name"]=t,i["call_cmd_id"]="i_"+e.ws_queue_id,e.xtx_version>="2.16"&&(i["URL"]=window.location.href),arguments.length>4&&(i["param"]=a),e.ws_obj.readyState==WebSocket.OPEN?e.sendMessage(i):e.ws_obj.readyState!=WebSocket.CONNECTING&&(e.load_websocket(),setTimeout(e.sendMessage(i),500))},e.ESeaL_Verify=function(t,n,r,o){var a=[t,n];o=null;var i=null;e.callMethod("ESeaL_Verify",r,o,i,a)},e.ESeaL_ShowUserCerInfo=function(t,n,r){var o=[t];r=null;var a=null;e.callMethod("ESeaL_ShowUserCerInfo",n,r,a,o)},e.ESeaL_ShowSignTime=function(t,n,r){var o=[t];r=null;var a=null;e.callMethod("ESeaL_ShowSignTime",n,r,a,o)},e.ESeaL_GetStampPic=function(t,n,r){var o=[t];r=null;var a=null;e.callMethod("ESeaL_GetStampPic",n,r,a,o)},e.ESeaL_GetGetVersion=function(t,n){var r="";n=null;var o=null;e.callMethod("ESeaL_GetGetVersion",t,n,o,r)},e.ESeaL_CheckRemoveRight=function(t,n,r){var o=[t];r=null;var a=null;e.callMethod("ESeaL_CheckRemoveRight",n,r,a,o)},e.ESeaL_GetDataForSign=function(t,n,r,o){var a=[t,n];o=null;var i=null;e.callMethod("ESeaL_GetDataForSign",r,o,i,a)},e.ESeaL_GetSignature=function(t,n,r,o){var a=[t,n];o=null;var i=null;e.callMethod("ESeaL_GetSignature",r,o,i,a)},e.ESeaL_GetStampPicAfterVerified=function(t,n,r,o){var a=[t,n];o=null;var i=null;e.callMethod("ESeaL_GetStampPicAfterVerified",r,o,i,a)},e.ESeaL_GetLastErr=function(t,n){var r="";n=null;var o=null;e.callMethod("ESeaL_GetLastErr",t,n,o,r)},e.load_websocket()?e:null}function $CreateSignMenu(e){var t;deleteSigMenuDiv(e);var n=document.createElement("div"),r="sigMenu"+e;n.setAttribute("id",r),n.className="contextMenu",document.body.appendChild(n);var o=document.createElement("ul"),a="ulo"+e;o.setAttribute("id",a),document.getElementById(r).appendChild(o);var i=document.createElement("li");i.innerHTML="验章",document.getElementById(a).appendChild(i);var s=document.createElement("li");s.innerHTML="证书信息",document.getElementById(a).appendChild(s);var c=document.createElement("li");c.innerHTML="签章时间",document.getElementById(a).appendChild(c);var u=document.createElement("li");u.innerHTML="撤销签章",document.getElementById(a).appendChild(u);var l=document.createElement("li");l.innerHTML="关于",document.getElementById(a).appendChild(l);var d=document.getElementById(r),p=d.getElementsByTagName("ul"),f=d.getElementsByTagName("li"),h=t=null,y=0,m=0,_=[document.documentElement.offsetWidth,document.documentElement.offsetHeight];for(d.style.display="none",d.onmouseover=function(){d.style.display="block"},d.onmouseout=function(){d.style.display="none"},y=0;y<f.length;y++)f[y].getElementsByTagName("ul")[0]&&(f[y].className="sub"),f[y].onmouseover=function(){var e=this,n=e.getElementsByTagName("ul");e.className+=" active",n[0]&&(clearTimeout(t),h=setTimeout((function(){for(y=0;y<e.parentNode.children.length;y++)e.parentNode.children[y].getElementsByTagName("ul")[0]&&(e.parentNode.children[y].getElementsByTagName("ul")[0].style.display="none");n[0].style.display="block",n[0].style.top=e.offsetTop+"px",n[0].style.left=e.offsetWidth+"px",b(n[0]),m=_[0]-n[0].offsetWidth,_[1]-n[0].offsetHeight}),300))},f[y].onmouseout=function(){var e=this;e.getElementsByTagName("ul");e.className=e.className.replace(/\s?active/,""),clearTimeout(h),t=setTimeout((function(){for(y=0;y<e.parentNode.children.length;y++)e.parentNode.children[y].getElementsByTagName("ul")[0]&&(e.parentNode.children[y].getElementsByTagName("ul")[0].style.display="none")}),300)},f[y].onclick=function(){var e=this;$_$WebSign_CurrentObj&&("签章"==e.innerText||"签章"==e.innerHTML?$SignDataPKCS1($_$Seal_Pic_Div_Name,$_$OriginData_Element_Name,$_$Signature_Element_Name,$_$Method_Element_Name):"验章"==e.innerText||"验章"==e.innerHTML?$VerifyPKCS1($_$Seal_Pic_Div_Name,$_$OriginData_Element_Name,$_$Signature_Element_Name,$_$Method_Element_Name,$_$Seal_Img_Name,null,null,null,null,null,null):"证书信息"==e.innerText||"证书信息"==e.innerHTML?$ShowUserCerInfo($_$Signature_Element_Name):"签章时间"==e.innerText||"签章时间"==e.innerHTML?$ShowSignTime($_$Signature_Element_Name):"撤销签章"==e.innerText||"撤销签章"==e.innerHTML?$CheckRemoveRight($_$Signature_Element_Name,$_$Seal_Pic_Div_Name):"关于"!=e.innerText&&"关于"!=e.innerHTML||$GetVersion())};function b(e){for(m=0,y=0;y<e.children.length;y++){var t=e.children[y],n=t.clientWidth-2*parseInt(t.currentStyle?t.currentStyle["paddingLeft"]:getComputedStyle(t,null)["paddingLeft"]);n>m&&(m=n)}for(y=0;y<e.children.length;y++)e.children[y].style.width=m+"px"}document.oncontextmenu=function(e){document.getElementById($_$Seal_Pic_Div_Name),document.getElementById($_$Seal_Pic_Main_Div_Name),e=e||window.event;var t=e.srcElement?e.srcElement:e.target,n=t.id.substr(0,7),r=t.id.substr(7);if(""!=r&&($_$Seal_Pic_Main_Div_Name="sealPicMain"+r,$_$Seal_Pic_Div_Name="sealPicDiv"+r,$_$Signature_Element_Name="signatureElement"+r,$_$OriginData_Element_Name="originDataElement"+r,$_$Seal_Img_Name="sealImg"+r,$_$Method_Element_Name="methodElement"+r,"sealImg"==n))if($_$bPos){d.style.display="block";var o=document.body.clientWidth-e.clientX,a=document.body.clientHeight-e.clientY;o<d.offsetWidth?d.style.left=document.body.scrollLeft+e.clientX-d.offsetWidth+"px":d.style.left=document.body.scrollLeft+e.clientX+"px",a<d.offsetHeight?d.style.top=document.body.scrollTop+e.clientY-d.offsetHeight+"px":d.style.top=document.body.scrollTop+e.clientY+"px",b(p[0]),i.style.display="none",s.style.display="none",c.style.display="none";var u=document.getElementById($_$Signature_Element_Name).value;u&&(i.style.display="block",s.style.display="block",c.style.display="block"),m=_[0]-d.offsetWidth,_[1]-d.offsetHeight,d.target=t.id}else!1,document.getElementById($_$Seal_Pic_Div_Name).style.display="none";return!1},document.onclick=function(){d.style.display="none"}}function deleteSigMenuDiv(e){var t="sigMenu"+e,n=document.getElementById(t);null!=n&&n.parentNode.removeChild(n)}window.isWebSignReady=!1,document.onmousemove=function(e){e=e||window.event;var t=window.document.getElementById($_$Seal_Pic_Div_Name),n=window.document.getElementById($_$Seal_Img_Name),r=window.document.getElementById($_$container_Element_Name);if(null!=r&&null!=t&&null!=n&&""!=$_$sealImg.src&&!$_$bPos&&!$_$bJustShow){var o=$_$sealImg.width,a=$_$sealImg.height;if(t.style.width=o+"px",t.style.height=a+"px","BODY"==r.value){t.style.display="block";var i=document.body.scrollLeft+e.clientX+1,s=document.body.scrollTop+e.clientY+1;t.style.left=i+"px",t.style.top=s+"px"}else{var c=window.document.getElementById(r.value);if(null==c)return;t.style.display="block";i=document.body.scrollLeft+e.clientX+1,s=document.body.scrollTop+e.clientY+1;t.style.left=i-c.offsetLeft+"px",t.style.top=s-c.offsetTop+"px"}}},document.onmousedown=function(e){if(e=e||window.event,1==e.button||0==e.button){if($_$bPos)return;if($_$bJustShow)return;e.srcElement?e.srcElement:e.target;var t=window.document.getElementById($_$Seal_Pic_Div_Name),n=window.document.getElementById($_$Seal_Img_Name),r=window.document.getElementById($_$container_Element_Name);if(null==r||null==t||null==n||""==$_$sealImg.src)return;if("BODY"==r.value){var o=e.x,a=e.y;t.style.left=document.body.scrollLeft+o+"px",t.style.top=document.body.scrollTop+a+"px"}else{var i=window.document.getElementById(r.value);if(null==i)return;o=e.x,a=e.y;t.style.left=document.body.scrollLeft+o-i.offsetLeft+"px",t.style.top=document.body.scrollTop+a-i.offsetTop+"px"}$SignDataPKCS1($_$Seal_Pic_Div_Name,$_$OriginData_Element_Name,$_$Signature_Element_Name,$_$Method_Element_Name),$_$bPos=!0}else if(2==e.button){if($_$bPos)return;document.getElementById($_$Seal_Pic_Div_Name).style.display="none",$_$bPos=!0}}},"372e":function(e,t){},4054:function(e,t){},"6a45":function(e,t,n){var r={"./af":"85b3","./af.js":"85b3","./ar":"4a53","./ar-dz":"29ef","./ar-dz.js":"29ef","./ar-kw":"5245","./ar-kw.js":"5245","./ar-ly":"c4eb","./ar-ly.js":"c4eb","./ar-ma":"6810","./ar-ma.js":"6810","./ar-sa":"3f2e","./ar-sa.js":"3f2e","./ar-tn":"1c8b","./ar-tn.js":"1c8b","./ar.js":"4a53","./az":"93f9","./az.js":"93f9","./be":"56ba","./be.js":"56ba","./bg":"5d18","./bg.js":"5d18","./bm":"3593","./bm.js":"3593","./bn":"39eb","./bn.js":"39eb","./bo":"df03","./bo.js":"df03","./br":"1b7a","./br.js":"1b7a","./bs":"9346","./bs.js":"9346","./ca":"e311","./ca.js":"e311","./cs":"159e","./cs.js":"159e","./cv":"bb10","./cv.js":"bb10","./cy":"3343","./cy.js":"3343","./da":"576e","./da.js":"576e","./de":"486a","./de-at":"3320","./de-at.js":"3320","./de-ch":"b0df","./de-ch.js":"b0df","./de.js":"486a","./dv":"93b9","./dv.js":"93b9","./el":"1c79","./el.js":"1c79","./en-au":"a781","./en-au.js":"a781","./en-ca":"71e8","./en-ca.js":"71e8","./en-gb":"6339","./en-gb.js":"6339","./en-ie":"e424","./en-ie.js":"e424","./en-il":"0bdf","./en-il.js":"0bdf","./en-in":"2880","./en-in.js":"2880","./en-nz":"c2cc","./en-nz.js":"c2cc","./en-sg":"9af2","./en-sg.js":"9af2","./eo":"2b43","./eo.js":"2b43","./es":"3938","./es-do":"a31f","./es-do.js":"a31f","./es-us":"8adc","./es-us.js":"8adc","./es.js":"3938","./et":"0661","./et.js":"0661","./eu":"7a06","./eu.js":"7a06","./fa":"19df","./fa.js":"19df","./fi":"1450","./fi.js":"1450","./fil":"4d32","./fil.js":"4d32","./fo":"021d","./fo.js":"021d","./fr":"e625","./fr-ca":"404f","./fr-ca.js":"404f","./fr-ch":"08b7","./fr-ch.js":"08b7","./fr.js":"e625","./fy":"4bd8","./fy.js":"4bd8","./ga":"5b5d","./ga.js":"5b5d","./gd":"3ca3","./gd.js":"3ca3","./gl":"c707","./gl.js":"c707","./gom-deva":"e5b6","./gom-deva.js":"e5b6","./gom-latn":"972b","./gom-latn.js":"972b","./gu":"7c2c","./gu.js":"7c2c","./he":"2215","./he.js":"2215","./hi":"c522","./hi.js":"c522","./hr":"4422","./hr.js":"4422","./hu":"2c97","./hu.js":"2c97","./hy-am":"a2ce","./hy-am.js":"a2ce","./id":"1991","./id.js":"1991","./is":"0195","./is.js":"0195","./it":"cdd2","./it-ch":"3726","./it-ch.js":"3726","./it.js":"cdd2","./ja":"bf43","./ja.js":"bf43","./jv":"b950","./jv.js":"b950","./ka":"9296","./ka.js":"9296","./kk":"c9c9","./kk.js":"c9c9","./km":"012d","./km.js":"012d","./kn":"d792","./kn.js":"d792","./ko":"7bf3","./ko.js":"7bf3","./ku":"c51f","./ku.js":"c51f","./ky":"4d6d","./ky.js":"4d6d","./lb":"ed21","./lb.js":"ed21","./lo":"a378","./lo.js":"a378","./lt":"a520","./lt.js":"a520","./lv":"8570","./lv.js":"8570","./me":"bf95","./me.js":"bf95","./mi":"fdc8","./mi.js":"fdc8","./mk":"a5ab","./mk.js":"a5ab","./ml":"d732","./ml.js":"d732","./mn":"4724","./mn.js":"4724","./mr":"ba33","./mr.js":"ba33","./ms":"3daf","./ms-my":"c67b","./ms-my.js":"c67b","./ms.js":"3daf","./mt":"683a","./mt.js":"683a","./my":"1966","./my.js":"1966","./nb":"efc5","./nb.js":"efc5","./ne":"19a7","./ne.js":"19a7","./nl":"9d26","./nl-be":"edd0","./nl-be.js":"edd0","./nl.js":"9d26","./nn":"97f6","./nn.js":"97f6","./oc-lnc":"6e30","./oc-lnc.js":"6e30","./pa-in":"7118","./pa-in.js":"7118","./pl":"95f0","./pl.js":"95f0","./pt":"8283","./pt-br":"903b","./pt-br.js":"903b","./pt.js":"8283","./ro":"450f","./ro.js":"450f","./ru":"8b94","./ru.js":"8b94","./sd":"fce8","./sd.js":"fce8","./se":"bb6a","./se.js":"bb6a","./si":"3b14","./si.js":"3b14","./sk":"1a7e","./sk.js":"1a7e","./sl":"a0cf","./sl.js":"a0cf","./sq":"c2ec","./sq.js":"c2ec","./sr":"9115","./sr-cyrl":"9c9d","./sr-cyrl.js":"9c9d","./sr.js":"9115","./ss":"f51a","./ss.js":"f51a","./sv":"862e","./sv.js":"862e","./sw":"da25","./sw.js":"da25","./ta":"77ea","./ta.js":"77ea","./te":"9ad4","./te.js":"9ad4","./tet":"f5c5","./tet.js":"f5c5","./tg":"1b39","./tg.js":"1b39","./th":"b38f","./th.js":"b38f","./tl-ph":"106d","./tl-ph.js":"106d","./tlh":"60d3","./tlh.js":"60d3","./tr":"a05a","./tr.js":"a05a","./tzl":"0f1a","./tzl.js":"0f1a","./tzm":"c862","./tzm-latn":"7fc3","./tzm-latn.js":"7fc3","./tzm.js":"c862","./ug-cn":"1b2f","./ug-cn.js":"1b2f","./uk":"2236","./uk.js":"2236","./ur":"1b7d","./ur.js":"1b7d","./uz":"9937","./uz-latn":"43fd","./uz-latn.js":"43fd","./uz.js":"9937","./vi":"608c","./vi.js":"608c","./x-pseudo":"0d00","./x-pseudo.js":"0d00","./yo":"4bb71","./yo.js":"4bb71","./zh-cn":"3268","./zh-cn.js":"3268","./zh-hk":"ab00","./zh-hk.js":"ab00","./zh-mo":"8043","./zh-mo.js":"8043","./zh-tw":"e689","./zh-tw.js":"e689"};function o(e){var t=a(e);return n(t)}function a(e){if(!n.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}o.keys=function(){return Object.keys(r)},o.resolve=a,e.exports=o,o.id="6a45"},"7af9":function(e,t){},"7cfd":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"i",(function(){return isXTXAppReady})),__webpack_require__.d(__webpack_exports__,"e",(function(){return GetUserList})),__webpack_require__.d(__webpack_exports__,"h",(function(){return VerifyUserPIN})),__webpack_require__.d(__webpack_exports__,"g",(function(){return SignedData})),__webpack_require__.d(__webpack_exports__,"f",(function(){return SetSignMethod})),__webpack_require__.d(__webpack_exports__,"c",(function(){return ExportUserSignCert})),__webpack_require__.d(__webpack_exports__,"d",(function(){return GetCertInfo})),__webpack_require__.d(__webpack_exports__,"b",(function(){return EnvInitStart})),__webpack_require__.d(__webpack_exports__,"a",(function(){return EnvExit}));var C_Users_yuan_Desktop_jquery_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("c97b"),C_Users_yuan_Desktop_jquery_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(C_Users_yuan_Desktop_jquery_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__),ant_design_vue_es_message_style__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("a5a5"),ant_design_vue_es_message__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("5473");function asyncGeneratorStep(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,o)}function _asyncToGenerator(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){asyncGeneratorStep(a,r,o,i,s,"next",e)}function s(e){asyncGeneratorStep(a,r,o,i,s,"throw",e)}i(void 0)}))}}var $_$softCertListID="",$_$hardCertListID="",$_$allCertListID="",$_$loginCertID="",$_$logoutFunc,$_$onUsbKeyChangeCallBackFunc,$_$XTXAlert,$_$XTXAppObj=null,$_$SecXV2Obj=null,$_$SecXObj=null,$_$WebSocketObj=null,$_$CurrentObj=null,$_$GetPicObj=null,CERT_TYPE_HARD=1,CERT_TYPE_SOFT=2,CERT_TYPE_ALL=3,CERT_OID_VERSION=1,CERT_OID_SERIAL=2,CERT_OID_SIGN_METHOD=3,CERT_OID_ISSUER_C=4,CERT_OID_ISSUER_O=5,CERT_OID_ISSUER_OU=6,CERT_OID_ISSUER_ST=7,CERT_OID_ISSUER_CN=8,CERT_OID_ISSUER_L=9,CERT_OID_ISSUER_E=10,CERT_OID_NOT_BEFORE=11,CERT_OID_NOT_AFTER=12,CERT_OID_SUBJECT_C=13,CERT_OID_SUBJECT_O=14,CERT_OID_SUBJECT_OU=15,CERT_OID_SUBJECT_ST=16,CERT_OID_SUBJECT_CN=17,CERT_OID_SUBJECT_L=18,CERT_OID_SUBJECT_E=19,CERT_OID_PUBKEY=20,CERT_OID_SUBJECT_DN=33,CERT_OID_ISSUER_DN=34,XTXAPP,SecXV2,USBKEY,oCert,oDevice,oCrypto,OGetPic;window.isXTXAppSocketReady=!1;var envRequired=!0,maxConnectServerTimes=3;function isXTXAppReady(){return window.isXTXAppSocketReady}function SetAutoLogoutParameter(e,t){$_$loginCertID=e,$_$logoutFunc=t}function SetLoginCertID(e){$_$loginCertID=e}function SetLogoutFunction(e){$_$logoutFunc=e}function SetUserCertList(e,t){1==arguments.length?$_$hardCertListID=e:(t==CERT_TYPE_HARD&&($_$hardCertListID=e),t==CERT_TYPE_SOFT&&($_$softCertListID=e),t==CERT_TYPE_ALL&&($_$allCertListID=e)),GetUserList($pushAllDropListBox)}function SetOnUsbKeyChangeCallBack(e){$_$onUsbKeyChangeCallBackFunc=e}function SetAlertFunction(e){$_$XTXAlert=e}function $checkBrowserISIE(){return!(!window.ActiveXObject&&!("ActiveXObject"in window))}function $popDropListBoxAll(strListID){var objListID=eval(strListID);if(void 0!=objListID){var i,n=objListID.length;for(i=0;i<n;i++)objListID.remove(0);objListID=null}}function $pushOneDropListBox(userListArray,strListID){var objListID=eval(strListID);if(void 0!=objListID){var i;for(i=0;i<userListArray.length;i++){var certObj=userListArray[i],objItem=new Option(certObj.certName,certObj.certID);objListID.options.add(objItem)}objListID=null}}function $pushAllDropListBox(e){""!=$_$hardCertListID&&$popDropListBoxAll($_$hardCertListID),""!=$_$softCertListID&&$popDropListBoxAll($_$softCertListID),""!=$_$allCertListID&&$popDropListBoxAll($_$allCertListID);var t=e.retVal,n=[];while(1){var r=t.indexOf("&&&");if(r<=0)break;var o=t.substring(0,r),a=o.substring(0,o.indexOf("||")),i=o.substring(o.indexOf("||")+2,o.length);n.push({certName:a,certID:i}),""!=$_$hardCertListID&&GetDeviceType(i,(function(e){"HARD"==e.retVal&&$pushOneDropListBox([e.ctx],$_$hardCertListID)}),{certName:a,certID:i}),""!=$_$softCertListID&&GetDeviceType(i,(function(e){"SOFT"==e.retVal&&$pushOneDropListBox([e.ctx],$_$softCertListID)}),{certName:a,certID:i});var s=t.length;t=t.substring(r+3,s)}""!=$_$allCertListID&&$pushOneDropListBox(n,$_$allCertListID)}function $myAutoLogoutCallBack(e){e.retVal.indexOf($_$loginCertID)<=0&&$_$logoutFunc()}function $OnUsbKeyChange(){GetUserList($pushAllDropListBox),"function"==typeof $_$onUsbKeyChangeCallBackFunc&&$_$onUsbKeyChangeCallBackFunc(),""!=$_$loginCertID&&"function"==typeof $_$logoutFunc&&GetUserList($myAutoLogoutCallBack)}function $AttachIE11OnUSBKeychangeEvent(e){var t=document.createElement("script");t.setAttribute("for",e),t.setAttribute("event","OnUsbKeyChange"),t.appendChild(document.createTextNode("$OnUsbKeyChange()")),document.body.appendChild(t)}function $LoadControl(CLSID,ctlName,testFuncName,addEvent){var pluginDiv=document.getElementById("pluginDiv"+ctlName);if(pluginDiv)return!0;pluginDiv=document.createElement("div"),pluginDiv.id="pluginDiv"+ctlName,document.body.appendChild(pluginDiv);try{if($checkBrowserISIE()){if(pluginDiv.innerHTML='<object id="'+ctlName+'" classid="CLSID:'+CLSID+'" style="HEIGHT:0px; WIDTH:0px"></object>',addEvent){var clt=eval(ctlName);clt.attachEvent?clt.attachEvent("OnUsbKeyChange",$OnUsbKeyChange):$AttachIE11OnUSBKeychangeEvent(ctlName)}}else{var chromeVersion=window.navigator.userAgent.match(/Chrome\/(\d+)\./);if(chromeVersion&&chromeVersion[1]&&parseInt(chromeVersion[1],10)>=42)return document.body.removeChild(pluginDiv),pluginDiv.innerHTML="",pluginDiv=null,!1;pluginDiv.innerHTML=addEvent?"<embed id="+ctlName+" type=application/x-xtx-axhost clsid={"+CLSID+"} event_OnUsbkeyChange=$OnUsbKeyChange width=0 height=0 />":"<embed id="+ctlName+" type=application/x-xtx-axhost clsid={"+CLSID+"} width=0 height=0 />"}return null==testFuncName||""==testFuncName||void 0!=eval(ctlName+"."+testFuncName)||(document.body.removeChild(pluginDiv),pluginDiv.innerHTML="",pluginDiv=null,!1)}catch(e){return document.body.removeChild(pluginDiv),pluginDiv.innerHTML="",pluginDiv=null,!1}}function $XTXAlert(e){"function"==typeof $_$XTXAlert?$_$XTXAlert(e):ant_design_vue_es_message__WEBPACK_IMPORTED_MODULE_2__["a"].error(e)}function $myOKRtnFunc(e,t,n){if("function"==typeof t){var r={retVal:e,ctx:n};t(r)}return e}function CreateXTXAppObject(){var e=$LoadControl("3F367B74-92D9-4C5E-AB93-234F8A91D5E6","XTXAPP","SOF_GetVersion()",!0);if(!e)return null;var t=new Object;return t.SetSignMethod=function(e,t,n){var r=XTXAPP.SOF_SetSignMethod(e);return $myOKRtnFunc(r,t,n)},t.GetUserList=function(e,t){var n=XTXAPP.SOF_GetUserList();return $myOKRtnFunc(n,e,t)},t._GetUserListByType=function(e,t,n){var r=XTXAPP.SOF_GetUserList(),o="";while(1){var a=r.indexOf("&&&");if(a<=0)break;var i=r.substring(0,a),s=(i.substring(0,i.indexOf("||")),i.substring(i.indexOf("||")+2,i.length));XTXAPP.GetDeviceInfo(s,7)==e&&(o+=i+"&&&");var c=r.length;r=r.substring(a+3,c)}return $myOKRtnFunc(o,t,n)},t.GetUserList_USBKey=function(e,n){return t._GetUserListByType("HARD",e,n)},t.GetUserList_Soft=function(e,n){return t._GetUserListByType("SOFT",e,n)},t.ExportUserSignCert=function(e,t,n){var r,o=XTXAPP.SOF_ExportUserCert(e),a=XTXAPP.SOF_ExportExChangeUserCert(e);return r=o==a?"":o,$myOKRtnFunc(r,t,n)},t.ExportUserExchangeCert=function(e,t,n){var r=XTXAPP.SOF_ExportExChangeUserCert(e);return $myOKRtnFunc(r,t,n)},t.VerifyUserPIN=function(e,t,n,r){var o=XTXAPP.SOF_Login(e,t);return $myOKRtnFunc(o,n,r)},t.ChangeUserPIN=function(e,t,n,r,o){var a=XTXAPP.SOF_ChangePassWd(e,t,n);return $myOKRtnFunc(a,r,o)},t.GetUserPINRetryCount=function(e,t,n){var r=XTXAPP.SOF_GetPinRetryCount(e);return $myOKRtnFunc(r,t,n)},t.GetCertInfo=function(e,t,n,r){var o=XTXAPP.SOF_GetCertInfo(e,t);return $myOKRtnFunc(o,n,r)},t.GetCertInfoByOID=function(e,t,n,r){var o=XTXAPP.SOF_GetCertInfoByOid(e,t);return $myOKRtnFunc(o,n,r)},t.GetCertEntity=function(e,t,n){var r=XTXAPP.SOF_GetCertEntity(e);return $myOKRtnFunc(r,t,n)},t.GenRandom=function(e,t,n){var r=XTXAPP.SOF_GenRandom(e);return $myOKRtnFunc(r,t,n)},t.SignData=function(e,t,n,r){var o=XTXAPP.SOF_SignData(e,t);return $myOKRtnFunc(o,n,r)},t.VerifySignedData=function(e,t,n,r,o){var a=XTXAPP.SOF_VerifySignedData(e,t,n);return $myOKRtnFunc(a,r,o)},t.PubKeyEncrypt=function(e,t,n,r){var o=XTXAPP.SOF_PubKeyEncrypt(e,t);return $myOKRtnFunc(o,n,r)},t.PriKeyDecrypt=function(e,t,n,r){var o=XTXAPP.SOF_PriKeyDecrypt(e,t);return $myOKRtnFunc(o,n,r)},t.SignDataByP7=function(e,t,n,r,o){var a=0;n&&(a=1);var i=XTXAPP.SOF_SignMessage(a,e,t);return $myOKRtnFunc(i,r,o)},t.VerifyDataByP7=function(e,t,n,r){var o=XTXAPP.SOF_VerifySignedMessage(e,t);return $myOKRtnFunc(o,n,r)},t.EncyptMessage=function(e,t,n,r){var o=XTXAPP.SOF_EncryptDataEx(e,t);return $myOKRtnFunc(o,n,r)},t.DecryptMessage=function(e,t,n,r){var o=XTXAPP.SOF_DecryptData(e,t);return $myOKRtnFunc(o,n,r)},t.SignFile=function(e,t,n,r){var o=XTXAPP.SOF_SignFile(e,t);return $myOKRtnFunc(o,n,r)},t.VerifySignFile=function(e,t,n,r,o){var a=XTXAPP.SOF_VerifySignedFile(e,t,n);return $myOKRtnFunc(a,r,o)},t.GetSymKeyLength=function(e,t){var n=24;return $myOKRtnFunc(n,e,t)},t.SymEncryptData=function(e,t,n,r){var o=XTXAPP.SOF_SymEncryptData(e,t);return $myOKRtnFunc(o,n,r)},t.SymDecryptData=function(e,t,n,r){var o=XTXAPP.SOF_SymDecryptData(e,t);return $myOKRtnFunc(o,n,r)},t.SymEncryptFile=function(e,t,n,r,o){var a=XTXAPP.SOF_SymEncryptFile(e,t,n);return $myOKRtnFunc(a,r,o)},t.SymDecryptFile=function(e,t,n,r,o){var a=XTXAPP.SOF_SymDecryptFile(e,t,n);return $myOKRtnFunc(a,r,o)},t.ValidateCert=function(e,t,n){var r;XTXAPP.SOF_ValidateCert(e);return r=0==r,$myOKRtnFunc(r,t,n)},t.HashFile=function(e,t,n){var r=XTXAPP.SOF_HashFile(2,e);return $myOKRtnFunc(r,t,n)},t.GetDateNotBefore=function(e){return t._GetDateFormate(e)},t.GetDateNotAfter=function(e){return t._GetDateFormate(e)},t._GetDateFormate=function(e){var t=e.substring(0,4),n=e.substring(4,6),r=e.substring(6,8),o=e.substring(8,10),a=e.substring(10,12),i=e.substring(12,14),s=new Date;return s.setFullYear(Number(t),Number(n)-1,Number(r)),s.setHours(Number(o)),s.setMinutes(Number(a)),s.setSeconds(Number(i)),s},t.GetDeviceType=function(e,t,n){var r=XTXAPP.GetDeviceInfo(e,7);return $myOKRtnFunc(r,t,n)},t.SignHashData=function(e,t,n,r,o){var a=XTXAPP.SOF_SignHashData(e,t,n);return $myOKRtnFunc(a,r,o)},t.VerifySignedHashData=function(e,t,n,r,o,a){var i=XTXAPP.SOF_VerifySignedHashData(e,t,r,n);return $myOKRtnFunc(i,o,a)},t}function CreateSecXV2Object(){var e=$LoadControl("FCAA4851-9E71-4BFE-8E55-212B5373F040","SecXV2","GetUserList()",!0);if(!e)return null;var t=new Object;return t.GetUserList=function(e,t){var n=SecXV2.GetUserList();return $myOKRtnFunc(n,e,t)},t.GetUserList_USBKey=function(e,n){return t.GetUserList(e,n)},t.GetUserList_Soft=function(e,n){return t.GetUserList(e,n)},t.ExportUserSignCert=function(e,t,n){var r,o=SecXV2.ExportUserCert(e),a=SecXV2.ExportExChangeUserCert(e);return r=o==a?"":o,$myOKRtnFunc(r,t,n)},t.ExportUserExchangeCert=function(e,t,n){var r=SecXV2.ExportExChangeUserCert(e);if("function"==typeof t){var o={retVal:r,ctx:n};t(o)}return r},t.VerifyUserPIN=function(e,t,n,r){var o=SecXV2.UserLogin(e,t);return $myOKRtnFunc(o,n,r)},t.ChangeUserPIN=function(e,t,n,r,o){var a=SecXV2.ChangePasswd(e,t,n);return $myOKRtnFunc(a,r,o)},t.GetUserPINRetryCount=function(e,t,n){var r=SecXV2.GetUserInfo(e,15),o=SecXV2.GetBjcaKeyParam(r,8);return $myOKRtnFunc(o,t,n)},t.GetCertInfo=function(e,t,n,r){var o=SecXV2.GetCertInfo(e,t);return $myOKRtnFunc(o,n,r)},t.GetCertInfoByOID=function(e,t,n,r){var o=SecXV2.GetCertInfoByOid(e,t);return $myOKRtnFunc(o,n,r)},t.GetCertEntity=function(e,t,n){var r=SecXV2.GetCertInfoByOid(e,"2.16.840.1.113732.2");return $myOKRtnFunc(r,t,n)},t.GenRandom=function(e,t,n){var r=SecXV2.GenRandom(e);return $myOKRtnFunc(r,t,n)},t.SignData=function(e,t,n,r){var o=SecXV2.SignData(e,t);return $myOKRtnFunc(o,n,r)},t.VerifySignedData=function(e,t,n,r,o){var a=SecXV2.VerifySignedData(e,t,n);return $myOKRtnFunc(a,r,o)},t.PubKeyEncrypt=function(e,t,n,r){var o=SecXV2.PubKeyEncrypt(e,t);return $myOKRtnFunc(o,n,r)},t.PriKeyDecrypt=function(e,t,n,r){var o=SecXV2.PriKeyDecrypt(e,t);return $myOKRtnFunc(o,n,r)},t.SignDataByP7=function(e,t,n,r,o){var a=SecXV2.SignDataByP7(e,t);return $myOKRtnFunc(a,r,o)},t.VerifyDataByP7=function(e,t,n,r){var o=SecXV2.VerifySignedDatabyP7(e);return $myOKRtnFunc(o,n,r)},t.EncyptMessage=function(e,t,n,r){var o=SecXV2.EncodeP7EnvelopedData(e,t);return $myOKRtnFunc(o,n,r)},t.DecryptMessage=function(e,t,n,r){var o=SecXV2.DecodeP7EnvelopedData(e,t);return $myOKRtnFunc(o,n,r)},t.SignFile=function(e,t,n,r){var o=SecXV2.SignFile(e,t);return $myOKRtnFunc(o,n,r)},t.VerifySignFile=function(e,t,n,r,o){var a=SecXV2.VerifySignedFile(e,t,n);return $myOKRtnFunc(a,r,o)},t.GetSymKeyLength=function(e,t){var n=24;return $myOKRtnFunc(n,e,t)},t.SymEncryptData=function(e,t,n,r){var o=SecXV2.EncryptData(e,t);return $myOKRtnFunc(o,n,r)},t.SymDecryptData=function(e,t,n,r){var o=SecXV2.DecryptData(e,t);return $myOKRtnFunc(o,n,r)},t.SymEncryptFile=function(e,t,n,r,o){var a=SecXV2.EncryptFile(e,t,n);return $myOKRtnFunc(a,r,o)},t.SymDecryptFile=function(e,t,n,r,o){var a=SecXV2.DecryptFile(e,t,n);return $myOKRtnFunc(a,r,o)},t.ValidateCert=function(e,t,n){var r=SecXV2.ValidateCert(e);return $myOKRtnFunc(r,t,n)},t.GetDateNotBefore=function(e){var t=e.substring(0,4),n=e.substring(5,7),r=e.substring(8,10),o=new Date;return o.setFullYear(Number(t),Number(n)-1,Number(r)),o.setHours(0),o.setMinutes(0),o.setSeconds(0),o},t.GetDateNotAfter=function(e){var t=e.substring(0,4),n=e.substring(5,7),r=e.substring(8,10),o=new Date;return o.setFullYear(Number(t),Number(n)-1,Number(r)),o.setHours(23),o.setMinutes(59),o.setSeconds(59),o},t}function CreateSecXObject(){$LoadControl("02BE3F91-A9E1-4D12-A65B-1E0D500292A7","oCert","",!1),$LoadControl("4F763EC7-657A-43A8-96D0-BD3AD6D5E17E","oCrypto","",!1),$LoadControl("D57CD2CA-8FA1-440F-8614-B0A28F64F0BE","oDevice","",!1);var e=$LoadControl("BB7D3BAD-A402-4E98-B813-1C3C22481AE7","oUtil","getUserList()",!1);if(!e)return null;if(e=$LoadControl("0CF5259B-A812-4B6E-9746-ACF7279FEF74","USBKEY","EnumUsbKey()",!0),!e)return null;var t=new Object;return t.CERT_SRC_BASE64=1,t.CERT_SRC_UNIQUEID=2,t.CERT_SRC_FILE=3,t.CERT_SRC_CONTAINER_UCA=4,t.CERT_SRC_CONTAINER_SIGN=5,t.CERT_SRC_CONTAINER_ENC=6,t.CERT_SRC_CONTAINER_BOTH=7,t.CERT_SRC_PKCS12=8,t.CERT_DST_BASE64=1,t.CERT_DST_DERFILE=2,t.CERT_DST_P12=3,t.CERT_XML_SUBJECT=1,t.CERT_XML_UNIQUEID=2,t.CERT_XML_DEPT=3,t.CERT_XML_ISSUE=4,t.CERT_XML_STATE=5,t.CERT_XML_TRADETYPE=6,t.CERT_XML_PASSWORD=7,t.CERT_XML_DEVICETYPE=8,t.CERT_XML_CATYPE=9,t.CERT_XML_KEYTYPE=10,t.CERT_XML_SIGNSN=11,t.CERT_XML_EXCHSN=12,t.CERT_XML_DEVICENAME=13,t.CERT_XML_DEVICEPROVIDER=14,t.CERT_XML_DEVICEAFFIX=15,t.CERT_XML_SIGNPATH=16,t.CERT_XML_EXCHPATH=17,t.CERT_XML_SIGNPFXPATH=18,t.CERT_XML_EXCHPFXPATH=19,t.CERT_XML_CHAINPATH=20,t.CERT_XML_CRLPATH=21,t.CERT_XML_UNIQUEIDOID=22,t.CERT_XML_VERIFYTYPE=23,t.CERT_XML_CACOUNTS=24,t.CERT_XML_CANUMTYPE=25,t.CRYPT_CFGTYPE_UNSET=0,t.CRYPT_CFGTYPE_CSP=1,t.CRYPT_CFGTYPE_P11=2,t.CRYPT_CFGTYPE_P12=3,t.ENVELOP_ENC=1,t.ENVELOP_DEC=0,t.GetUserList=function(e,t){var n=USBKEY.getUserList();return $myOKRtnFunc(n,e,t)},t.GetUserList_USBKey=function(e,n){return t.GetUserList(e,n)},t.GetUserList_Soft=function(e,n){return t.GetUserList(e,n)},t.ExportUserSignCert=function(e,n,r){var o,a=USBKEY.getUserInfoByContainer(e,t.CERT_XML_DEVICEPROVIDER),i=USBKEY.getUserInfoByContainer(e,t.CERT_XML_KEYTYPE);return 1==i?(oCert.importCert(e,t.CERT_SRC_CONTAINER_ENC,a),o=oCert.exportCert(t.CERT_DST_BASE64)):2==i?(oCert.importCert(e,t.CERT_SRC_CONTAINER_SIGN,a),o=oCert.exportCert(t.CERT_DST_BASE64)):o="",$myOKRtnFunc(o,n,r)},t.ExportUserExchangeCert=function(e,n,r){var o=USBKEY.getUserInfoByContainer(e,t.CERT_XML_DEVICEPROVIDER);oCert.importCert(e,t.CERT_SRC_CONTAINER_ENC,o);var a=oCert.exportCert(t.CERT_DST_BASE64);return $myOKRtnFunc(a,n,r)},t.VerifyUserPIN=function(e,n,r,o){var a,i=USBKEY.getUserInfoByContainer(e,t.CERT_XML_DEVICEPROVIDER),s=USBKEY.getUserInfoByContainer(e,t.CERT_XML_DEVICEAFFIX),c=oDevice.userLogin(i,n);return 0==c?(oCrypto.setUserCfg(t.CRYPT_CFGTYPE_CSP,i,s,n),a=!0):a=!1,$myOKRtnFunc(a,r,o)},t.ChangeUserPIN=function(e,n,r,o,a){var i,s=USBKEY.getUserInfoByContainer(e,t.CERT_XML_DEVICEPROVIDER),c=USBKEY.getUserInfoByContainer(e,t.CERT_XML_DEVICEAFFIX),u=oDevice.changeUserPin(s,c,n,r);return 0==u?(oCrypto.setUserCfg(t.CRYPT_CFGTYPE_CSP,s,c,r),i=!0):i=!1,$myOKRtnFunc(i,o,a)},t.GetUserPINRetryCount=function(e,n,r){var o=USBKEY.getUserInfoByContainer(e,t.CERT_XML_DEVICEAFFIX),a=oDevice.getKeyRetrys(o);return $myOKRtnFunc(a,n,r)},t.GetCertInfo=function(e,n,r,o){var a;switch(oCert.importCert(e,t.CERT_SRC_BASE64),n){case CERT_OID_ISSUER_CN:a=4;break;case CERT_OID_NOT_BEFORE:a=5;break;case CERT_OID_NOT_AFTER:a=6;break;case CERT_OID_SUBJECT_C:a=42;break;case CERT_OID_SUBJECT_O:a=45;break;case CERT_OID_SUBJECT_OU:a=46;break;case CERT_OID_SUBJECT_ST:a=44;break;case CERT_OID_SUBJECT_CN:a=41;break;case CERT_OID_SUBJECT_L:a=43;break;case CERT_OID_PUBKEY:a=43;break;default:a=n;break}var i=oCert.getBasicCertInfoByOID(a);return $myOKRtnFunc(i,r,o)},t.GetCertInfoByOID=function(e,n,r,o){oCert.importCert(e,t.CERT_SRC_BASE64);var a=oCert.getExtCertInfoByOID(n);return $myOKRtnFunc(a,r,o)},t.GetCertEntity=function(e,n,r){oCert.importCert(e,t.CERT_SRC_BASE64);var o=oCert.getExtCertInfoByOID("2.16.840.1.113732.2");return $myOKRtnFunc(o,n,r)},t.GenRandom=function(e,t,n){var r=oCrypto.generateRandom(e);return $myOKRtnFunc(r,t,n)},t.SignData=function(e,t,n,r){var o=oCrypto.signedData(t,e);return $myOKRtnFunc(o,n,r)},t.VerifySignedData=function(e,t,n,r,o){var a,i=oCrypto.verifySignedData(n,e,t);return a=0==i,$myOKRtnFunc(a,r,o)},t.PubKeyEncrypt=function(e,t,n,r){var o=oCrypto.EncDataByCert(e,t);return $myOKRtnFunc(o,n,r)},t.PriKeyDecrypt=function(e,t,n,r){var o=oCrypto.DecDataByRSA(e,t);return $myOKRtnFunc(o,n,r)},t.SignDataByP7=function(e,t,n,r,o){var a=oCrypto.signedDataByP7(t,e);return $myOKRtnFunc(a,r,o)},t.VerifyDataByP7=function(e,t,n,r){var o,a=oCrypto.verifySignedDataByP7(e);return o=0==a,$myOKRtnFunc(o,n,r)},t.EncyptMessage=function(e,n,r,o){var a=oCrypto.envelopedData(n,t.ENVELOP_ENC,e);return $myOKRtnFunc(a,r,o)},t.DecryptMessage=function(e,n,r,o){var a=oCrypto.envelopedData(n,t.ENVELOP_DEC,e);return $myOKRtnFunc(a,r,o)},t.SignFile=function(e,t,n,r){var o=oCrypto.signFile(t,e);return $myOKRtnFunc(o,n,r)},t.VerifySignFile=function(e,t,n,r,o){var a,i=oCrypto.verifySignFile(t,e,n);return a=0==i,$myOKRtnFunc(a,r,o)},t.GetSymKeyLength=function(e,t){var n=24;return $myOKRtnFunc(n,e,t)},t.SymEncryptData=function(e,t,n,r){var o=oCrypto.encryptData(e,t);return $myOKRtnFunc(o,n,r)},t.SymDecryptData=function(e,t,n,r){var o=oCrypto.decryptData(e,t);return $myOKRtnFunc(o,n,r)},t.SymEncryptFile=function(e,t,n,r,o){var a,i=oCrypto.encryptFile(t,n,e);return a=0==i,$myOKRtnFunc(a,r,o)},t.SymDecryptFile=function(e,t,n,r,o){var a,i=oCrypto.decryptFile(t,n,e);return a=0==i,$myOKRtnFunc(a,r,o)},t.ValidateCert=function(e,t,n){var r,o=oCert.validateCert("","");return r=0==o,$myOKRtnFunc(r,t,n)},t.HashFile=function(e,t,n){var r=oCrypto.HashFile(e);return $myOKRtnFunc(r,t,n)},t.GetDateNotBefore=function(e){var t=e.substring(0,4),n=e.substring(5,7),r=e.substring(8,10),o=new Date;return o.setFullYear(Number(t),Number(n)-1,Number(r)),o.setHours(0),o.setMinutes(0),o.setSeconds(0),o},t.GetDateNotAfter=function(e){var t=e.substring(0,4),n=e.substring(5,7),r=e.substring(8,10),o=new Date;return o.setFullYear(Number(t),Number(n)-1,Number(r)),o.setHours(23),o.setMinutes(59),o.setSeconds(59),o},t}function CreateWebSocketObject(){var e=new Object;return e.ws_obj=null,e.ws_heartbeat_id=0,e.ws_queue_id=0,e.ws_queue_list={},e.ws_queue_ctx={},e.xtx_version="",e.load_websocket=function(){var t;console.log("load_websocket xtxapp"),t="ws://127.0.0.1:21051/xtxapp/";try{e.ws_obj=new WebSocket(t)}catch(n){return}return e.ws_queue_list["onUsbkeyChange"]=$OnUsbKeyChange,e.ws_obj.onopen=function(t){console.log("xtxapp ok"),window.isXTXAppSocketReady=!0,clearInterval(e.ws_heartbeat_id),e.callMethod("SOF_GetVersion",(function(t){e.xtx_version=t.retVal})),e.ws_heartbeat_id=setInterval((function(){}),1e4),GetUserList($pushAllDropListBox)},e.ws_obj.onclose=function(e){window.isXTXAppSocketReady=!1},e.ws_obj.onmessage=function(t){var n=JSON.parse(t.data);n["set-cookie"]&&(document.cookie=n["set-cookie"]),n["loginError"]&&ant_design_vue_es_message__WEBPACK_IMPORTED_MODULE_2__["a"].error(n["loginError"]);var r=n["call_cmd_id"];if(r){var o=e.ws_queue_list[r];if("function"==typeof o){var a,i=e.ws_queue_ctx[n["call_cmd_id"]];i=i||{returnType:"string"},a="bool"==i.returnType?"true"==n.retVal:"number"==i.returnType?Number(n.retVal):n.retVal;var s={retVal:a,ctx:i};o(s),"onUsbkeyChange"!=n["call_cmd_id"]&&delete e.ws_queue_list[n["call_cmd_id"]],delete e.ws_queue_ctx[n["call_cmd_id"]]}}},e.ws_obj.onerror=function(t){envRequired&&!window.isXTXAppSocketReady&&maxConnectServerTimes>0&&(e.load_websocket(),--maxConnectServerTimes),window.isXTXAppSocketReady=!1},!0},e.sendMessage=function(t){e.ws_obj.readyState==WebSocket.OPEN?e.ws_obj.send(JSON.stringify(t)):console.log("Can't connect to WebSocket server!")},e.callMethod=function(t,n,r,o,a){e.ws_queue_id++,"function"==typeof n&&(e.ws_queue_list["i_"+e.ws_queue_id]=n,r=r||{},r.returnType=o,e.ws_queue_ctx["i_"+e.ws_queue_id]=r);var i={};i["cookie"]=document.cookie,i["xtx_func_name"]=t,i["call_cmd_id"]="i_"+e.ws_queue_id,e.xtx_version>="2.16"&&(i["URL"]=window.location.href),arguments.length>4&&(i["param"]=a),e.ws_obj.readyState==WebSocket.OPEN?e.sendMessage(i):e.ws_obj.readyState!=WebSocket.CONNECTING&&(e.load_websocket(),setTimeout(e.sendMessage(i),500))},e.SetSignMethod=function(t,n,r){var o=[t];e.callMethod("SOF_SetSignMethod",n,r,"string",o)},e.GetUserList=function(t,n){e.callMethod("SOF_GetUserList",t,n,"string")},e._GetUserListByType=function(t,n,r){e.GetUserList((function(t){var n=t.retVal;while(1){var r=n.indexOf("&&&");if(r<=0)break;var o=n.substring(0,r),a=(o.substring(0,o.indexOf("||")),o.substring(o.indexOf("||")+2,o.length));e.GetDeviceType(a,(function(e){e.retVal==e.ctx.ctx.type&&"function"==typeof e.ctx.ctx.cb&&e.ctx.ctx.cb({retVal:e.ctx.userList,ctx:e.ctx.ctx.ctx})}),{userList:o,ctx:t.ctx});var i=n.length;n=n.substring(r+3,i)}}),{type:t,cb:n,ctx:r})},e.GetUserList_USBKey=function(t,n){return e._GetUserListByType("HARD",t,n)},e.GetUserList_Soft=function(t,n){return e._GetUserListByType("SOFT",t,n)},e.ExportUserSignCert=function(t,n,r){var o=[t];e.callMethod("SOF_ExportUserCert",n,r,"string",o)},e.ExportUserExchangeCert=function(t,n,r){var o=[t];e.callMethod("SOF_ExportExChangeUserCert",n,r,"string",o)},e.VerifyUserPIN=function(t,n,r,o){var a=[t,n];e.callMethod("SOF_Login",r,o,"bool",a)},e.Logout=function(t,n,r){var o=[t];e.callMethod("SOF_Logout",n,r,"bool",o)},e.ChangeUserPIN=function(t,n,r,o,a){var i=[t,n,r];e.callMethod("SOF_ChangePassWd",o,a,"bool",i)},e.GetUserPINRetryCount=function(t,n,r){var o=[t];e.callMethod("SOF_GetPinRetryCount",n,r,"number",o)},e.GetCertInfo=function(t,n,r,o){var a=[t,n];e.callMethod("SOF_GetCertInfo",r,o,"string",a)},e.GetCertInfoByOID=function(t,n,r,o){var a=[t,n];e.callMethod("SOF_GetCertInfoByOid",r,o,"string",a)},e.GetCertEntity=function(t,n,r){var o=[t];e.callMethod("SOF_GetCertEntity",n,r,"string",o)},e.GenRandom=function(t,n,r){var o=[t];e.callMethod("SOF_GenRandom",n,r,"string",o)},e.SignData=function(t,n,r,o){var a=[t,n];e.callMethod("SOF_SignData",r,o,"string",a)},e.VerifySignedData=function(t,n,r,o,a){var i=[t,n,r];e.callMethod("SOF_VerifySignedData",o,a,"bool",i)},e.PubKeyEncrypt=function(t,n,r,o){var a=[t,n];e.callMethod("SOF_PubKeyEncrypt",r,o,"string",a)},e.PriKeyDecrypt=function(t,n,r,o){var a=[t,n];e.callMethod("SOF_PriKeyDecrypt",r,o,"string",a)},e.SignDataByP7=function(t,n,r,o,a){var i=[t,n];e.callMethod("SOF_SignMessage",o,a,"string",i)},e.VerifyDataByP7=function(t,n,r,o){var a=[t,n];e.callMethod("SOF_VerifySignedMessage",r,o,"bool",a)},e.EncyptMessage=function(t,n,r,o){var a=[t,n];e.callMethod("SOF_EncryptData",r,o,"string",a)},e.DecryptMessage=function(t,n,r,o){var a=[t,n];e.callMethod("SOF_DecryptData",r,o,"string",a)},e.SignFile=function(t,n,r,o){var a=[t,n];e.callMethod("SOF_SignFile",r,o,"string",a)},e.VerifySignFile=function(t,n,r,o,a){var i=[t,n,r];e.callMethod("SOF_VerifySignedFile",o,a,"bool",i)},e.GetSymKeyLength=function(e,t){var n=24;return $myOKRtnFunc(n,e,t)},e.SymEncryptData=function(t,n,r,o){var a=[t,n];e.callMethod("SOF_SymEncryptData",r,o,"string",a)},e.SymDecryptData=function(t,n,r,o){var a=[t,n];e.callMethod("SOF_SymDecryptData",r,o,"string",a)},e.SymEncryptFile=function(t,n,r,o,a){var i=[t,n,r];e.callMethod("SOF_SymEncryptFile",o,a,"bool",i)},e.SymDecryptFile=function(t,n,r,o,a){var i=[t,n,r];e.callMethod("SOF_SymDecryptFile",o,a,"bool",i)},e.ValidateCert=function(t,n,r){var o=[t];e.callMethod("SOF_ValidateCert",n,r,"bool",o)},e.HashFile=function(t,n,r){var o=[2,t];e.callMethod("SOF_HashFile",n,r,"string",o)},e.GetDateNotBefore=function(t){return e._GetDateFormate(t)},e.GetDateNotAfter=function(t){return e._GetDateFormate(t)},e._GetDateFormate=function(e){var t=e.substring(0,4),n=e.substring(4,6),r=e.substring(6,8),o=e.substring(8,10),a=e.substring(10,12),i=e.substring(12,14),s=new Date;return s.setFullYear(Number(t),Number(n)-1,Number(r)),s.setHours(Number(o)),s.setMinutes(Number(a)),s.setSeconds(Number(i)),s},e.GetDeviceType=function(t,n,r){var o=[t,7];e.callMethod("GetDeviceInfo",n,r,"string",o)},e.SignHashData=function(t,n,r,o,a){var i=[t,n,r];e.callMethod("SOF_SignHashData",o,a,"string",i)},e.VerifySignedHashData=function(t,n,r,o,a,i){var s=[t,n,r,o];e.callMethod("SOF_VerifySignedHashData",a,i,"bool",s)},e.GetPic=function(t,n,r){var o=[t];e.callMethod("GetPic",n,r,"string",o)},e.Hash=function(t,n,r){var o=[t];e.callMethod("Hash",n,r,"string",o)},e.ConvertPicFormat=function(t,n,r,o){var a=[t,n];e.callMethod("ConvertPicFormat",r,o,"string",a)},e.ConvertGif2Jpg=function(t,n,r){var o=[t];e.callMethod("ConvertGif2Jpg",n,r,"string",o)},e.ConvertPicSize=function(t,n,r,o,a){var i=[t,n,r];e.callMethod("ConvertPicSize",o,a,"string",i)},e.load_websocket()?e:null}function $myErrorRtnFunc(e,t,n){if("function"==typeof t){var r={retVal:e,ctx:n};t(r)}return e}function GetUserList(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return console.log("GetUserList",$_$CurrentObj,$_$CurrentObj.GetUserList),null!=$_$CurrentObj&&$_$CurrentObj.ws_obj&&$_$CurrentObj.ws_obj.readyState===WebSocket.OPEN?$_$CurrentObj.GetUserList(e,t):$myErrorRtnFunc("",e,t)}function GetUserList_USBKey(e,t){return null!=$_$CurrentObj?$_$CurrentObj.GetUserList_USBKey(e,t):$myErrorRtnFunc("",e,t)}function GetUserList_Soft(e,t){return null!=$_$CurrentObj?$_$CurrentObj.GetUserList_Soft(e,t):$myErrorRtnFunc("",e,t)}function GetSignCert(e,t,n){return null!=$_$CurrentObj?$_$CurrentObj.ExportUserSignCert(e,t,n):$myErrorRtnFunc("",t,n)}function GetExchCert(e,t,n){return null!=$_$CurrentObj?$_$CurrentObj.ExportUserExchangeCert(e,t,n):$myErrorRtnFunc("",t,n)}function VerifyUserPIN(e,t,n,r){return null!=$_$CurrentObj?$_$CurrentObj.VerifyUserPIN(e,t,n,r):$myErrorRtnFunc(!1,n,r)}function ChangeUserPassword(e,t,n,r,o){return null!=$_$CurrentObj?$_$CurrentObj.ChangeUserPIN(e,t,n,r,o):$myErrorRtnFunc(!1,r,o)}function GetUserPINRetryCount(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return null!=$_$CurrentObj?$_$CurrentObj.GetUserPINRetryCount(e,t,n):$myErrorRtnFunc(0,t,n)}function GetCertBasicinfo(e,t,n,r){return null!=$_$CurrentObj?$_$CurrentObj.GetCertInfo(e,t,n,r):$myErrorRtnFunc("",n,r)}function GetExtCertInfoByOID(e,t,n,r){return null!=$_$CurrentObj?$_$CurrentObj.GetCertInfoByOID(e,t,n,r):$myErrorRtnFunc("",n,r)}function GetCertEntity(e,t,n){return null!=$_$CurrentObj?$_$CurrentObj.GetCertEntity(e,t,n):$myErrorRtnFunc("",t,n)}function GenerateRandom(e,t,n){return null!=$_$CurrentObj?$_$CurrentObj.GenRandom(e,t,n):$myErrorRtnFunc("",t,n)}function SignedData(e,t,n,r){return null!=$_$CurrentObj?$_$CurrentObj.SignData(e,t,n,r):$myErrorRtnFunc("",n,r)}function VerifySignedData(e,t,n,r,o){return null!=$_$CurrentObj?$_$CurrentObj.VerifySignedData(e,t,n,r,o):$myErrorRtnFunc(!1,r,o)}function PubKeyEncrypt(e,t,n,r){return null!=$_$CurrentObj?$_$CurrentObj.PubKeyEncrypt(e,t,n,r):$myErrorRtnFunc("",n,r)}function PriKeyDecrypt(e,t,n,r){return null!=$_$CurrentObj?$_$CurrentObj.PriKeyDecrypt(e,t,n,r):$myErrorRtnFunc("",n,r)}function SignByP7(e,t,n,r,o){return null!=$_$CurrentObj?$_$CurrentObj.SignDataByP7(e,t,n,r,o):$myErrorRtnFunc("",r,o)}function VerifyDatabyP7(e,t,n,r){return null!=$_$CurrentObj?$_$CurrentObj.VerifyDataByP7(e,t,n,r):$myErrorRtnFunc("",n,r)}function EncodeP7Enveloped(e,t,n,r){return null!=$_$CurrentObj?$_$CurrentObj.EncyptMessage(e,t,n,r):$myErrorRtnFunc("",n,r)}function DecodeP7Enveloped(e,t,n,r){return null!=$_$CurrentObj?$_$CurrentObj.DecryptMessage(e,t,n,r):$myErrorRtnFunc("",n,r)}function SignFile(e,t,n,r){return null!=$_$CurrentObj?$_$CurrentObj.SignFile(e,t,n,r):$myErrorRtnFunc("",n,r)}function VerifySignFile(e,t,n,r,o){return null!=$_$CurrentObj?$_$CurrentObj.VerifySignFile(e,t,n,r,o):$myErrorRtnFunc(!1,r,o)}function GetSymKeyLength(e,t){return null!=$_$CurrentObj?$_$CurrentObj.GetSymKeyLength(e,t):$myErrorRtnFunc(24,e,t)}function EncryptData(e,t,n,r){return null!=$_$CurrentObj?$_$CurrentObj.SymEncryptData(e,t,n,r):$myErrorRtnFunc("",n,r)}function DecryptData(e,t,n,r){return null!=$_$CurrentObj?$_$CurrentObj.SymDecryptData(e,t,n,r):$myErrorRtnFunc("",n,r)}function EncryptFile(e,t,n,r,o){return null!=$_$CurrentObj?$_$CurrentObj.SymEncryptFile(e,t,n,r,o):$myErrorRtnFunc(!1,r,o)}function DecryptFile(e,t,n,r,o){return null!=$_$CurrentObj?$_$CurrentObj.SymDecryptFile(e,t,n,r,o):$myErrorRtnFunc(!1,r,o)}function ValidateCert(e,t,n){return null!=$_$CurrentObj?$_$CurrentObj.ValidateCert(e,t,n):$myErrorRtnFunc(!1,t,n)}function GetDeviceType(e,t,n){return null!=$_$CurrentObj&&void 0!=$_$CurrentObj.GetDeviceType?$_$CurrentObj.GetDeviceType(e,t,n):$myErrorRtnFunc("HARD",t,n)}function HashFile(e,t,n){return null!=$_$CurrentObj&&void 0!=$_$CurrentObj.HashFile?$_$CurrentObj.HashFile(e,t,n):$myErrorRtnFunc("",t,n)}function SignHashData(e,t,n,r,o){return null!=$_$CurrentObj&&void 0!=$_$CurrentObj.SignHashData?$_$CurrentObj.SignHashData(e,t,n,r,o):$myErrorRtnFunc("",r,o)}function VerifySignedHashData(e,t,n,r,o,a){return null!=$_$CurrentObj&&void 0!=$_$CurrentObj.VerifySignedHashData?$_$CurrentObj.VerifySignedHashData(e,t,n,r,o,a):$myErrorRtnFunc(!1,o,a)}function GetDateNotBefore(e){return null!=$_$CurrentObj?$_$CurrentObj.GetDateNotBefore(e):""}function GetDateNotAfter(e){return null!=$_$CurrentObj?$_$CurrentObj.GetDateNotAfter(e):""}function SetSignMethod(e,t,n){return null!=$_$CurrentObj?$_$CurrentObj.SetSignMethod(e,t,n):""}function ExportUserSignCert(e,t,n){return null!=$_$CurrentObj?$_$CurrentObj.ExportUserSignCert(e,t,n):""}function GetCertInfo(e,t,n,r){return null!=$_$CurrentObj?$_$CurrentObj.GetCertInfo(e,t,n,r):""}function $loginSignRandomCallBack(e){if(""!=e.retVal){var t=e.ctx.objForm,n=e.ctx.action;t.UserSignedData.value=e.retVal,t.action=n,t.submit()}else $XTXAlert("客户端签名失败!")}function $loginVerifyServerSignatureCallBack(e){if(e.retVal){var t,n=e.ctx.certID;SignedData(n,t,$loginSignRandomCallBack,e.ctx)}else $XTXAlert("验证服务器端信息失败!")}function $loginCheckCertValidNotAfter(e){var t=GetDateNotAfter(e.retVal),n=t.getTime()-(new Date).getTime();if(n<0)$XTXAlert("您的证书已过期，请尽快到北京数字证书认证中心办理证书更新手续！");else{var r,o,a,i=parseInt((n/864e5).toString());if(i>0&&i<=60)$XTXAlert("您的证书还有"+i+"天过期\n请您尽快到北京数字证书认证中心办理证书更新手续！");else if(0==i){var s=parseInt((n/36e5).toString());s>0&&$XTXAlert("您的证书还有"+s+"小时过期\n您尽快到北京数字证书认证中心办理证书更新手续！");var c=parseInt((n/6e4).toString());if(!(c>1))return void $XTXAlert("您的证书已过期，请尽快到北京数字证书认证中心办理证书更新手续！");$XTXAlert("您的证书还有"+c+"分钟过期\n您尽快到北京数字证书认证中心办理证书更新手续！")}VerifySignedData(r,o,a,$loginVerifyServerSignatureCallBack,e.ctx)}}function $loginCheckCertValidNotBefore(e){var t=GetDateNotBefore(e.retVal),n=parseInt(((t.getTime()-(new Date).getTime())/864e5).toString());if(n>0)$XTXAlert("您的证书尚未生效!距离生效日期还剩"+n+"天!");else{var r=e.ctx.objForm.UserCert.value;GetCertBasicinfo(r,CERT_OID_NOT_AFTER,$loginCheckCertValidNotAfter,e.ctx)}}function $loginGetSignCertCallBack(e){var t=e.retVal;""!=t?(e.ctx.objForm.UserCert.value=t,GetCertBasicinfo(t,CERT_OID_NOT_BEFORE,$loginCheckCertValidNotBefore,e.ctx)):$XTXAlert("导出用户证书失败!")}function $loginGetPINRetryCallBack(e){var t=Number(e.retVal);return t>0?void $XTXAlert("校验证书密码失败!您还有"+t+"次机会重试!"):0==t?void $XTXAlert("您的证书密码已被锁死,请联系BJCA进行解锁!"):void $XTXAlert("登录失败!")}function $loginVerifyPINCallBack(e){var t=e.ctx.certID,n=e.ctx.objForm;e.retVal?(n.ContainerName.value=t,GetSignCert(t,$loginGetSignCertCallBack,e.ctx)):GetUserPINRetryCount(t,$loginGetPINRetryCallBack)}function Logout(e,t,n){if(null!=$_$WebSocketObj&&void 0!=$_$WebSocketObj.Logout)return $_$WebSocketObj.Logout(e,t,n)}function Login(formName,strCertID,strPin,strAction){var objForm=eval(formName);if(null!=objForm)if(null!=strCertID&&""!=strCertID)if(null!=strPin&&""!=strPin){var strSignItem='<input type="hidden" name="UserSignedData" value="">';null==objForm.UserSignedData&&objForm.insertAdjacentHTML("BeforeEnd",strSignItem);var strCertItem='<input type="hidden" name="UserCert" value="">';null==objForm.UserCert&&objForm.insertAdjacentHTML("BeforeEnd",strCertItem);var strContainerItem='<input type="hidden" name="ContainerName" value="">';null==objForm.ContainerName&&objForm.insertAdjacentHTML("BeforeEnd",strContainerItem);var ctx={certID:strCertID,objForm:objForm,action:strAction};VerifyUserPIN(strCertID,strPin,$loginVerifyPINCallBack,ctx)}else $XTXAlert("请输入证书密码！");else $XTXAlert("请输入证书密码！");else $XTXAlert("表单错误！")}function CreateGetPicObject(){var e=$LoadControl("3BC3C868-95B5-47ED-8686-E0E3E94EF366","OGetPic","GetPic()",!1);if(!e)return null;var t=new Object;return t.GetPic=function(e,t,n){var r=OGetPic.GetPic(e);return $myOKRtnFunc(r,t,n)},t.Hash=function(e,t,n){var r=OGetPic.Hash(e);return $myOKRtnFunc(r,t,n)},t.ConvertPicFormat=function(e,t,n,r){var o=OGetPic.ConvertPicFormat(e,t);return $myOKRtnFunc(o,n,r)},t.ConvertGif2Jpg=function(e,t,n){var r=OGetPic.ConvertGif2Jpg(e);return $myOKRtnFunc(r,t,n)},t.ConvertPicSize=function(e,t,n,r,o){var a=OGetPic.ConvertPicSize(e,t,n);return $myOKRtnFunc(a,r,o)},t}function GetPic(e,t,n){return null!=$_$WebSocketObj&&void 0!=$_$WebSocketObj.GetPic?$_$WebSocketObj.GetPic(e,t,n):null!=$_$GetPicObj&&void 0!=$_$GetPicObj.GetPic?$_$GetPicObj.GetPic(e,t,n):$myErrorRtnFunc("",t,n)}function Hash(e,t,n){return null!=$_$WebSocketObj&&void 0!=$_$WebSocketObj.Hash?$_$WebSocketObj.Hash(e,t,n):null!=$_$GetPicObj&&void 0!=$_$GetPicObj.Hash?$_$GetPicObj.Hash(e,t,n):$myErrorRtnFunc("",t,n)}function ConvertPicFormat(e,t,n,r){return null!=$_$WebSocketObj&&void 0!=$_$WebSocketObj.ConvertPicFormat?$_$WebSocketObj.ConvertPicFormat(e,t,n,r):null!=$_$GetPicObj&&void 0!=$_$GetPicObj.ConvertPicFormat?$_$GetPicObj.ConvertPicFormat(e,t,n,r):$myErrorRtnFunc("",n,r)}function ConvertGif2Jpg(e,t,n){return null!=$_$WebSocketObj&&void 0!=$_$WebSocketObj.ConvertGif2Jpg?$_$WebSocketObj.ConvertGif2Jpg(e,t,n):null!=$_$GetPicObj&&void 0!=$_$GetPicObj.ConvertGif2Jpg?$_$GetPicObj.ConvertGif2Jpg(e,t,n):$myErrorRtnFunc("",t,n)}function ConvertPicSize(e,t,n,r,o){return null!=$_$WebSocketObj&&void 0!=$_$WebSocketObj.ConvertPicSize?$_$WebSocketObj.ConvertPicSize(e,t,n,r,o):null!=$_$GetPicObj&&void 0!=$_$GetPicObj.ConvertPicSize?$_$GetPicObj.ConvertPicSize(e,t,n,r,o):$myErrorRtnFunc("",r,o)}function EnvInitStart(){return _EnvInitStart.apply(this,arguments)}function _EnvInitStart(){return _EnvInitStart=_asyncToGenerator(C_Users_yuan_Desktop_jquery_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark((function e(){return C_Users_yuan_Desktop_jquery_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(envRequired=!0,$_$GetPicObj=CreateGetPicObject(),window.isXTXAppSocketReady?$_$WebSocketObj=window.xtxSocket:(maxConnectServerTimes=3,window.xtxSocket=$_$WebSocketObj=CreateWebSocketObject()),null==$_$WebSocketObj){e.next=6;break}return $_$CurrentObj=$_$WebSocketObj,e.abrupt("return");case 6:if($_$XTXAppObj=CreateXTXAppObject(),null==$_$XTXAppObj){e.next=10;break}return $_$CurrentObj=$_$XTXAppObj,e.abrupt("return");case 10:if($_$SecXV2Obj=CreateSecXV2Object(),null==$_$SecXV2Obj){e.next=14;break}return $_$CurrentObj=$_$SecXV2Obj,e.abrupt("return");case 14:if($_$SecXObj=CreateSecXObject(),null==$_$SecXObj){e.next=18;break}return $_$CurrentObj=$_$SecXObj,e.abrupt("return");case 18:return $_$CurrentObj=null,ant_design_vue_es_message__WEBPACK_IMPORTED_MODULE_2__["a"].error("检查证书应用环境出错!"),e.abrupt("return");case 21:case"end":return e.stop()}}),e)}))),_EnvInitStart.apply(this,arguments)}function EnvExit(){return _EnvExit.apply(this,arguments)}function _EnvExit(){return _EnvExit=_asyncToGenerator(C_Users_yuan_Desktop_jquery_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark((function e(){return C_Users_yuan_Desktop_jquery_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:envRequired=!1;case 1:case"end":return e.stop()}}),e)}))),_EnvExit.apply(this,arguments)}},"80f3":function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e["ACTION_INPUT"]="input",e["ACTION_COMPLETE"]="complete",e["ACTION_BACK_PREV"]="back_prev",e["ACTION_BACK_FIRST"]="back_first",e["ACTION_BACK_ANY"]="back_any",e["ACTION_RECALL"]="cancel",e["ACTION_CLAIM"]="claim",e["ACTION_DELEGATE"]="delegate",e["ACTION_RESOLVE"]="resolve",e["ACTION_JUMP"]="jump",e["ACTION_CIRCULATE"]="circulate"}(r||(r={}))},b73b:function(e,t){},cd49:function(e,t,n){"use strict";n.r(t);n("ead9");var r=n("e2a6"),o=(n("7b70"),n("d4ce")),a=(n("6984"),n("1ea4")),i=(n("4d11"),n("7903")),s=(n("d1ae"),n("ca37")),c=(n("1b04"),n("aa88")),u=(n("f5aa"),n("cb70")),l=(n("ccc7"),n("5419")),d=(n("80c4"),n("7883")),p=(n("3f2a"),n("c147")),f=(n("9d19"),n("2aae")),h=(n("1e57"),n("0dfd")),y=(n("e251"),n("16e2")),m=(n("480c"),n("c30e")),_=(n("2739"),n("0436")),b=(n("b326"),n("156a")),g=(n("8f9f"),n("8060")),v=(n("c63c"),n("b45c")),w=(n("4c6e"),n("0801")),k=(n("f78c"),n("f390")),O=(n("ec6a"),n("5ce6")),C=(n("86a4"),n("04af")),S=(n("89ec"),n("a37a")),E=(n("ae1b"),n("fd91")),I=(n("4d68"),n("7c64")),x=(n("3c88"),n("9d72")),$=(n("9483"),n("9c78")),T=(n("1138"),n("07d8")),D=(n("e926"),n("f4b8")),j=(n("303b"),n("03c3")),P=(n("61ee"),n("5a07")),R=(n("a684"),n("946e")),N=(n("12ab"),n("b469")),L=(n("b034"),n("a808")),A=(n("0dda"),n("cda1")),M=(n("b71d"),n("3bf0")),U=(n("3f88"),n("66a8")),F=(n("ea08"),n("0e78")),B=(n("074d"),n("0859")),K=(n("6f0a"),n("a9e2")),W=(n("a5a5"),n("5473")),G=(n("21e8"),n("c47c")),V=(n("908e"),n("6f84"),n("e697"),n("e204"),n("ec25"),n("ed63"),n("e44b"),n("d703"),n("5ad9"),n("d6d4"),n("79dd"),n("c2db"),n("cc57"),n("88c5"),n("7b4d"),n("2786"),n("37da"),n("bd3c"),n("8a8c"),n("cdb3"),n("6e73"),n("40af"),n("bca3"),n("b4aa"),n("d27b"),n("0970"),n("6e15"),n("574e"),n("f7c9"),n("ba67"),n("f654"),n("163d"),n("add6"),n("936a"),n("c982"),n("9d30"),n("3299"),n("7c83"),n("6e41"),n("5431"),n("a51b"),n("5f54"),n("d345"),n("7aa2"),n("1736"),n("9251"),n("cda4"),n("5ab2"),n("3da6"),n("68bb"),n("3734"),n("8cae"),n("d89e"),n("6c5f"),n("cdcd"),n("8fee"),n("a9e5"),n("e10e"),n("fe95"),n("041c"),n("de78"),n("6648"),n("f0e6"),n("354b"),n("fc58"),n("d288"),n("8ad2"),n("745a"),n("8f38"),n("0a5e"),n("44f8"),n("5a83"),n("25fa"),n("de7e"),n("1034"),n("6ffb"),n("9dd9"),n("190b"),n("9e76"),n("f548"),n("9a33"),n("c0c3"),n("2b45"),n("2aa3"),n("0b53"),n("309f"),n("41ca"),n("baf8"),n("be7a"),n("55ab"),n("41bc"),n("616f"),n("c86c"),n("9540"),n("d3a6"),n("f2d4"),n("8cf2"),n("7f85"),n("06a2"),n("5490"),n("70da"),n("7ced"),n("b9e6"),n("51f1"),n("a651"),n("6491"),n("962c"),n("4fd7"),n("238e"),n("4395"),n("df38"),n("d58b"),n("47e7"),n("f8b9"),n("5c65"),n("93b1"),n("0055"),n("3861"),n("435b"),n("154f"),n("c5c2"),n("b6f9"),n("9b8d"),n("595b"),n("6d57"),n("b449"),n("eaf6")),X=n("0372"),z=n("4bb7");function H(e){return H="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},H(e)}function q(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function J(e,t,n){return t&&Y(e.prototype,t),n&&Y(e,n),e}function Q(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Z(e,t)}function Z(e,t){return Z=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Z(e,t)}function ee(e){var t=re();return function(){var n,r=oe(e);if(t){var o=oe(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return te(this,n)}}function te(e,t){return!t||"object"!==H(t)&&"function"!==typeof t?ne(e):t}function ne(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function re(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function oe(e){return oe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},oe(e)}var ae=function(){var e=function(e){Q(n,e);var t=ee(n);function n(){return q(this,n),t.apply(this,arguments)}return J(n,[{key:"render",value:function(){var e=arguments[0];return e("div")}}]),n}(z["d"]);return e=Object(X["a"])([Object(z["a"])({components:{}})],e),e}(),ie=ae,se=(n("68b1"),n("c97b")),ce=n.n(se),ue=n("f753"),le=n.n(ue);function de(e,t){var n;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=pe(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw a}}}}function pe(e,t){if(e){if("string"===typeof e)return fe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?fe(e,t):void 0}}function fe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function he(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ye(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function me(e,t,n){return t&&ye(e.prototype,t),n&&ye(e,n),e}var _e={modeler_base:"",flow_process_base:""};function be(){return console.log("getModelerBase",_e.modeler_base),_e.modeler_base}function ge(){return _e.flow_process_base}var ve=function(){function e(){he(this,e),this._userCode="",this._authToken="",this._debug=!1,this._appCode="",this._rgCode="",this._data={}}return me(e,[{key:"WORKFLOW_GLOBAL_CONFIG_URL",value:function(){return be()+"/config/components.json"}},{key:"WORKFLOW_IS_STARTED_URL",value:function(e){return ge()+"/api/runtime/process-isstart/".concat(e)}},{key:"WORKFLOW_IS_ENDED_URL",value:function(e){return ge()+"/api/runtime/process-isend-new/".concat(e)}},{key:"APPROVE_BY_TASKID_URL",value:function(e){return ge()+"/api/runtime/fbpm-approve-tasks-new/".concat(e)}},{key:"APPROVE_BY_BUSSINESSKEY_URL",value:function(e){return ge()+"/api/runtime/fbpm-approve-tasks-form-new/".concat(e)}},{key:"WORKFLOW_REMARK_SAVE_URL",value:function(){return ge()+"/api/runtime/comlang/save"}},{key:"WORKFLOW_IS_REMARK_DUP_URL",value:function(){return ge()+"/api/runtime/comlang/querycomlang"}},{key:"WORKFLOW_REMARK_DELETE_URL",value:function(e){return ge()+"/api/runtime/comlang/delete/".concat(e)}},{key:"WORKFLOW_REMARK_STAR_URL",value:function(){return ge()+"/api/runtime/comlang/setstar"}},{key:"getNodeBackActionUrl",value:function(e){return ge()+"/api/runtime/fbpm-tasks-back-taskId/".concat(e)}},{key:"getNodeCancelActionWithBusinessKeyUrl",value:function(e){return ge()+"/api/runtime/fbpm-tasks-businesskey-cancel/".concat(e)}},{key:"getNodeCancelActionUrl",value:function(e){return ge()+"/api/runtime/fbpm-tasks-cancel/".concat(e)}},{key:"getFirstNodeInfoUrl",value:function(){return ge()+"/api/runtime/proc-node/getFirstNodesByBizRgUnitCode"}},{key:"getNodeTraceSimpleUrl",value:function(e){return ge()+"/api/query/track-tasks-new/".concat(e)}},{key:"getNodeTraceFullUrl",value:function(e){return ge()+"/api/query/track-all-tasks/".concat(e)}},{key:"getNodeTraceFormUrl",value:function(){return ge()+"/api/query/track-tasks/bills"}},{key:"getNodeTraceListUrl",value:function(e){return ge()+"/api/query/track-tasks-list/".concat(e)}},{key:"getNodeTraceFlowchartUrl",value:function(e){return ge()+"/api/query/track-tasks-vector/".concat(e)}},{key:"WORKFLOW_USER_INFO_URL",value:function(){return ge()+"/api/identity/userinfo"}},{key:"WORKFLOW_INFO",value:function(e){return ge()+"/api/runtime/processQueryBybusinessKey/".concat(e)}},{key:"WORKFLOW_INFO_IMAGE_URL",value:function(e){return be()+"/showImage?procDefId=".concat(e)}},{key:"WORKFLOW_USER_INFO_LIST_URL",value:function(){return be()+"/api/identity/userinfo"}},{key:"WORKFLOW_USER_DELEGATE_URL",value:function(){return ge()+"/api/query/track-tasks-taskdelegate"}},{key:"WORKFLOW_ACTIVATE_URL",value:function(e){return ge()+"/api/runtime/fbpm-process-instances/reactive/".concat(e)}},{key:"WORKFLOW_UNITS_URL",value:function(){return be()+"/api/identity/flowUnitTreeNew"}},{key:"WORKFLOW_DEPTS_URL",value:function(){return be()+"/api/identity/flowDeptTreeNew"}},{key:"WORKFLOW_DEPT_USERS_URL",value:function(){return be()+"/api/identity/identityList"}},{key:"SIGN_SAVE_URL",value:function(){return ge()+"/signature/save"}},{key:"SIGN_QUERY_URL",value:function(e){return ge()+"/signature/query/".concat(e)}},{key:"SIGN_QUERY_NODE_URL",value:function(e){return ge()+"/signature/query/node/".concat(e)}},{key:"GET_HISTORY_MANUAL_SIGN",value:function(){return ge()+"/signature/getHistoryManualSign"}},{key:"SAVE_AS_HISTORY_MANUAL_SIGN",value:function(){return ge()+"/signature/saveHistoryManualSign"}},{key:"APPROVE_ELEMENTS_QUERY_URL",value:function(e){return ge()+"/api/runtime/element/query/".concat(e)}},{key:"WORKFLOW_BATCH_APPROVE_URL",value:function(e){return ge()+"/api/runtime/approve-batch-tasks/".concat(e)}},{key:"WORKFLOW_IS_DIRECT_APPROVE_URL",value:function(e){return ge()+"/api/runtime/fbpm-task-isback/".concat(e)}},{key:"WORKFLOW_DIRECT_APPROVE_TASKID_URL",value:function(e){return ge()+"/api/runtime/fbpm-tasks-directsubmit-taskId/".concat(e)}},{key:"WORKFLOW_DIRECT_APPROVE_BUSINESSKEY_URL",value:function(e){return ge()+"/api/runtime/fbpm-tasks-directsubmit-businesskey/".concat(e)}},{key:"WORKFLOW_PORTAL_TODO_LIST_URL",value:function(){return ge()+"/center/task/todo"}},{key:"WORKFLOW_PORTAL_CREATOR_URL",value:function(){return ge()+"/center/task/creator"}},{key:"WORKFLOW_ADMIN_CONFIG_URL",value:function(){return be()+"/config/admin-config.json"}},{key:"WORKFLOW_VARIABLES_URL",value:function(){return ge()+"/api/runtime/task/variables"}},{key:"setBaseAddress",value:function(e,t){console.log("setBaseAddress",e,t),_e.flow_process_base=t,_e.modeler_base=e}},{key:"setUserCode",value:function(e){this._userCode=e}},{key:"setAppCode",value:function(e){this._appCode=e}},{key:"setRegionCode",value:function(e){this._rgCode=e}},{key:"setAuthToken",value:function(e){this._authToken=e}},{key:"setDebug",value:function(e){this._debug=e}},{key:"getData",value:function(e){var t,n=e.split("."),r=this._data,o=de(n);try{for(o.s();!(t=o.n()).done;){var a=t.value;if(void 0===r[a])return;r=r[a]}}catch(i){o.e(i)}finally{o.f()}return r}},{key:"setData",value:function(e){console.log("components-config",e),this._data=e}},{key:"userCode",get:function(){return this._userCode}},{key:"appCode",get:function(){return this._appCode}},{key:"rgCode",get:function(){return this._rgCode}},{key:"authToken",get:function(){return this._authToken}},{key:"debug",get:function(){return this._debug}},{key:"WORKFLOW_START_URL",get:function(){return ge()+"/api/runtime/fbpm-process-instances"}},{key:"WORKFLOW_SUSPEND_URL",get:function(){return ge()+"/api/runtime/fbpm-process-instances/suspend"}},{key:"WORKFLOW_RESUME_URL",get:function(){return ge()+"/api/runtime/fbpm-process-instances/active"}},{key:"WORKFLOW_TASKS_URL",get:function(){return ge()+"/api/runtime/fbpm-user-task/taskList"}},{key:"NODE_INFO_URL",get:function(){return be()+"/api/flowNode/getNodeInfo"}},{key:"NODE_STEPS_URL",get:function(){return ge()+"/api/runtime/flowNode/getNextNodesNew"}},{key:"NODE_CANCEL_START_URL",get:function(){return ge()+"/api/cancelTask/getCancelStartNodes"}},{key:"NODE_TYPES_URL",get:function(){return be()+"/api/identity/identityTypeNew"}},{key:"NODE_CATALOG_URL",get:function(){return be()+"/api/identity/identityType/listNew"}},{key:"NODE_USER_LIST_URL",get:function(){return be()+"/api/identity/identityListNew"}},{key:"NODE_BACK_NODE_INFO_URL",get:function(){return ge()+"/api/back/getBackToNodeInfo"}},{key:"NODE_BACK_NODE_LIST_URL",get:function(){return ge()+"/api/back/getBackToAnyNodeInfos"}},{key:"NODE_CAN_REVOKE_URL",get:function(){return ge()+"/api/cancelTask/isPermitCancelTask"}},{key:"NODE_CAN_REVOKE_BUSINESSKEY_URL",get:function(){return ge()+"/api/cancelTask/isPermitCancelTaskByBusinessKeyAndTaskId"}},{key:"WORKFLOW_REMARK_LIST_URL",get:function(){return ge()+"/api/runtime/comlang"}}]),e}(),we=new ve;function ke(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Oe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ke(Object(n),!0).forEach((function(t){Ce(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ke(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ce(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Se(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ee(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ie(e,t,n){return t&&Ee(e.prototype,t),n&&Ee(e,n),e}var xe=function(){function e(){Se(this,e),this._beforeRequest=function(){},this._afterRequest=function(){},this._onError=function(e,t){return!1}}return Ie(e,[{key:"onBeforeRequest",value:function(e){this._beforeRequest=e}},{key:"onAfterRequest",value:function(e){this._afterRequest=e}},{key:"onError",value:function(e){this._onError=e}},{key:"delete",value:function(e){var t=this;return this._beforeRequest(),we.authToken&&(le.a.defaults.headers.common["Authorization"]=we.authToken),le.a.defaults.headers.post["Content-Type"]="application/json",le.a.delete(e).then((function(e){if(100200==e.data.code||100201==e.data.code)return e.data.data;throw e.data})).catch((function(n){throw t._onError&&t._onError(e,n),n}))}},{key:"post",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._beforeRequest(),we.authToken&&(le.a.defaults.headers.common["Authorization"]=we.authToken),le.a.defaults.headers.post["Content-Type"]="application/json",le.a.post(e,Oe({},n)).then((function(e){if(t._afterRequest(),100200==e.data.code||100201==e.data.code)return e.data.data;throw e.data})).catch((function(n){throw t._onError&&t._onError(e,n),n}))}},{key:"getOld",value:function(e,t){var n=this,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return le.a.get(e,{params:Oe({},t)}).then((function(e){return n._afterRequest(),e.data})).catch((function(t){throw r&&n._onError&&n._onError(e,t),t}))}},{key:"get",value:function(e,t){var n=this,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return we.authToken&&(le.a.defaults.headers.common["Authorization"]=we.authToken),le.a.get(e,{params:Oe({},t)}).then((function(e){if(n._afterRequest(),100200==e.data.code||100201==e.data.code||"success"===e.data.status)return e.data.data;throw e.data})).catch((function(t){throw console.log("aaaaa",t),r&&n._onError&&n._onError(e,t),t}))}},{key:"getJson",value:function(e,t){var n=this,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return we.authToken&&(le.a.defaults.headers.common["Authorization"]=we.authToken),le.a.get(e,{params:Oe({},t)}).then((function(e){return n._afterRequest(),e.data})).catch((function(t){throw r&&n._onError&&n._onError(e,t),t}))}}]),e}(),$e=new xe;function Te(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function De(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Te(Object(n),!0).forEach((function(t){je(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Te(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function je(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Pe(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,o)}function Re(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){Pe(a,r,o,i,s,"next",e)}function s(e){Pe(a,r,o,i,s,"throw",e)}i(void 0)}))}}function Ne(){return Le.apply(this,arguments)}function Le(){return Le=Re(ce.a.mark((function e(){var t;return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,$e.getOld(we.WORKFLOW_ADMIN_CONFIG_URL(),{});case 3:return t=e.sent,e.abrupt("return",t);case 7:e.prev=7,e.t0=e["catch"](0);case 9:return e.abrupt("return",null);case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),Le.apply(this,arguments)}function Ae(e){return $e.get(we.WORKFLOW_IS_STARTED_URL(e),{})}function Me(e){return $e.get(we.WORKFLOW_IS_ENDED_URL(e),{})}function Ue(e){return $e.get(we.WORKFLOW_INFO(e),{userCode:we.userCode})}function Fe(e){return $e.post(we.WORKFLOW_START_URL,e,!1)}function Be(e){return $e.post("".concat(we.WORKFLOW_SUSPEND_URL,"/").concat(e),{},!1)}function Ke(e){return $e.post("".concat(we.WORKFLOW_RESUME_URL,"/").concat(e),{},!1)}function We(e){return $e.get(we.NODE_INFO_URL,e)}function Ge(e){return $e.post(we.getFirstNodeInfoUrl(),e)}function Ve(e){return $e.post(we.NODE_STEPS_URL,e)}function Xe(e){return $e.get(we.NODE_CANCEL_START_URL,e)}function ze(e){return $e.get(we.NODE_TYPES_URL,e)}function He(e){return $e.post(we.NODE_CATALOG_URL,De(De({},e),{},{userCode:we.userCode}))}function qe(e){return $e.get(we.NODE_USER_LIST_URL,e)}function Ye(e){return $e.get(we.getNodeTraceSimpleUrl(e.procInstId),{})}function Je(e){return Qe.apply(this,arguments)}function Qe(){return Qe=Re(ce.a.mark((function e(t){return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",$e.post(we.getNodeTraceFullUrl(t.procInstId),{variables:t.variables}));case 1:case"end":return e.stop()}}),e)}))),Qe.apply(this,arguments)}function Ze(e){return et.apply(this,arguments)}function et(){return et=Re(ce.a.mark((function e(t){return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",$e.get(we.getNodeTraceFormUrl(),t));case 1:case"end":return e.stop()}}),e)}))),et.apply(this,arguments)}function tt(e){return nt.apply(this,arguments)}function nt(){return nt=Re(ce.a.mark((function e(t){return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",$e.get(we.getNodeTraceListUrl(t.procInstId),{sort:t.sort}));case 1:case"end":return e.stop()}}),e)}))),nt.apply(this,arguments)}function rt(e){return $e.get(we.getNodeTraceFlowchartUrl(e),{})}function ot(e,t){return $e.post(we.APPROVE_BY_TASKID_URL(e),De(De({},t),{},{userCode:we.userCode}),!1)}function at(e,t){return $e.post(we.APPROVE_BY_BUSSINESSKEY_URL(e),De(De({},t),{},{userCode:we.userCode}),!1)}function it(e){return $e.get("".concat(we.NODE_BACK_NODE_INFO_URL),e)}function st(e){return $e.get("".concat(we.NODE_BACK_NODE_LIST_URL),e)}function ct(e,t){return $e.post(we.getNodeCancelActionUrl(e),De(De({},t),{},{userCode:we.userCode}),!1)}function ut(e,t){return $e.post(we.getNodeCancelActionWithBusinessKeyUrl(e),De(De({},t),{},{userCode:we.userCode}),!1)}function lt(e,t){return $e.post(we.getNodeBackActionUrl(e),De(De({},t),{},{userCode:we.userCode}),!1)}function dt(e,t){try{return $e.get(we.NODE_CAN_REVOKE_BUSINESSKEY_URL,{businessKey:e,taskId:t},!1)}catch(n){return!1}}function pt(e){return $e.post(we.WORKFLOW_USER_INFO_LIST_URL(),De(De({},e),{},{appCode:we.appCode,rgCode:we.rgCode}))}function ft(e){return $e.get("".concat(we.WORKFLOW_USER_DELEGATE_URL()),{taskIds:e||""})}function ht(e,t){var n=e+"/fbpm/adapter/findRoleByRoleIds";return $e.get(n,t)}function yt(e,t){return $e.post(we.WORKFLOW_ACTIVATE_URL(e),De(De({},t),{},{businessKey:e,userCode:we.userCode}))}function mt(e){return we.WORKFLOW_INFO_IMAGE_URL(e)}function _t(e,t){return $e.post(we.WORKFLOW_BATCH_APPROVE_URL(e),t)}function bt(e,t){return $e.post(we.WORKFLOW_DIRECT_APPROVE_TASKID_URL(e),t)}function gt(e){return $e.get(we.WORKFLOW_IS_DIRECT_APPROVE_URL(e),{},!1)}function vt(e){return $e.get(we.WORKFLOW_VARIABLES_URL(),{procInstId:e})}function wt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function kt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?wt(Object(n),!0).forEach((function(t){Ot(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):wt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ot(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ct(e){return $e.get(we.WORKFLOW_REMARK_LIST_URL,kt(kt({},e),{},{userCode:we.userCode}))}function St(e){return $e.delete(we.WORKFLOW_REMARK_DELETE_URL(e))}function Et(e){return $e.post(we.WORKFLOW_REMARK_SAVE_URL(),kt(kt({},e),{},{userCode:we.userCode}))}function It(e){return $e.get(we.WORKFLOW_IS_REMARK_DUP_URL(),kt(kt({},e),{},{userCode:we.userCode}),!1)}function xt(e){return $e.post(we.WORKFLOW_REMARK_STAR_URL(),kt(kt({},e),{},{userCode:we.userCode}))}function $t(e){var t=Math.round(e/1e3/86400*10)/10,n=parseInt(t.toString()),r=t-n;return t<.5?"":"".concat(r<.5?n:r>.5?n+1:t,"天")}function Tt(e,t,n){var r=0,o=[];return t.forEach((function(t){n[t]||(console.error("[".concat(e,"] 缺少参数").concat(t)),o.push(t),r++)})),r>0&&(console.log("[".concat(e,"]"),n),Pt("[".concat(e,"] 缺少参数").concat(o.join(",")))),0==r}function Dt(e,t,n,r){var o=0,a=0,i=[],s=[];return t.forEach((function(e){r[e]||(i.push(e),o++)})),n.forEach((function(e){r[e]||(s.push(e),a++)})),o>0&&a>0&&Pt("[".concat(e,"]缺少参数: ").concat(i.join(","),"或").concat(s.join(","))),0==o||0==a}function jt(e,t,n,r,o){var a=0,i=0,s=0,c=[],u=[],l=[];return t.forEach((function(e){o[e]||(c.push(e),a++)})),n.forEach((function(e){o[e]||(u.push(e),i++)})),r.forEach((function(e){o[e]||(l.push(e),s++)})),a>0&&i>0&&s>0&&Pt("[".concat(e,"]缺少参数: ").concat(c.join(","),"或").concat(u.join(","))),0==a||0==i||0==s}function Pt(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];console.log("[workflow] ".concat(e)),(we.debug||t)&&G["a"].error({message:we.debug?"DEBUG ":"提示",description:e})}function Rt(){function e(e){var t=(Math.random().toString(16)+"000000000").substr(2,8);return e?"-"+t.substr(0,4)+"-"+t.substr(4,4):t}return e()+e(!0)+e(!0)+e()}function Nt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Lt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Nt(Object(n),!0).forEach((function(t){At(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Nt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function At(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Mt(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,o)}function Ut(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){Mt(a,r,o,i,s,"next",e)}function s(e){Mt(a,r,o,i,s,"throw",e)}i(void 0)}))}}function Ft(e){return Bt.apply(this,arguments)}function Bt(){return Bt=Ut(ce.a.mark((function e(t){var n,r,o,a,i=arguments;return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=i.length>1&&void 0!==i[1]?i[1]:{},r=Lt(Lt({},n),t),!t.businessKey||t.taskId){e.next=10;break}return e.next=5,Ue(t.businessKey);case 5:return o=e.sent,o.businessKey=t.businessKey,e.abrupt("return",Lt(Lt({},r),o));case 10:return a={businessKey:t.businessKey||"",taskId:t.taskId||"",procDefId:t.procDefId||"",procInstId:t.procInstId||"",nodeId:t.nodeId||"",appCode:""},e.abrupt("return",Lt(Lt({},r),a));case 12:case"end":return e.stop()}}),e)}))),Bt.apply(this,arguments)}function Kt(e){return e&&e.length>20?e.substr(0,20)+"...":e}function Wt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"id",r={},o=[];for(var a in e)e[a][n]&&(e[a].value=e[a][n],e[a].title=e[a].name,r[e[a].id]=e[a]);for(var i in r)r[i].pId&&r[r[i].pId]?(r[r[i].pId].children||(r[r[i].pId].children=[]),r[r[i].pId].children.push(r[i])):r[i]&&o.push(r[i]);if(t){var s=function e(n){return n?n.filter((function(n){var r=!!n.title&&-1!=n.title.indexOf(t),o=void 0;return n.children&&(o=e(n.children)),n.children=o,r||!!o&&o.length>0})):[]};o=s(o)}return o}function Gt(e){console.log("getErrorInfo",e);var t={};return t.error=e.code||1,t.message=e.msg||e.message,e.response&&e.response.data&&(t.message=e.response.data.message),"Network Error"==t.message&&(t.message="网络错误，请检查网络后重试"),t}function Vt(e,t,n){var r=new Image;r.src=e,r.onload=function(){var e=r.width,o=r.height,a=e/o;t&&t<e&&(e=t,o=e/a);var i=1,s=document.createElement("canvas"),c=s.getContext("2d");if(c){var u=document.createAttribute("width");u.value=e.toString();var l=document.createAttribute("height");l.value=o.toString(),s.setAttributeNode(u),s.setAttributeNode(l),c.drawImage(r,0,0,e,o);var d=s.toDataURL("image/png",i);n&&n(d)}}}var Xt=n("357e");function zt(){Xt["g"]()}function Ht(){Xt["f"]()}function qt(e){Xt["i"]((function(){var t=Xt["c"]("1"),n=Xt["a"]("1"),r=Xt["b"]("1");console.log("signData",t),console.log("signMethod",n),console.log("imgData",r),e.onSuccess&&e.onSuccess(t,n,r)})),Xt["j"](e.defaultSignText,(function(){console.log("sign init success"),Xt["d"]("1",e.containerId,e.fieldId,!1),Xt["e"]("1",e.fieldId,e.left,e.top,e.imgWidth,e.imgHeight)}))}var Yt={ca:{sign:qt,init:zt,exit:Ht,signImage:en}};function Jt(e,t){var n=Yt[e];n?n.sign(t):W["a"].error("【参数错误】options未正确配置signType")}function Qt(e){var t=Yt[e];t&&t.init()}function Zt(e){var t=Yt[e];t&&t.exit()}function en(e,t,n){Xt["h"](e.checkSignKey,(function(){document.getElementById(e.elementId);var n=window.document.getElementById(e.containerElementId);if(null!=n){var r=e.elementId+"-img",o=document.getElementById(r);null!=o&&o.parentNode.removeChild(o);var a=document.createElement("img");a.setAttribute("id",r),a.style.position="absolute",e.signImage&&(a.src="data:image/gif;base64,"+e.signImage),e.imgWidth&&e.imgHeight&&(a.style.maxHeight=e.imgHeight+"px",a.style.maxWidth=e.imgWidth+"px"),n.appendChild(a),t&&t()}}),n)}function tn(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,o)}function nn(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){tn(a,r,o,i,s,"next",e)}function s(e){tn(a,r,o,i,s,"throw",e)}i(void 0)}))}}function rn(e,t){return on.apply(this,arguments)}function on(){return on=nn(ce.a.mark((function e(t,n){var r;return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r={name:"",appCode:we.appCode,rgCode:we.rgCode,unitCode:t},e.abrupt("return",$e.get(we.WORKFLOW_UNITS_URL(),r).then((function(e){return Wt(e,n)})));case 2:case"end":return e.stop()}}),e)}))),on.apply(this,arguments)}function an(e,t,n){var r={name:"",containUnit:n?"Y":"N",appCode:we.appCode,rgCode:we.rgCode,unitCode:e};return $e.get(we.WORKFLOW_DEPTS_URL(),r).then((function(e){return Wt(e,t)}))}function sn(e,t,n,r,o,a){return cn.apply(this,arguments)}function cn(){return cn=nn(ce.a.mark((function e(t,n,r,o,a,i){var s;return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return s={type:n,name:t,id:o,pageNum:a,pageSize:i,appCode:we.appCode,rgCode:we.rgCode,unitCode:r},e.abrupt("return",$e.get(we.WORKFLOW_DEPT_USERS_URL(),s));case 2:case"end":return e.stop()}}),e)}))),cn.apply(this,arguments)}function un(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ln(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?un(Object(n),!0).forEach((function(t){dn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):un(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function dn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function pn(e){return $e.post(we.SIGN_SAVE_URL(),ln(ln({},e),{},{userCode:we.userCode}),!1)}function fn(e){return $e.get(we.SIGN_QUERY_URL(e),{},!1)}function hn(e){return $e.get(we.SIGN_QUERY_NODE_URL(e),{},!1)}function yn(){return $e.getJson(we.WORKFLOW_GLOBAL_CONFIG_URL()+"?v="+Date.now(),{},!1)}function mn(e){return $e.post(we.GET_HISTORY_MANUAL_SIGN(),ln(ln({},e),{},{userCode:we.userCode}),!1)}function _n(e){return $e.post(we.SAVE_AS_HISTORY_MANUAL_SIGN(),ln(ln({},e),{},{userCode:we.userCode}),!1)}function bn(e){return $e.get(we.APPROVE_ELEMENTS_QUERY_URL(e),{},!1)}var gn=n("88e5"),vn={template:'\n    <svg t="1557803945505" class="icon" style="" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3490" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32"><path d="M513.536 958.464c-246.784 0-448-201.216-448-448s201.216-448 448-448 448 201.216 448 448-200.704 448-448 448z m0-836.608c-214.016 0-388.096 174.08-388.096 388.096s174.08 388.096 388.096 388.096 388.096-174.08 388.096-388.096c0-213.504-174.08-388.096-388.096-388.096z" fill="#323333" p-id="3491"></path><path d="M749.056 542.208h-471.04c-11.264 0-20.48-9.216-20.48-20.48v-23.04c0-11.264 9.216-20.48 20.48-20.48h471.04c11.264 0 20.48 9.216 20.48 20.48v23.04c0 11.264-9.216 20.48-20.48 20.48z" fill="#323333" p-id="3492"></path></svg>\n    '},wn={template:'\n    <svg t="1557803981028" class="icon" style="" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3603" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32"><path d="M512.512 958.976c-246.784 0-448-201.216-448-448s201.216-448 448-448 448 201.216 448 448-201.216 448-448 448z m0-836.096c-214.016 0-388.096 174.08-388.096 388.096s174.08 388.096 388.096 388.096 388.096-174.08 388.096-388.096-174.08-388.096-388.096-388.096z" fill="#323333" p-id="3604"></path><path d="M710.656 506.368l-267.776-184.32c-13.824-9.216-32.256 0.512-32.256 16.896v368.64c0 16.384 18.432 26.112 32.256 16.896l267.776-184.32c11.776-8.192 11.776-25.6 0-33.792z" fill="#323333" p-id="3605"></path></svg>\n    '},kn={template:'\n    <svg t="1557804020454" class="icon" style="" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3716" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32"><path d="M513.024 962.048c-246.784 0-448-201.216-448-448S266.24 66.048 513.024 66.048s448 201.216 448 448-200.704 448-448 448z m0-836.608c-214.016 0-388.096 174.08-388.096 388.096s174.08 388.096 388.096 388.096 388.096-174.08 388.096-388.096c0.512-214.016-173.568-388.096-388.096-388.096z" fill="#323333" p-id="3717"></path><path d="M641.024 662.528h-256c-11.264 0-20.48-9.216-20.48-20.48v-256c0-11.264 9.216-20.48 20.48-20.48h256c11.264 0 20.48 9.216 20.48 20.48v256c0 11.264-8.704 20.48-20.48 20.48z" fill="#323333" p-id="3718"></path></svg>\n    '},On={template:'\n    <svg t="1557803859830" class="icon" style="" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3378" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32"><path d="M512.512 65.024c-246.784 0-448 201.216-448 448s201.216 448 448 448 448-201.216 448-448-201.216-448-448-448z m-179.2 486.912c-22.528 0-40.96-18.432-40.96-40.96s18.432-40.96 40.96-40.96 40.96 18.432 40.96 40.96-18.432 40.96-40.96 40.96z m179.2 0c-22.528 0-40.96-18.432-40.96-40.96s18.432-40.96 40.96-40.96 40.96 18.432 40.96 40.96-18.432 40.96-40.96 40.96z m179.2 0c-22.528 0-40.96-18.432-40.96-40.96s18.432-40.96 40.96-40.96 40.96 18.432 40.96 40.96-18.432 40.96-40.96 40.96z" fill="#323333" p-id="3379"></path></svg>\n    '},Cn={template:'\n    <svg t="1557803787185" class="icon" style="" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="12033" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32"><path d="M513.536 958.464c-246.784 0-448-201.216-448-448s201.216-448 448-448 448 201.216 448 448-200.704 448-448 448z m0-836.608c-214.016 0-388.096 174.08-388.096 388.096s174.08 388.096 388.096 388.096 388.096-174.08 388.096-388.096c0-213.504-174.08-388.096-388.096-388.096z" fill="#323333" p-id="12034"></path><path d="M751.104 359.936c-12.288-12.288-32.768-12.288-45.056 0l-243.2 243.2-155.136-154.624c-12.288-12.288-32.768-12.288-45.056 0s-12.288 32.768 0 45.056L439.808 670.72c12.288 12.288 32.768 12.288 45.056 0 1.024-1.024 1.536-2.048 2.56-3.072L750.592 404.48c12.8-11.776 12.8-32.256 0.512-44.544z" fill="#323333" p-id="12035"></path></svg>\n    '},Sn={template:'\n    <svg t="1582786163634" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="9140" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><path d="M869.53 230.8l-175.23-0.11a35.93 35.93 0 0 0 0.23-4v-76.17c0-21.28-19.25-38.52-43-38.52H361c-23.75 0-43 17.24-43 38.52v76.13a34 34 0 0 0 0.21 3.79l-162.86-0.11a40.7 40.7 0 0 0 0 81.39h62.94l68.89 543.73a43 43 0 0 0 42.68 37.59l180.89-0.04 180.94 0.07a43 43 0 0 0 42.67-37.59l68.85-543.34 66.26 0.05a40.7 40.7 0 0 0 0-81.4zM404 226v-37h204.53v37a37 37 0 0 0 0.31 4.61l-205.13-0.14A36.74 36.74 0 0 0 404 226z m249.81 581.07L534 807h-46.49l-119.83 0.05-62.75-495.23 411.6 0.28z" p-id="9141"></path><path d="M444.07 731.64a43 43 0 0 0 43-43V398a43 43 0 0 0-86 0v290.64a43 43 0 0 0 43 43zM583.07 731.64a43 43 0 0 0 43-43V398a43 43 0 0 0-86 0v290.64a43 43 0 0 0 43 43z" p-id="9142"></path></svg>\n    '},En={template:'<svg t="1582786532588" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="9271" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><path d="M900.32 235L789.9 122.89a43 43 0 0 0-30.65-12.83H154.19a43 43 0 0 0-43 43v715.49a43 43 0 0 0 43 43h715.49a43 43 0 0 0 43-43V265.18A43 43 0 0 0 900.32 235zM630 196.06V331a10 10 0 0 1-10 10H396.91a10 10 0 0 1-10-10l-0.22-135z m50.66 629.5H338V624.45a10 10 0 0 1 10-10h322.66a10 10 0 0 1 10 10z m146 0h-60V571.45a43 43 0 0 0-43-43H295a43 43 0 0 0-43 43v254.11h-54.82v-629.5h103.51l0.31 188A43 43 0 0 0 344 427h329a43 43 0 0 0 43-43V196.06h25.25l85.43 86.74z" p-id="9272"></path></svg>'},In={template:'<svg t="1582787969789" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="9401" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><path d="M894.75 202.65a43 43 0 0 0-60.33 7.65L451.24 704.64a11 11 0 0 1-16.41 1.1l-242.34-238.3a43 43 0 1 0-60.3 61.32l285.66 280.9a43 43 0 0 0 64.15-4.32L902.39 263a43 43 0 0 0-7.64-60.35z" p-id="9402" fill="#ffffff"></path></svg>'};function xn(e){return xn="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xn(e)}function $n(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,o)}function Tn(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){$n(a,r,o,i,s,"next",e)}function s(e){$n(a,r,o,i,s,"throw",e)}i(void 0)}))}}function Dn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Pn(e,t,n){return t&&jn(e.prototype,t),n&&jn(e,n),e}function Rn(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Nn(e,t)}function Nn(e,t){return Nn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Nn(e,t)}function Ln(e){var t=Un();return function(){var n,r=Fn(e);if(t){var o=Fn(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return An(this,n)}}function An(e,t){return!t||"object"!==xn(t)&&"function"!==typeof t?Mn(e):t}function Mn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Un(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function Fn(e){return Fn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Fn(e)}var Bn=function(){var e=function(e){Rn(n,e);var t=Ln(n);function n(){var e;return Dn(this,n),e=t.apply(this,arguments),e.signaturePad=null,e.imgBase64="",e.setHistorySign=[!1,!1,!1,!1,!1],e.historyManualSignList=[],e.historyManualSignImage="",e.oldkeydownEvent=null,e}return Pn(n,[{key:"close",value:function(e){return!1}},{key:"ok",value:function(e){return e}},{key:"mounted",value:function(){var e=Tn(ce.a.mark((function e(){var t,n=this;return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:console.log("ManualSignPad options",this.options),window.onresize=this.initCanvas,this.initCanvas(),this.loadHistoryManualSignList(),t=document.getElementsByClassName("workflow-approve-sign-modal"),t&&t[0]&&t[0].addEventListener("contextmenu",(function(e){e.preventDefault()})),this.oldkeydownEvent=document.onkeydown||null,document.onkeydown=function(e){var t=window.event||e;return console.log("onkeydown",t),t.ctrlKey&&"s"===t.key?n.save():t.ctrlKey&&"1"===t.key&&n.clear(),!1};case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"destroyed",value:function(){console.log("ManualSignPad destroy"),document.onkeydown=this.oldkeydownEvent}},{key:"updated",value:function(){}},{key:"render",value:function(e){var t=this,n=this.options||{max:!1};return e("aw-modal",{attrs:{centered:!0,title:"签名",visible:!0,footer:[e("aw-button",{key:"back",on:{click:this.close}},["取消"]),e("aw-button",{key:"submit",attrs:{type:"primary"},on:{click:function(){t.save()}}},["确定"])]},class:"'workflow workflow-approve-sign-modal  ".concat(n.max?"sign-maxium":""),on:{cancel:this.close}},[e("div",{attrs:{id:"signature-pad"},class:"workflow-signature-pad"},[e("div",{class:"workflow-signature-pad--actions"},[e("div",{class:"workflow-page-actions"},[this.historyManualSignList.length>0&&e("div",{class:"workflow-history-sign-content"},[e("p",["历史签名："]),this.historyManualSignList.map((function(n,r){return e("div",{class:"workflow-history-sign",on:{click:function(){t.setHistorySign=t.setHistorySign.map((function(e,o){return r===o?(e=!e,t.historyManualSignImage=e?"data:image/png;base64,"+n.signImage:"",e):(e=!1,e)}))}}},[e("img",{attrs:{src:"data:image/png;base64,"+n.signImage,alt:""},style:{width:"100%",height:"100%"}}),e("div",{class:t.setHistorySign[r]?"workflow-sign-choose":""},[e("aw-icon",{attrs:{component:In},class:"workflow-sign-choose-icon"})])])}))]),e("div",{class:"workflow-sign-operation"},[e("span",{class:"workflow-save-sign-content"},[e("aw-icon",{attrs:{title:"设为默认签名",component:En},class:"workflow-save-sign",on:{click:function(){t.imgBase64=t.signaturePad.toDataURL("image/png"),t.saveToCloud(t.imgBase64)}}})]),e("span",{class:"workflow-delete-sign-content"},[e("aw-icon",{attrs:{title:"删除签名",component:Sn},class:"workflow-delete-sign",on:{click:function(){t.historyManualSignImage="",t.clear()}}})])])])]),e("div",{class:"workflow-signature-pad--body"},[e("canvas",{style:{display:this.historyManualSignImage?"none":"block"}}),this.historyManualSignImage&&e("img",{attrs:{src:this.historyManualSignImage},class:"workflow-signature-image"})])])])}},{key:"initCanvas",value:function(){var e=document.querySelector("canvas");if(e){this.signaturePad=new gn["a"](e);var t=Math.max(window.devicePixelRatio||1,1);e.width=e.clientWidth*t,e.height=e.clientHeight*t,e.getContext("2d").scale(t,t),this.signaturePad.clear()}}},{key:"save",value:function(){var e=this;this.imgBase64=this.signaturePad.toDataURL("image/png"),Vt(this.imgBase64,300,(function(t){e.ok(e.historyManualSignImage||t)}))}},{key:"clear",value:function(){this.signaturePad.clear()}},{key:"saveToCloud",value:function(){var e=Tn(ce.a.mark((function e(t){var n=this;return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:Vt(t,300,function(){var e=Tn(ce.a.mark((function e(t){return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,_n({nodeId:n.nodeId,procDefId:n.procDefId,signImage:t.substring(22,t.length)});case 2:n.loadHistoryManualSignList(),W["a"].info("设置成功!");case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"loadHistoryManualSignList",value:function(){var e=Tn(ce.a.mark((function e(){var t;return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,mn({});case 2:t=e.sent,this.historyManualSignList=t.slice(0,5);case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}]),n}(z["d"]);return Object(X["a"])([Object(z["c"])({default:""})],e.prototype,"nodeId",void 0),Object(X["a"])([Object(z["c"])({default:""})],e.prototype,"procDefId",void 0),Object(X["a"])([Object(z["c"])()],e.prototype,"options",void 0),Object(X["a"])([Object(z["b"])("close")],e.prototype,"close",null),Object(X["a"])([Object(z["b"])("ok")],e.prototype,"ok",null),e=Object(X["a"])([z["a"]],e),e}(),Kn=Bn;function Wn(e){return Wn="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wn(e)}function Gn(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,o)}function Vn(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){Gn(a,r,o,i,s,"next",e)}function s(e){Gn(a,r,o,i,s,"throw",e)}i(void 0)}))}}function Xn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Hn(e,t,n){return t&&zn(e.prototype,t),n&&zn(e,n),e}function qn(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Yn(e,t)}function Yn(e,t){return Yn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Yn(e,t)}function Jn(e){var t=er();return function(){var n,r=tr(e);if(t){var o=tr(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Qn(this,n)}}function Qn(e,t){return!t||"object"!==Wn(t)&&"function"!==typeof t?Zn(e):t}function Zn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function er(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function tr(e){return tr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},tr(e)}var nr="approve",rr=function(){var e=function(e){qn(n,e);var t=Jn(n);function n(){var e;return Xn(this,n),e=t.apply(this,arguments),e.maxMessageCount=100,e.checkSignKey=!0,e.steps=[],e.remarks=[],e.approveText="",e.isManualSignPadPopup=!1,e.manualSignImgBase64="",e.manualSignImgData=null,e.signImage=null,e.saveIcon=null,e.deleteIcon=null,e.signObject=null,e}return Hn(n,[{key:"getUserMessageData",value:function(){var e=Vn(ce.a.mark((function e(){var t;return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("approve"!=this.options.approveMode){e.next=9;break}return e.next=3,Ue(this.options.businessKey);case 3:if(t=e.sent,t){e.next=6;break}throw{error:1,message:"获取流程信息失败, 请稍后重试!"};case 6:this.signObject={taskId:this.options.taskId,procInstId:t.procInstId,signImage:this.signImage,manualSignImage:this.manualSignImgData,signType:this.options.signType,signMessage:this.approveText},e.next=10;break;case 9:this.signObject={signImage:this.signImage,manualSignImage:this.manualSignImgData,signType:this.options.signType,signMessage:this.approveText};case 10:return e.abrupt("return",{textMessage:this.approveText,signObject:this.signObject});case 11:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"mounted",value:function(){var e=Vn(ce.a.mark((function e(){var t,n=this;return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:console.log("user-message options=",this.options),this.saveIcon=En,this.deleteIcon=Sn,this.approveText=we.getData("approve.text")||"",this.maxMessageCount=we.getData("general.maxMessageCount")||100,t=we.getData("general.checkSignKey"),this.checkSignKey=void 0===t||t,this.getRemarkList().then((function(e){e&&e.length>0&&(n.approveText=e[0].text||"")}));case 9:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"render",value:function(e){var t=this;return e("div",[e("aw-row",{class:""},[e("aw-col",{attrs:{span:this.options.isSupportManualSign||this.options.isSupportSignetSign?13:24}},[e("span",{class:"title"},["常用批语: "]),e("aw-dropdown",{class:"workflow-remark-button"},[e("aw-menu",{slot:"overlay",class:"workflow-remark"},[this.remarks&&this.remarks.length>0?this.remarks.map((function(n){return e("aw-menu-item",{key:n.id},[e("span",{class:"workflow-remark-text",on:{click:function(e){t.selectRemarkItem(n)}}},[Kt(n.text)]),"private"==n.type&&e("span",{class:"workflow-remark-actions"},[e("aw-icon",{attrs:{title:"星标批语",type:"star",theme:n.flag&&"filled"},on:{click:function(e){t.starRemarkItem(n)}}}),e("aw-icon",{attrs:{title:"删除批语",type:"delete"},on:{click:function(){return t.deleteRemarkItem(n)}}})])])})):e("aw-menu-item",["当前还没有批语"])]),e("aw-button",{class:"remark-select"},["请选择常用批语 ",e("aw-icon",{attrs:{type:"down"}})])]),e("aw-button",{style:"margin-left:8px",attrs:{disabled:!this.approveText},on:{click:function(){var e=Vn(ce.a.mark((function e(){return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,It({appCode:t.options.appCode,comLang:t.approveText,type:nr});case 3:e.next=9;break;case 5:return e.prev=5,e.t0=e["catch"](0),W["a"].error("批语已存在, 不能保存重复批语"),e.abrupt("return");case 9:return e.next=11,Et({appCode:t.options.appCode,text:t.approveText,type:nr});case 11:W["a"].success("批语保存成功"),t.getRemarkList();case 13:case"end":return e.stop()}}),e,null,[[0,5]])})));function n(){return e.apply(this,arguments)}return n}()}},["另存为新批语"]),e("div",{class:"workflow-line-item",attrs:{id:"message-container"}},[e("aw-textarea",{attrs:{id:"approve-message",maxLength:this.maxMessageCount,rows:2,value:this.approveText,placeholder:"请输入批语"},ref:"approveMessage",style:{height:"80px"},on:{change:this.onInputChange}})])]),(this.options.isSupportManualSign||this.options.isSupportSignetSign)&&e("aw-col",{attrs:{span:"11"}},[e("span",{class:"title workflow-approve-sign"},["审批人审核: "]),e("div",{class:"workflow-operation"},[this.options.isSupportManualSign&&e("aw-button",{attrs:{type:"primary"},on:{click:function(){t.isManualSignPadPopup=!0}}},["签名"]),this.options.isSupportSignetSign&&e("aw-button",{style:"margin:0 8px",attrs:{type:"primary"},on:{click:function(){var e=Vn(ce.a.mark((function e(){return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:e.prev=0,en({checkSignKey:t.checkSignKey,signImage:t.options.signImage,elementId:"approve-message",imgWidth:93,imgHeight:78,containerElementId:"workflow-signimg-area"},(function(){t.signImage=t.options.signImage||null})),e.next=8;break;case 4:return e.prev=4,e.t0=e["catch"](0),W["a"].error(e.t0.message),e.abrupt("return");case 8:case"end":return e.stop()}}),e,null,[[0,4]])})));function n(){return e.apply(this,arguments)}return n}()}},[" 签章"]),e("aw-button",{attrs:{type:"default"},on:{click:function(){t.manualSignImgBase64="",en({signImage:"",elementId:"approve-message",imgWidth:93,imgHeight:78,containerElementId:"workflow-signimg-area"})}}},["清空"])]),e("div",{class:"workflow-sign-area",on:{click:function(){t.options.isSupportManualSign&&(t.isManualSignPadPopup=!0)}}},[e("img",{class:"workflow-manual-sign-img",attrs:{src:this.manualSignImgBase64,alt:""}}),e("div",{attrs:{id:"workflow-signimg-area"},class:"workflow-signimg-area",ref:"workflowSignImgArea"})])])]),this.isManualSignPadPopup&&e("w-manual-sign",{attrs:{options:this.options.manualSignOptions,nodeId:this.options.nodeId,procDefId:this.options.procDefId},on:{close:function(){t.isManualSignPadPopup=!1},ok:function(e){t.manualSignImgBase64=e,t.manualSignImgData=e.substring(22,e.length),t.isManualSignPadPopup=!1}}})])}},{key:"getRemarkList",value:function(){var e=Vn(ce.a.mark((function e(){return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Ct({appCode:this.options.appCode,userCode:this.options.userCode,size:10,type:nr});case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0=[];case 5:return this.remarks=e.t0,e.abrupt("return",this.remarks);case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"handleWordChange",value:function(e){console.log("selected",e),this.approveText=e}},{key:"onInputChange",value:function(e){console.log("onInputChange",e),this.approveText=e.target.value}},{key:"starRemarkItem",value:function(){var e=Vn(ce.a.mark((function e(t){return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log("starRemarkItem",t),e.next=3,xt({id:t.id,flag:1==t.flag?0:1});case 3:W["a"].success(1==t.flag?"取消批语星标成功":"添加批语星标成功"),this.getRemarkList();case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"deleteRemarkItem",value:function(){var e=Vn(ce.a.mark((function e(t){var n=this;return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:console.log("deleteRemarkItem",t),b["a"].confirm({title:"确定要删除该批语吗?",okText:"确认",cancelText:"取消",onOk:function(){var e=Vn(ce.a.mark((function e(){return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,St(t.id);case 2:W["a"].success("批语删除成功"),n.getRemarkList();case 4:case"end":return e.stop()}}),e)})));function r(){return e.apply(this,arguments)}return r}(),onCancel:function(){}});case 2:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"selectRemarkItem",value:function(e){console.log("selectRemarkItem",e),this.approveText=e.text}}]),n}(z["d"]);return Object(X["a"])([Object(z["c"])()],e.prototype,"options",void 0),e=Object(X["a"])([Object(z["a"])({components:{"w-manual-sign":Kn}})],e),e}(),or=rr;function ar(e){return ar="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ar(e)}function ir(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function cr(e,t,n){return t&&sr(e.prototype,t),n&&sr(e,n),e}function ur(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&lr(e,t)}function lr(e,t){return lr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},lr(e,t)}function dr(e){var t=hr();return function(){var n,r=yr(e);if(t){var o=yr(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return pr(this,n)}}function pr(e,t){return!t||"object"!==ar(t)&&"function"!==typeof t?fr(e):t}function fr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hr(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function yr(e){return yr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},yr(e)}var mr=function(){var e=function(e){ur(n,e);var t=dr(n);function n(){return ir(this,n),t.apply(this,arguments)}return cr(n,[{key:"render",value:function(e){return e("div",{class:"nodata",style:{height:"".concat(this.height,"px"),lineHeight:"".concat(this.height,"px")}},["没有找到数据"])}}]),n}(z["d"]);return Object(X["a"])([Object(z["c"])({default:100})],e.prototype,"height",void 0),e=Object(X["a"])([z["a"]],e),e}(),_r=mr;function br(e){return br="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},br(e)}function gr(e){return Or(e)||kr(e)||wr(e)||vr()}function vr(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function wr(e,t){if(e){if("string"===typeof e)return Cr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Cr(e,t):void 0}}function kr(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function Or(e){if(Array.isArray(e))return Cr(e)}function Cr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Sr(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,o)}function Er(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){Sr(a,r,o,i,s,"next",e)}function s(e){Sr(a,r,o,i,s,"throw",e)}i(void 0)}))}}function Ir(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function $r(e,t,n){return t&&xr(e.prototype,t),n&&xr(e,n),e}function Tr(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Dr(e,t)}function Dr(e,t){return Dr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Dr(e,t)}function jr(e){var t=Nr();return function(){var n,r=Lr(e);if(t){var o=Lr(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Pr(this,n)}}function Pr(e,t){return!t||"object"!==br(t)&&"function"!==typeof t?Rr(e):t}function Rr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Nr(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function Lr(e){return Lr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Lr(e)}var Ar=10,Mr=[{title:"单位",dataIndex:"unitName",key:"unitName",width:180},{title:"部门",dataIndex:"deptName",key:"deptName",width:130},{title:"姓名",dataIndex:"userName",key:"userName"},{title:"编号",dataIndex:"userCode",key:"userCode"}],Ur=function(){var e=function(e){Tr(n,e);var t=jr(n);function n(){var e;return Ir(this,n),e=t.apply(this,arguments),e.users=[],e.steps=[],e.selectedNodeId="",e.userList=[],e.nodeDataMap=new Map,e.userMap=new Map,e.searchText="",e.userPage=0,e.userPageCount=1,e.userTotal=0,e.defaultType="",e.types=[],e.catalog=[],e.defaultCatalogId="",e.nextIsPreemptMode=!1,e.nextNodeIsMultiple=!1,e.isNextEndNode=!1,e.loadingUserList=!1,e}return $r(n,[{key:"change",value:function(){return console.log("emit change"),{nextNodeId:this.selectedNodeId,isNextPreemptMode:this.nextIsPreemptMode,isNextNodeMultiple:this.nextNodeIsMultiple,isNextEndNode:this.isNextEndNode,users:this.users}}},{key:"mounted",value:function(){var e=Er(ce.a.mark((function e(){var t;return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Ve({procDefId:this.options.procDefId,nodeId:this.options.nodeId,appCode:this.options.appCode,variables:this.options.variables});case 2:if(this.steps=e.sent,!(this.steps&&this.steps.length>0)){e.next=19;break}return t=this.steps[0],this.selectedNodeId=t.nodeId,console.log("next",t),this.nextIsPreemptMode="1"==t.isPreemptMode,this.nextNodeIsMultiple="1"==t.isMultiinstance,this.isNextEndNode="endEvent"===t.nodeType,console.log("selectedNodeId",this.selectedNodeId),this.onNodeStepChange(this.selectedNodeId),e.next=14,ze({procDefId:this.options.procDefId,nodeId:this.selectedNodeId,appCode:this.options.appCode,creatorCode:this.options.creatorCode});case 14:if(e.t0=e.sent,e.t0){e.next=17;break}e.t0=[];case 17:this.types=e.t0,this.types&&this.types.length>0&&(this.defaultType=this.types[0].type,this.handleTypeChange(this.defaultType));case 19:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"render",value:function(e){var t=this;return e("div",{class:"block-user-list"},[e("aw-row",{class:"workflow-line bottom"},[e("span",{class:"title"},["下一步骤:"]),e("aw-radio-group",{attrs:{value:this.selectedNodeId},on:{change:function(e){return t.onNodeStepChange(e.target.value)}}},[this.steps.map((function(t){return e("aw-radio",{attrs:{value:t.nodeId}},[t.nodeName])}))])]),!this.isNextEndNode&&e("aw-row",{class:"workflow-line bottom"},[e("aw-col",{attrs:{span:6},class:"workflow-approve-tree"},[this.types&&this.types.length>0&&e("aw-select",{class:"workflow-approve-tree-search",attrs:{value:this.defaultType},style:{width:120},on:{change:this.handleTypeChange}},[this.types.map((function(t){return e("aw-select-option",{attrs:{value:t.type},key:t.type},[t.name])}))]),e("aw-tree",{class:"workflow-approve-tree-types",attrs:{showLine:!0,selectedKeys:[this.catalogId],defaultExpandAll:!0},on:{select:this.selectTreeNode}},[this.showTreeNode(e,this.catalog)])]),e("aw-col",{attrs:{span:18},class:"workflow-approve-list"},[e("div",{class:"workflow-approve-list-header"},[e("aw-input-search",{attrs:{placeholder:"请输入姓名进行搜索"},on:{search:this.onSearch},style:{width:200}})]),e("div",[e("aw-table",{attrs:{bordered:!0,rowKey:"userCode",locale:{emptyText:e("w-empty",{attrs:{height:144}})},loading:this.loadingUserList,pagination:{current:this.userPage,pageSize:Ar,total:this.userTotal,size:"middle",onChange:function(e){t.userPage=e,console.log("page",e),t.searchUserList(t.defaultType,t.defaultCatalogId,e,t.searchText)}},rowSelection:this.rowSelection,dataSource:gr(this.userList),columns:Mr,scroll:{y:174,x:500}},class:"workflow-approve-list-table"})])])]),!this.isNextEndNode&&e("aw-row",{class:"workflow-approve-select"},[e("aw-col",{attrs:{span:2}},["已选人员: "]),e("aw-col",{attrs:{span:22}},[e("div",{class:"workflow-approve-tags"},[this.users.map((function(n){return e("aw-tag",{attrs:{closable:!0},on:{close:function(){return t.onRemoveUser(n)}}},[n.userName])}))])])])])}},{key:"onNodeStepChange",value:function(){var e=Er(ce.a.mark((function e(t){var n,r=this;return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log("onNodeStepChange",t),this.selectedNodeId=t,n=this.steps.find((function(e){return e.nodeId==r.selectedNodeId})),console.log("next",n),this.nextIsPreemptMode="1"==n.isPreemptMode,this.nextNodeIsMultiple="1"==n.isMultiinstance,this.isNextEndNode="endEvent"===n.nodeType,this.users=[],e.next=10,ze({procDefId:this.options.procDefId,nodeId:t,appCode:this.options.appCode,rgCode:this.options.rgCode,unitCode:this.options.unitCode});case 10:this.types=e.sent,this.types&&this.types.length>0&&(this.defaultType=this.types[0].type,this.handleTypeChange(this.defaultType)),this.change();case 13:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"handleTypeChange",value:function(){var e=Er(ce.a.mark((function e(t){var n,r;return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log("handleTypeChange",t),this.defaultType=t,n=this.options.variables,console.log("this.options",this.options),console.log("variables",n),e.next=7,He({procDefId:this.options.procDefId,nodeId:this.selectedNodeId,appCode:this.options.appCode,rgCode:this.options.rgCode,unitCode:this.options.unitCode,type:t,businessKey:this.options.businessKey,creatorCode:this.options.creatorCode,variables:n});case 7:r=e.sent,this.catalog=this.buildTreeNode(r),this.catalog&&this.catalog.length>0&&(this.defaultCatalogId=this.catalog[0].id,this.searchUserList(this.defaultType,this.defaultCatalogId,1,""));case 10:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"onSearch",value:function(e){console.log("search",e),this.searchText=e,this.searchUserList(this.defaultType,this.defaultCatalogId,1,e)}},{key:"selectTreeNode",value:function(){var e=Er(ce.a.mark((function e(t){return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:console.log("selectTreeNode",t),t&&t.length>0&&(this.defaultCatalogId=t[0]),this.searchText="",this.searchUserList(this.defaultType,this.defaultCatalogId,1,"");case 4:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"searchUserList",value:function(){var e=Er(ce.a.mark((function e(t,n,r,o){var a,i;return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a={type:this.defaultType,id:n,name:o,pageNum:r,pageSize:10,appCode:this.options.appCode||"",rgCode:this.options.rgCode||"",unitCode:this.options.unitCode||"",procDefId:this.options.procDefId,nodeId:this.selectedNodeId},e.prev=1,this.loadingUserList=!0,e.next=5,qe(a);case 5:i=e.sent,i&&(this.userList=i.rows||[],this.userTotal=i.records,this.userPage=i.page);case 7:return e.prev=7,this.loadingUserList=!1,e.finish(7);case 10:case"end":return e.stop()}}),e,this,[[1,,7,10]])})));function t(t,n,r,o){return e.apply(this,arguments)}return t}()},{key:"buildTreeNode",value:function(e){var t={},n=[];for(var r in e)t[e[r].id]=e[r];for(var o in t)t[o].pId?(t[t[o].pId].children||(t[t[o].pId].children=[]),t[t[o].pId].children.push(t[o])):n.push(t[o]);return n}},{key:"showTreeNode",value:function(e,t){var n=this;return t.map((function(t){return t.children&&t.children.length>0?e("aw-tree-node",{key:t.id,attrs:{title:t.name}},[n.showTreeNode(e,t.children)]):e("aw-tree-node",{key:t.id,attrs:{title:t.name},on:{click:function(){return n.selectTreeNode(t)}}})}))}},{key:"onRemoveUser",value:function(e){console.log("onRemoveUser",e);var t=this.users.findIndex((function(t){return t.userCode===e.userCode}));t>-1&&this.users.splice(t,1)}},{key:"catalogId",get:function(){return this.defaultCatalogId}},{key:"rowSelection",get:function(){var e=this;return{type:this.nextIsPreemptMode||this.nextNodeIsMultiple?"checkbox":"radio",onChange:function(t,n){var r=(e.userList||[]).map((function(e){return e.userCode})).filter((function(e){return!t.includes(e)}));console.log("pages",r);var o=e.users.filter((function(e){return-1==r.indexOf(e.userCode)}));n.forEach((function(t){-1==o.findIndex((function(e){return e.userCode===t.userCode}))&&o.push(t),e.userMap.has(t.userCode)||e.userMap.set(t.userCode,t)})),e.users=o,e.change()},selectedRowKeys:this.users.map((function(e){return e.userCode}))}}}]),n}(z["d"]);return Object(X["a"])([Object(z["c"])()],e.prototype,"options",void 0),Object(X["a"])([Object(z["b"])("change")],e.prototype,"change",null),e=Object(X["a"])([Object(z["a"])({components:{"w-empty":_r}})],e),e}(),Fr=Ur;function Br(e){return Br="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Br(e)}function Kr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Wr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Gr(e,t,n){return t&&Wr(e.prototype,t),n&&Wr(e,n),e}function Vr(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Xr(e,t)}function Xr(e,t){return Xr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Xr(e,t)}function zr(e){var t=Yr();return function(){var n,r=Jr(e);if(t){var o=Jr(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Hr(this,n)}}function Hr(e,t){return!t||"object"!==Br(t)&&"function"!==typeof t?qr(e):t}function qr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Yr(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function Jr(e){return Jr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Jr(e)}var Qr=function(){var e=function(e){Vr(n,e);var t=zr(n);function n(){var e;return Kr(this,n),e=t.apply(this,arguments),e.elementsColumns=[{title:"",dataIndex:"isRequired",width:40,customRender:function(t,n,r){return e.renderElementAction(n)}},{title:"要点名称",dataIndex:"elementName",key:"elementName",customRender:function(t,n,r){return e.renderElementName(n)}}],e}return Gr(n,[{key:"render",value:function(e){return e("aw-table",{attrs:{columns:this.elementsColumns,bordered:!0,rowKey:"id",size:"middle",locale:this.locale,pagination:!1,dataSource:this.options.elements||[],scroll:{y:240,x:500}},class:"workflow-approve-list-table workflow-elements "})}},{key:"renderElementAction",value:function(e){var t=this.$createElement;return t("aw-checkbox",{on:{change:function(t){e.selected=t.target.checked}}})}},{key:"renderElementName",value:function(e){var t=this.$createElement,n=e.elementName;return"1"===e.isRequired&&(n=t("span",[t("span",{style:"color: red;margin-right:5px"},["*"]),n])),n}},{key:"locale",get:function(){return{emptyText:"当前没有数据"}}}]),n}(z["d"]);return Object(X["a"])([Object(z["c"])()],e.prototype,"options",void 0),e=Object(X["a"])([z["a"]],e),e}(),Zr=Qr;function eo(e){return eo="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},eo(e)}function to(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function no(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?to(Object(n),!0).forEach((function(t){ro(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):to(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ro(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function oo(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,o)}function ao(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){oo(a,r,o,i,s,"next",e)}function s(e){oo(a,r,o,i,s,"throw",e)}i(void 0)}))}}function io(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function so(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function co(e,t,n){return t&&so(e.prototype,t),n&&so(e,n),e}function uo(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&lo(e,t)}function lo(e,t){return lo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},lo(e,t)}function po(e){var t=yo();return function(){var n,r=mo(e);if(t){var o=mo(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return fo(this,n)}}function fo(e,t){return!t||"object"!==eo(t)&&"function"!==typeof t?ho(e):t}function ho(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yo(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function mo(e){return mo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},mo(e)}var _o=function(){var e=function(e){uo(n,e);var t=po(n);function n(){var e;return io(this,n),e=t.apply(this,arguments),e.isReady=!1,e.isCheckUsers=!1,e.elements=[],e.node={},e.saveBusying=!1,e.signObject=null,e.textMessage="",e.activeTabKey="message",e}return co(n,[{key:"onVisibleChanged",value:function(e,t){e&&this.reinit(this.options)}},{key:"onOptionsChanged",value:function(e,t){this.visible&&e&&this.reinit(e)}},{key:"onSelected",value:function(){var e=ao(ce.a.mark((function e(t){var n,r,o,a,i,s,c,u,l,d,p,f;return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n={error:0,message:""},this.saveBusying=!0,r=[],this.nextUserNode&&this.nextUserNode.users.length>0&&(r=this.nextUserNode.users.map((function(e){return{assignee:e.userCode,assigneeName:e.userName,assigneeType:"user"}}))),e.prev=4,o=this.options,o.approveFirstNode=o.approveFirstNode||!0,a=this.checkApproveElements(),i=this.node&&"1"!==this.node.isFirstUserTaskNode||this.node&&"1"===this.node.sign||!0===this.options.isTextMessage,s=this.$refs.userMessage,!s){e.next=17;break}return e.next=13,s.getUserMessageData();case 13:c=e.sent,this.textMessage=c.textMessage,this.signObject=c.signObject,console.log("userMessage",c,this.signObject);case 17:if(!(i&&"1"===this.node.sign&&o.signType&&o.signRequired)||this.signObject&&this.signObject.signImage){e.next=19;break}throw{error:1,message:"请签章后再审批"};case 19:return u="",l="",o.bizExtra&&(u=o.bizExtra.bizTitle||"",l=o.bizExtra.bizUrl||""),d={appCode:we.appCode,bizTypeCode:o.bizTypeCode,businessKey:o.businessKey,rgCode:o.rgCode,unitCode:o.unitCode,userCode:o.userCode,creatorCode:this.node.creatorCode,variables:this.variables,bizTitle:u,bizUrl:l},e.next=25,Fe(d);case 25:if(p=e.sent,i&&("1"===this.node.sign&&this.signObject?(this.signObject.procInstId=p.id,this.signObject.taskId=p.taskId):this.signObject={procInstId:p.id,taskId:p.taskId,signMessage:this.textMessage,manualSignImage:this.signObject&&this.signObject.manualSignImage||null,signImage:this.signObject&&this.signObject.signImage||null}),!this.isCheckUsers){e.next=43;break}if(f={nextNodeId:this.nextUserNode?this.nextUserNode.nextNodeId:"",nextUsers:r,isNextPreemptMode:!!this.nextUserNode&&this.nextUserNode.isNextPreemptMode,isNextNodeMultiple:!!this.nextUserNode&&this.nextUserNode.isNextNodeMultiple,message:this.textMessage},!f.isNextPreemptMode){e.next=34;break}return e.next=32,ot(p.taskId,{action:"complete",nextNodeId:f.nextNodeId,users:f.nextUsers||[],message:f.message,variables:this.variables,signObject:this.signObject,elements:a,deptCode:o.deptCode,bizTitle:u,bizUrl:l});case 32:e.next=41;break;case 34:if(!f.isNextNodeMultiple){e.next=39;break}return e.next=37,ot(p.taskId,{action:"complete",assignee:"",nextNodeId:f.nextNodeId,assignments:f.nextUsers||[],message:f.message,variables:this.variables,signObject:this.signObject,elements:a,deptCode:o.deptCode,bizTitle:u,bizUrl:l});case 37:e.next=41;break;case 39:return e.next=41,ot(p.taskId,{action:"complete",nextNodeId:f.nextNodeId,assignment:f.nextUsers?f.nextUsers[0]:null,message:f.message,variables:this.variables,signObject:this.signObject,elements:a,deptCode:o.deptCode,bizTitle:u,bizUrl:l});case 41:e.next=45;break;case 43:return e.next=45,ot(p.taskId,{action:"complete",message:this.textMessage,variables:this.variables,deptCode:o.deptCode,signObject:this.signObject,elements:a,bizTitle:u,bizUrl:l});case 45:n.extra={procInstId:p.id,businessKey:o.businessKey||"",procDefId:p.processDefinitionId,nodeId:p.nodeId,taskId:p.taskId},e.next=51;break;case 48:e.prev=48,e.t0=e["catch"](4),n=Gt(e.t0);case 51:return e.prev=51,this.saveBusying=!1,e.finish(51);case 54:return e.abrupt("return",n);case 55:case"end":return e.stop()}}),e,this,[[4,48,51,54]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"onOk",value:function(){var e=ao(ce.a.mark((function e(t){var n,r,o,a,i,s,c,u,l,d,p,f,h;return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n={error:0,message:""},e.prev=1,r=this.checkApproveElements(),o=this.options.taskId?this.options.taskId:this.options.businessKey,a=this.options.deptCode||"",i={},this.options.taskId||(i={menuId:this.options.menuId||""}),o){e.next=10;break}throw we.debug&&G["a"].error({message:"错误",description:"taskId|businessKey not found"}),{error:1,message:"taskId|businessKey not found"};case 10:if(s=this.node&&"1"!==this.node.isFirstUserTaskNode||this.node&&"1"===this.node.sign||!0===this.options.isTextMessage,c=this.$refs.userMessage,!c){e.next=19;break}return e.next=15,c.getUserMessageData();case 15:u=e.sent,this.textMessage=u.textMessage,this.signObject=u.signObject,console.log("userMessage",u,this.signObject);case 19:if(!s||"1"!==this.node.sign||!this.options.signRequired||this.signObject&&this.signObject.signImage){e.next=21;break}throw{error:1,message:"请签章后再审批"};case 21:if(l=this.options.taskId?ot:at,d=this.variables.map((function(e){return no(no({},e),{},{name:e.name.replace("$_","fvar_")})})),this.saveBusying=!0,p="",f="",this.options.bizExtra&&(p=this.options.bizExtra.bizTitle||"",f=this.options.bizExtra.bizUrl||""),!this.isCheckUsers||!this.nextUserNode){e.next=44;break}if(h=[],this.nextUserNode.users.length>0&&(h=this.nextUserNode.users.map((function(e){return{assignee:e.userCode,assigneeName:e.userName,assigneeType:"user"}}))),!this.nextUserNode.isNextPreemptMode){e.next=35;break}return e.next=33,l(o,no({action:"complete",nextNodeId:this.nextUserNode.nextNodeId,users:h,message:this.textMessage,variables:d,signObject:this.signObject,elements:r,deptCode:a,bizTitle:p,bizUrl:f},i));case 33:e.next=42;break;case 35:if(!this.nextUserNode.isNextNodeMultiple){e.next=40;break}return e.next=38,l(o,no({action:"complete",assignee:"",nextNodeId:this.nextUserNode.nextNodeId,assignments:h||[],message:this.textMessage,variables:d,signObject:this.signObject,elements:r,deptCode:a,bizTitle:p,bizUrl:f},i));case 38:e.next=42;break;case 40:return e.next=42,l(o,no({action:"complete",nextNodeId:this.nextUserNode.nextNodeId,assignment:h?h[0]:null,message:this.textMessage,variables:d,signObject:this.signObject,elements:r,deptCode:a,bizTitle:p,bizUrl:f},i));case 42:e.next=46;break;case 44:return e.next=46,l(o,no({action:"complete",message:this.textMessage,variables:d,deptCode:a,signObject:this.signObject,elements:r,bizTitle:p,bizUrl:f},i));case 46:e.next=51;break;case 48:e.prev=48,e.t0=e["catch"](1),n=Gt(e.t0);case 51:return e.prev=51,this.saveBusying=!1,e.finish(51);case 54:return e.abrupt("return",n);case 55:case"end":return e.stop()}}),e,this,[[1,48,51,54]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"onCancel",value:function(e){return!1}},{key:"checkApproveElements",value:function(){var e=[];return this.elements&&this.elements.length>0&&(console.log("elements",this.elements),this.elements.forEach((function(t){if(!t.selected&&"1"===t.isRequired)throw{error:1,message:'"'.concat(t.elementName.length>10?t.elementName.substr(0,10)+"...":t.elementName,'"为必选要点')};e.push({id:t.id,name:t.elementName,selected:t.selected?"1":"0"})}))),e}},{key:"changeTabState",value:function(){var e=ao(ce.a.mark((function e(t){return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.activeTabKey=t;case 1:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"mounted",value:function(){var e=ao(ce.a.mark((function e(){return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.visible&&this.reinit(this.options);case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"destroyed",value:function(){}},{key:"reinit",value:function(){var e=ao(ce.a.mark((function e(t){return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.isReady=!1,this.options=t,console.log("options",this.options),jt("workflow-approve",["businessKey","taskId","procDefId","nodeId"],["businessKey","menuId"],["businessKey","procDefId","nodeId"],t)){e.next=6;break}return t.onComplete&&t.onComplete({error:1,message:"无效的options参数"}),e.abrupt("return");case 6:if(this.options.mode=t.mode||"approve",this.options.deptCode=t.deptCode||"",this.options.creatorCode=t.creatorCode||"","approve"!=t.mode){e.next=20;break}return e.next=12,Ft(t);case 12:if(this.config=e.sent,this.config){e.next=17;break}return Pt("查询工作流信息失败"),t.onComplete&&t.onComplete({error:1,message:"查询工作流信息失败"}),e.abrupt("return");case 17:console.log("node",this.node),e.next=21;break;case 20:this.config={procDefId:t.procDefId,nodeId:t.nodeId,businessKey:t.businessKey};case 21:return console.log("config",t,this.config),e.next=24,We({procDefId:this.config.procDefId,nodeId:this.config.nodeId});case 24:this.node=e.sent,this.isCheckUsers=this.node&&"1"===this.node.isCheckUsers,this.node&&this.node.elements&&(this.elements=this.node.elements,this.elements&&this.elements.length>0&&(this.activeTabKey="elements")),"1"==this.node.sign&&this.options.signType&&Qt(this.options.signType||""),this.isReady=!0;case 29:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"render",value:function(e){var t=this;return e("aw-modal",{attrs:{centered:!0,title:this.options.title||"审批",visible:this.visible,maskClosable:!1,footer:[e("aw-button",{key:"back",on:{click:this.onCancel}},["取消"]),e("aw-button",{key:"submit",attrs:{loading:this.saveBusying,type:"primary"},on:{click:function(e){t.isCheckUsers&&t.nextUserNode&&!t.nextUserNode.isNextEndNode&&0==t.nextUserNode.users.length?W["a"].error("请选择下一步骤人员"):"select"==t.options.mode?t.onSelected(e):t.onOk(e)}}},["确定"])]},class:"workflow workflow-approve",on:{cancel:this.onCancel}},[this.isReady&&this.isCheckUsers&&e("w-user-selection",{attrs:{options:{nodeId:this.config.nodeId,procDefId:this.config.procDefId,taskId:this.config.taskId,appCode:this.node&&this.node.appCode,rgCode:this.node&&this.node.rgCode,unitCode:this.node&&this.node.unitCode,businessKey:this.config.businessKey,creatorCode:this.options.creatorCode,variables:this.variables.map((function(e){return no(no({},e),{},{name:e.name.replace("$_","fvar_")})}))}},on:{change:this.onUserSelected}}),(this.elements&&this.elements.length>0||this.node&&"1"!==this.node.isFirstUserTaskNode||this.node&&"1"===this.node.sign||!0===this.options.isTextMessage)&&e("aw-row",{class:"workflow-line workflow-tabs ".concat((!this.elements||0==this.elements.length)&&"signle")},[e("aw-tabs",{attrs:{activeKey:this.activeTabKey},on:{change:this.changeTabState}},[this.elements&&this.elements.length>0&&e("aw-tab-panel",{attrs:{tab:"审批要点"},key:"elements"},[e("w-elements-list",{attrs:{options:{elements:this.elements}}})]),1==this.isReady&&(this.node&&"1"!==this.node.isFirstUserTaskNode||this.node&&"1"===this.node.sign||!0===this.options.isTextMessage)&&e("aw-tab-panel",{attrs:{tab:"审批意见"},key:"message"},[e("w-user-message",{ref:"userMessage",attrs:{options:{isCheckUsers:this.isCheckUsers,nodeId:this.config.nodeId,procDefId:this.config.procDefId,appCode:this.node.appCode,userCode:we.userCode,businessKey:this.config.businessKey,approveMode:this.options.mode,taskId:this.config.taskId,defaultMessageText:"",isSupportManualSign:this.options.isSupportManualSign,manualSignOptions:this.options.manualSignOptions,isSupportSignetSign:"1"===this.node.sign,signImage:this.options.signImage,signType:this.options.signType,variables:this.variables.map((function(e){return no(no({},e),{},{name:e.name.replace("$_","fvar_")})}))}}})])])])])}},{key:"onUserSelected",value:function(e){console.log("onUserSelected",e),this.nextUserNode=e}}]),n}(z["d"]);return Object(X["a"])([Object(z["c"])({default:""})],e.prototype,"title",void 0),Object(X["a"])([Object(z["c"])({default:function(){return[]}})],e.prototype,"variables",void 0),Object(X["a"])([Object(z["c"])({default:!1})],e.prototype,"visible",void 0),Object(X["a"])([Object(z["c"])()],e.prototype,"options",void 0),Object(X["a"])([Object(z["e"])("visible")],e.prototype,"onVisibleChanged",null),Object(X["a"])([Object(z["e"])("options")],e.prototype,"onOptionsChanged",null),Object(X["a"])([Object(z["b"])("selected")],e.prototype,"onSelected",null),Object(X["a"])([Object(z["b"])("complete")],e.prototype,"onOk",null),Object(X["a"])([Object(z["b"])("cancel")],e.prototype,"onCancel",null),e=Object(X["a"])([Object(z["a"])({components:{"w-user-selection":Fr,"w-elements-list":Zr,"w-user-message":or}})],e),e}(),bo=_o,go=n("fee2");function vo(e){return vo="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vo(e)}function wo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ko(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?wo(Object(n),!0).forEach((function(t){Oo(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):wo(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Oo(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Co(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,o)}function So(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){Co(a,r,o,i,s,"next",e)}function s(e){Co(a,r,o,i,s,"throw",e)}i(void 0)}))}}function Eo(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Io(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function xo(e,t,n){return t&&Io(e.prototype,t),n&&Io(e,n),e}function $o(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&To(e,t)}function To(e,t){return To=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},To(e,t)}function Do(e){var t=Ro();return function(){var n,r=No(e);if(t){var o=No(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return jo(this,n)}}function jo(e,t){return!t||"object"!==vo(t)&&"function"!==typeof t?Po(e):t}function Po(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ro(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function No(e){return No=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},No(e)}var Lo,Ao="back";(function(e){e[e["Prev"]=go["FbpmStatus"].ACTION_BACK_PREV]="Prev",e[e["First"]=go["FbpmStatus"].ACTION_BACK_FIRST]="First",e[e["Any"]=go["FbpmStatus"].ACTION_BACK_ANY]="Any"})(Lo||(Lo={}));var Mo=function(){var e=function(e){$o(n,e);var t=Do(n);function n(){var e;return Eo(this,n),e=t.apply(this,arguments),e.remarks=[],e.text="",e.nodeType=Lo.First,e.selectedNodeId="",e.nodes=[],e.buttonBusying=!1,e.loadingNodeList=!1,e}return xo(n,[{key:"onVisibleChanged",value:function(e,t){e&&this.reload()}},{key:"onOptionsChanged",value:function(e,t){this.visible&&e&&this.reload()}},{key:"onOk",value:function(){var e=So(ce.a.mark((function e(t){var n,r,o,a,i,s,c;return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n={error:0,message:""},e.prev=1,this.buttonBusying=!0,r="",this.options.procInstId){e.next=6;break}throw{error:1,message:"options找不到procInstId"};case 6:if(this.options.taskId){e.next=8;break}throw{error:1,message:"options找不到taskId"};case 8:if(o=this.nodeType,this.nodeType!=Lo.Prev&&this.nodeType!=Lo.First&&(this.nodeType!==Lo.Any||"0"!==this.node.isReject)){e.next=16;break}return e.next=12,it({backType:o,procDefId:this.options.procDefId,procInstId:this.options.procInstId,nodeId:this.options.nodeId});case 12:a=e.sent,r=a.nodeId,e.next=17;break;case 16:r=this.backNode.nodeId;case 17:return console.log("getBackNodeInfo",r),i="",s="",this.options.bizExtra&&(i=this.options.bizExtra.bizTitle||"",s=this.options.bizExtra.bizUrl||""),c=(this.options.variables||[]).map((function(e){return ko(ko({},e),{},{name:e.name.replace("$_","fvar_")})})),e.next=24,lt(this.options.taskId,{variables:c,bizUrl:s,bizTitle:i,backType:o,currentActivityIds:[this.node.nodeId],targetActivityIds:[r],message:this.text});case 24:e.next=29;break;case 26:e.prev=26,e.t0=e["catch"](1),n=Gt(e.t0);case 29:return e.prev=29,this.buttonBusying=!1,e.finish(29);case 32:return e.abrupt("return",n);case 33:case"end":return e.stop()}}),e,this,[[1,26,29,32]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"onCancel",value:function(e){return!1}},{key:"mounted",value:function(){var e=So(ce.a.mark((function e(){return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.visible&&this.reload();case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"reload",value:function(){var e=So(ce.a.mark((function e(){var t=this;return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(Tt("workflow-back",["procInstId","procDefId","nodeId","taskId"],this.options)){e.next=3;break}return this.options.onComplete&&this.options.onComplete({error:1,message:"无效的options参数"}),e.abrupt("return");case 3:return e.next=5,We({procDefId:this.options.procDefId,nodeId:this.options.nodeId});case 5:this.node=e.sent,console.log("node",this.node),"0"===this.node.isReject&&(this.nodeType=this.node.backType),this.text=we.getData("back.text")||"",this.getRemarkList().then((function(e){e&&e.length>0&&(t.text=e[0].text||"")}));case 10:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"onNodeTypeChanged",value:function(){var e=So(ce.a.mark((function e(t){var n;return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(console.log("onNodeTypeChanged",t.target.value),this.nodeType=t.target.value,this.nodeType!=Lo.Any){e.next=15;break}return e.prev=3,this.loadingNodeList=!0,e.next=7,st({procInstId:this.options.procInstId,nodeId:this.options.nodeId});case 7:n=e.sent,this.nodes=n||[],n&&n.length>0&&(this.backNode=n[0],this.selectedNodeId=n[0].nodeId);case 10:return e.prev=10,this.loadingNodeList=!1,e.finish(10);case 13:e.next=16;break;case 15:this.nodes=[];case 16:case"end":return e.stop()}}),e,this,[[3,,10,13]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"selectNode",value:function(e){console.log("selectNode",e),this.selectedNodeId=e.nodeId,this.backNode=e}},{key:"onInputChange",value:function(e){console.log("onInputChange",e),this.text=e.target.value}},{key:"starRemarkItem",value:function(){var e=So(ce.a.mark((function e(t){return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log("starRemarkItem",t),e.next=3,xt({id:t.id,flag:1==t.flag?0:1});case 3:W["a"].success(1==t.flag?"取消批语星标成功":"添加批语星标成功"),this.getRemarkList();case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"deleteRemarkItem",value:function(){var e=So(ce.a.mark((function e(t){var n=this;return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:console.log("deleteRemarkItem",t),b["a"].confirm({title:"确定要删除该批语吗?",okText:"确认",cancelText:"取消",onOk:function(){var e=So(ce.a.mark((function e(){return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,St(t.id);case 2:W["a"].success("批语删除成功"),n.getRemarkList();case 4:case"end":return e.stop()}}),e)})));function r(){return e.apply(this,arguments)}return r}(),onCancel:function(){}});case 2:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"selectRemarkItem",value:function(e){console.log("selectRemarkItem",e),this.text=e.text}},{key:"render",value:function(e){var t=this;return e("aw-modal",{attrs:{centered:!0,title:this.options.title||"驳回",visible:this.visible,footer:[e("aw-button",{key:"back",on:{click:this.onCancel}},["取消"]),e("aw-button",{key:"submit",attrs:{loading:this.buttonBusying,type:"primary"},on:{click:this.onOk}},["确定"])]},class:"workflow workflow-revoke",on:{cancel:this.onCancel,ok:function(e){return t.onOk(e)}}},[this.node&&"1"==this.node.isReject&&e("div",[e("aw-row",{class:"workflow-line bottom-space"},[e("span",{class:"title"},["选择岗位"]),e("span",[e("aw-radio-group",{on:{change:this.onNodeTypeChanged},attrs:{value:this.nodeType}},[e("aw-radio",{attrs:{value:Lo.First}},["第一岗"]),e("aw-radio",{attrs:{value:Lo.Prev}},["上一岗"]),e("aw-radio",{attrs:{value:Lo.Any}},["任一岗"])])])]),this.nodeType===Lo.Any&&e("aw-row",[e("aw-col",[e("aw-list",{class:"workflow-revoke-list",attrs:{bordered:!0,loading:this.loadingNodeList,locale:{emptyText:e("aw-empty",{attrs:{height:100}})},dataSource:this.nodes,renderItem:function(n){return e("aw-list-item",{class:"workflow-revoke-item ".concat(n.nodeId==t.selectedNodeId?"active":""),on:{click:function(){return t.selectNode(n)}}},[n.nodeName])}}})])])]),e("aw-row",{class:"workflow-line"},[e("aw-col",{attrs:{span:3},class:"title"},["常用批语: "]),e("aw-col",{attrs:{span:21}},[e("aw-dropdown",{class:"workflow-remark-button"},[e("aw-menu",{slot:"overlay",class:"workflow-remark"},[this.remarks&&this.remarks.length>0?this.remarks.map((function(n){return e("aw-menu-item",{key:n.id},[e("span",{class:"workflow-remark-text",on:{click:function(e){t.selectRemarkItem(n)}}},[Kt(n.text)]),"private"==n.type&&e("span",{class:"workflow-remark-actions"},[e("aw-icon",{on:{click:function(e){t.starRemarkItem(n)}},attrs:{type:"star",theme:n.flag&&"filled"}}),e("aw-icon",{on:{click:function(){return t.deleteRemarkItem(n)}},attrs:{type:"delete"}})])])})):e("aw-menu-item",["当前还没有批语"])]),e("aw-button",{style:"margin-left: 8px"},["请选择常用批语 ",e("aw-icon",{attrs:{type:"down"}})])])])]),e("aw-row",{class:"workflow-line"},[e("aw-col",[e("aw-textarea",{attrs:{rows:2,maxLength:50,value:this.text,placeholder:"请输入批语"},on:{change:this.onInputChange}})])]),e("aw-row",{class:"workflow-line"},[e("aw-col",[e("aw-button",{attrs:{type:"primary",ghost:!0,disabled:!this.text},on:{click:function(){var e=So(ce.a.mark((function e(){return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,It({appCode:t.node.appCode,comLang:t.text,type:Ao});case 3:e.next=9;break;case 5:return e.prev=5,e.t0=e["catch"](0),W["a"].error("批语已存在, 不能保存重复批语"),e.abrupt("return");case 9:return e.next=11,Et({appCode:t.node.appCode,text:t.text,type:Ao});case 11:W["a"].success("批语保存成功"),t.getRemarkList();case 13:case"end":return e.stop()}}),e,null,[[0,5]])})));function n(){return e.apply(this,arguments)}return n}()}},["另存为新批语"])])])])}},{key:"getRemarkList",value:function(){var e=So(ce.a.mark((function e(){return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Ct({appCode:we.appCode,size:10,type:Ao});case 2:return this.remarks=e.sent,e.abrupt("return",this.remarks);case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}]),n}(z["d"]);return Object(X["a"])([Object(z["c"])({default:!1})],e.prototype,"visible",void 0),Object(X["a"])([Object(z["c"])()],e.prototype,"options",void 0),Object(X["a"])([Object(z["e"])("visible")],e.prototype,"onVisibleChanged",null),Object(X["a"])([Object(z["e"])("options")],e.prototype,"onOptionsChanged",null),Object(X["a"])([Object(z["b"])("complete")],e.prototype,"onOk",null),Object(X["a"])([Object(z["b"])("cancel")],e.prototype,"onCancel",null),e=Object(X["a"])([Object(z["a"])({components:{"aw-empty":_r}})],e),e}(),Uo=Mo;function Fo(e){return Fo="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fo(e)}function Bo(e){return Go(e)||Wo(e)||Xo(e)||Ko()}function Ko(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Wo(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function Go(e){if(Array.isArray(e))return zo(e)}function Vo(e,t){var n;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=Xo(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw a}}}}function Xo(e,t){if(e){if("string"===typeof e)return zo(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?zo(e,t):void 0}}function zo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ho(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,o)}function qo(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){Ho(a,r,o,i,s,"next",e)}function s(e){Ho(a,r,o,i,s,"throw",e)}i(void 0)}))}}function Yo(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Jo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Qo(e,t,n){return t&&Jo(e.prototype,t),n&&Jo(e,n),e}function Zo(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ea(e,t)}function ea(e,t){return ea=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ea(e,t)}function ta(e){var t=oa();return function(){var n,r=aa(e);if(t){var o=aa(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return na(this,n)}}function na(e,t){return!t||"object"!==Fo(t)&&"function"!==typeof t?ra(e):t}function ra(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function oa(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function aa(e){return aa=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},aa(e)}var ia=5,sa=(go["TaskState"].Approved,go["TaskState"].Process,go["TaskState"].Process,go["TaskState"].Process,go["TaskState"].Approved,go["TaskState"].Back,go["TaskState"].Approved,go["TaskState"].Cancel,go["TaskState"].NotStart,go["TaskState"].Approved,go["TaskState"].Approved,go["TaskState"].Approved,function(){var e=function(e){Zo(n,e);var t=ta(n);function n(){var e;return Yo(this,n),e=t.apply(this,arguments),e.steps=[],e.userIds=[],e.users=new Map,e}return Qo(n,[{key:"reload",value:function(){var e=qo(ce.a.mark((function e(){var t,n,r;return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(Dt("workflow-trace-simple",["procInstId"],["businessKey"],this.options)){e.next=3;break}return this.options.onComplete&&this.options.onComplete({error:1,message:"无效的options参数"}),e.abrupt("return");case 3:return e.next=5,Ft(this.options);case 5:if(this.config=e.sent,this.config){e.next=10;break}return Pt("查询工作流信息失败"),this.options.onComplete&&this.options.onComplete({error:1,message:"查询工作流信息失败"}),e.abrupt("return",!0);case 10:return e.next=12,Ye({procInstId:this.config.procInstId});case 12:if(t=e.sent,console.log("flowdata",t),!t){e.next=21;break}return this.steps=this.getSteps(t||[]),e.next=18,this.loadUserNames();case 18:n=e.sent,r=n.users,this.users=r;case 21:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"mounted",value:function(){var e=qo(ce.a.mark((function e(){return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.reload();case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"renderStep",value:function(e,t){if(!t.tasks)return e("div");var n=t.tasks.filter((function(e){return!e.roleId&&!e.user})),r=n.length;t.more||(n=n.slice(0,ia));var o=n.map((function(n){return e("div",{class:"workflow-task"},[e("aw-icon",{attrs:{type:"user"},class:1==t.status?"workflow-step-finished":"workflow-step-processing"}),e("span",{class:"username",attrs:{title:n.userName||""}},[n.userName||""])," ",e("span",[n.message])])}));return e("div",[e("div",[o]),r>ia&&e("div",{class:"more",on:{click:function(){t.more=!t.more}}},[" ",t.more?e("aw-icon",{attrs:{type:"up"}}):e("aw-icon",{attrs:{type:"down"}})])])}},{key:"renderState",value:function(e){return 1==e?"finish":2==e?"process":"wait"}},{key:"renderStepIcon",value:function(e,t){return e("aw-icon",1==t?{attrs:{type:"check-circle"},class:"workflow-step-finished"}:{attrs:{type:"loading"},class:"workflow-step-processing"})}},{key:"render",value:function(e){var t=this;return e("div",{class:"workflow-trace-simple ".concat(this.direction," ").concat(this.size)},[e("aw-steps",{attrs:{direction:this.direction,size:"small",labelPlacement:"horizontal"},class:"workflow-steps"},[this.steps.map((function(n){return e("aw-step",{class:"workflow-step",attrs:{icon:t.renderStepIcon(e,n.status),status:t.renderState(n.status),title:n.nodeName,description:t.renderStep(e,n)}})}))])])}},{key:"getSteps",value:function(e){var t,n=e,r=Vo(n);try{for(r.s();!(t=r.n()).done;){var o=t.value;if(o.roleIds=[],o.userCodes=[],o.more=!1,o.tasks){var a,i=Vo(o.tasks);try{for(i.s();!(a=i.n()).done;){var s=a.value;if(!s.userName)if(s.userCode)this.userIds.push(s.userCode);else if(s.roleId)o.more=!1,o.roleIds.push(s.roleId);else if(s.user){if(o.more=!1,s.user.roleId){var c,u=s.user.roleId.split(",");(c=o.roleIds).push.apply(c,Bo(u))}if(s.user.userCode){var l,d,p=s.user.userCode.split(",");(l=this.userIds).push.apply(l,Bo(p)),(d=o.userCodes).push.apply(d,Bo(p))}}}}catch(f){i.e(f)}finally{i.f()}}}}catch(f){r.e(f)}finally{r.f()}return n}},{key:"loadUserNames",value:function(){var e=qo(ce.a.mark((function e(){var t,n,r,o,a,i,s;return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=this.steps,n=new Map,r=new Map,!this.userIds){e.next=8;break}return e.next=6,pt({ids:this.userIds.join(","),type:"user"});case 6:o=e.sent,o&&o.forEach((function(e){n.set(e.userCode,e)}));case 8:a=Vo(t),e.prev=9,s=ce.a.mark((function e(){var t,r,o,a,s,c;return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=i.value,!t.tasks){e.next=10;break}r=Vo(t.tasks);try{for(r.s();!(o=r.n()).done;)a=o.value,a.userName||a.userCode&&(s=n.get(a.userCode),a.userName=s?s.userName:a.userCode)}catch(u){r.e(u)}finally{r.f()}if(!(t.roleIds&&t.roleIds.length>0)){e.next=9;break}return e.next=7,pt({ids:t.roleIds.join(","),type:"role"});case 7:c=e.sent,c&&c.forEach((function(e){t.tasks.push({userCode:e.userCode,userName:e.userName}),n.set(e.userCode,e)}));case 9:t.userCodes&&t.userCodes.length>0&&t.userCodes.forEach(function(){var e=qo(ce.a.mark((function e(r){var o;return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:o=n.get(r),t.tasks.push({userCode:o.userCode,userName:o.userName});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 10:case"end":return e.stop()}}),e)})),a.s();case 12:if((i=a.n()).done){e.next=16;break}return e.delegateYield(s(),"t0",14);case 14:e.next=12;break;case 16:e.next=21;break;case 18:e.prev=18,e.t1=e["catch"](9),a.e(e.t1);case 21:return e.prev=21,a.f(),e.finish(21);case 24:return e.abrupt("return",{users:n,roles:r});case 25:case"end":return e.stop()}}),e,this,[[9,18,21,24]])})));function t(){return e.apply(this,arguments)}return t}()}]),n}(z["d"]);return Object(X["a"])([Object(z["c"])({default:""})],e.prototype,"size",void 0),Object(X["a"])([Object(z["c"])()],e.prototype,"options",void 0),Object(X["a"])([Object(z["c"])({default:"horizontal"})],e.prototype,"direction",void 0),e=Object(X["a"])([z["a"]],e),e}()),ca=sa,ua=n("de52"),la=n.n(ua),da=n("955a"),pa=n.n(da);function fa(e,t,n){var r=new pa.a.Path({x:t,y:n,opacity:1,fill:"#d1b575",data:"M7.95,0c2.25,0,4.07,1.79,4.07,4c0,2.21-1.82,4-4.07,4S3.89,6.21,3.89,4S5.71,0,7.95,0z M7.95,0  c2.25,0,4.07,1.79,4.07,4c0,2.21-1.82,4-4.07,4S3.89,6.21,3.89,4S5.71,0,7.95,0z M6.43,9.33h3.39c2.9,0,5.25,2.31,5.25,5.17v0.33  c0,1.12-2.35,1.17-5.25,1.17H6.43c-2.9,0-5.25,0-5.25-1.17V14.5C1.18,11.65,3.53,9.33,6.43,9.33L6.43,9.33z"});e.add(r)}function ha(e,t,n){var r=new pa.a.Path({x:t,y:n,opacity:1,stroke:"#bbbbbb",strokeWidth:2,data:"M46,76h10M46,72h10 M46,68h10"});e.add(r)}function ya(e,t,n){var r=new pa.a.Path({x:t,y:n,opacity:1,stroke:"#bbbbbb",strokeWidth:2,data:"M46 70 v8 M50 70 v8 M54 70 v8"});e.add(r)}function ma(e,t,n){var r=new pa.a.Path({x:t,y:n,opacity:1,fill:"#72a7d0",data:"M15.96,6.88c-0.08-0.36-0.4-0.72-0.76-0.8l-0.28-0.04c-0.6-0.2-1.16-0.6-1.48-1.2  c-0.36-0.6-0.44-1.28-0.28-1.92l0,0l0.08-0.24c0.12-0.32-0.04-0.8-0.32-1.04c0,0-0.24-0.2-0.92-0.6s-1-0.52-1-0.52  c-0.32-0.12-0.8,0-1.04,0.24l-0.2,0.2C9.28,1.4,8.68,1.68,8,1.68c-0.68,0-1.32-0.28-1.8-0.72L6.04,0.8C5.8,0.52,5.32,0.44,5,0.56  c0,0-0.32,0.12-1,0.52s-0.92,0.6-0.92,0.6C2.8,1.92,2.64,2.36,2.76,2.72l0.08,0.24C3,3.6,2.92,4.28,2.56,4.88s-0.88,1-1.52,1.2  L0.8,6.12C0.44,6.2,0.12,6.56,0.04,6.92C0.04,6.88,0,7.2,0,8s0.04,1.12,0.04,1.12c0.08,0.36,0.4,0.72,0.76,0.8l0.24,0.04l0,0  c0.6,0.2,1.16,0.6,1.52,1.2c0.36,0.6,0.44,1.28,0.28,1.92l0,0l-0.08,0.24c-0.12,0.32,0.04,0.8,0.32,1.04c0,0,0.24,0.2,0.92,0.6  c0.68,0.4,1,0.52,1,0.52c0.32,0.12,0.8,0,1.04-0.24l0.16-0.2c0.48-0.44,1.08-0.72,1.8-0.72c0.68,0,1.32,0.28,1.8,0.72l0,0l0.16,0.2  c0.24,0.28,0.72,0.36,1.04,0.24c0,0,0.32-0.12,1-0.52c0.68-0.4,0.92-0.6,0.92-0.6c0.28-0.24,0.4-0.68,0.32-1.04l-0.08-0.24  c-0.16-0.64-0.08-1.28,0.28-1.88s0.88-1,1.52-1.2l0,0l0.24-0.04c0.36-0.08,0.68-0.44,0.76-0.8c0,0,0.04-0.32,0.04-1.12  C16,7.2,15.96,6.88,15.96,6.88L15.96,6.88L15.96,6.88z M8,11.2c-1.76,0-3.2-1.44-3.2-3.2S6.24,4.8,8,4.8c1.76,0,3.2,1.44,3.2,3.2  S9.76,11.2,8,11.2L8,11.2L8,11.2z"});e.add(r)}function _a(e,t,n){var r=new pa.a.Path({x:t,y:n,opacity:1,fill:"#72a7d0",data:"M9.6,14.4c0.88,0,1.6-0.72,1.6-1.6V1.94H4.91c-0.44,0-0.8,0.36-0.8,0.8v8.46H2.4V2.4C2.4,1.07,3.47,0,4.8,0  h8.8C14.93,0,16,1.07,16,2.4v0.8h-2.97v10.4c0,1.33-1.07,2.4-2.4,2.4H2.4C1.07,16,0,14.93,0,13.6v-0.8h8C8,13.68,8.72,14.4,9.6,14.4  z"});e.add(r)}function ba(e,t,n){var r=new pa.a.Path({x:t,y:n,opacity:1,fill:"#72a7d0",data:"M14.67,3.83H5.33V6.5h9.33V3.83z M1.33,3.83V6.5H4V3.83H1.33z M5.33,13.17h9.33V7.83H5.33V13.17z M4,13.17  V7.83H1.33v5.33H4z M0,1.17h16V14.5H0V1.17z"});e.add(r)}function ga(e,t,n){var r=new pa.a.Path({x:t,y:n,opacity:1,fill:"#16964d",data:"M 1 3 L 9 11 L 17 3 L 1 3 z M 1 5 L 1 13 L 5 9 L 1 5 z M 17 5 L 13 9 L 17 13 L 17 5 z M 6 10 L 1 15 L 17 15 L 12 10 L 9 13 L 6 10 z"});e.add(r)}function va(e,t,n){var r=new pa.a.Path({x:t,y:n,opacity:1,fill:"#d1b575",data:"m 17,9.3290326 c -0.0069,0.5512461 -0.455166,1.0455894 -0.940778,1.0376604 l -5.792746,0 c 0.0053,0.119381 0.0026,0.237107 0.0061,0.355965 l 5.154918,0 c 0.482032,-0.0096 0.925529,0.49051 0.919525,1.037574 -0.0078,0.537128 -0.446283,1.017531 -0.919521,1.007683 l -5.245273,0 c -0.01507,0.104484 -0.03389,0.204081 -0.05316,0.301591 l 2.630175,0 c 0.454137,-0.0096 0.872112,0.461754 0.866386,0.977186 C 13.619526,14.554106 13.206293,15.009498 12.75924,15 L 3.7753054,15 C 3.6045812,15 3.433552,14.94423 3.2916363,14.837136 c -0.00174,0 -0.00436,0 -0.00609,0 C 1.7212035,14.367801 0.99998255,11.458641 1,11.458641 L 1,7.4588393 c 0,0 0.6623144,-1.316333 1.8390583,-2.0872584 1.1767614,-0.7711868 6.8053358,-2.40497 7.2587847,-2.8052901 0.453484,-0.40032 1.660213,1.4859942 0.04775,2.4010487 C 8.5332315,5.882394 8.507351,5.7996113 8.4370292,5.7936859 l 6.3569748,-0.00871 c 0.497046,-0.00958 0.952273,0.5097676 0.94612,1.0738232 -0.0053,0.556126 -0.456176,1.0566566 -0.94612,1.0496854 l -4.72435,0 c 0.01307,0.1149374 0.0244,0.2281319 0.03721,0.3498661 l 5.952195,0 c 0.494517,-0.00871 0.947906,0.5066305 0.940795,1.0679848 z"});e.add(r)}function wa(e,t,n){var r=new pa.a.Path({x:t,y:n,opacity:1,fill:"#16964d",data:"m 0.5,2.5 0,13 17,0 0,-13 z M 2,4 6.5,8.5 2,13 z M 4,4 14,4 9,9 z m 12,0 0,9 -4.5,-4.5 z M 7.5,9.5 9,11 10.5,9.5 15,14 3,14 z"});e.add(r)}function ka(e,t,n){var r=new pa.a.Path({x:t,y:n,opacity:1,fill:"#bd4848",data:"m 8.1878027,15.383782 c -0.824818,-0.3427 0.375093,-1.1925 0.404055,-1.7743 0.230509,-0.8159 -0.217173,-1.5329 -0.550642,-2.2283 -0.106244,-0.5273 -0.03299,-1.8886005 -0.747194,-1.7818005 -0.712355,0.3776 -0.9225,1.2309005 -1.253911,1.9055005 -0.175574,1.0874 -0.630353,2.114 -0.775834,3.2123 -0.244009,0.4224 -1.741203,0.3888 -1.554386,-0.1397 0.651324,-0.3302 1.13227,-0.9222 1.180246,-1.6705 0.0082,-0.7042 -0.133578,-1.3681 0.302178,-2.0083 0.08617,-0.3202 0.356348,-1.0224005 -0.218996,-0.8051 -0.694517,0.2372 -1.651062,0.6128 -2.057645,-0.2959005 -0.696769,0.3057005 -1.102947,-0.611 -1.393127,-1.0565 -0.231079,-0.6218 -0.437041,-1.3041 -0.202103,-1.9476 -0.185217,-0.7514 -0.39751099,-1.5209 -0.35214999,-2.301 -0.243425,-0.7796 0.86000899,-1.2456 0.08581,-1.8855 -0.76078999,0.1964 -1.41630099,-0.7569 -0.79351899,-1.2877 0.58743,-0.52829998 1.49031699,-0.242 2.09856399,-0.77049998 0.816875,-0.3212 1.256619,0.65019998 1.923119,0.71939998 0.01194,0.7333 -0.0031,1.5042 -0.18417,2.2232 -0.194069,0.564 -0.811196,1.6968 0.06669,1.9398 0.738382,-0.173 1.095723,-0.9364 1.659041,-1.3729 0.727298,-0.3962 1.093982,-1.117 1.344137,-1.8675 0.400558,-0.8287 1.697676,-0.6854 1.955367,0.1758 0.103564,0.5511 0.9073983,1.7538 1.2472763,0.6846 0.121868,-0.6687 0.785541,-1.4454 1.518183,-1.0431 0.813587,0.4875 0.658233,1.6033 1.285504,2.2454 0.768715,0.8117 1.745394,1.4801 2.196633,2.5469 0.313781,0.8074 0.568552,1.707 0.496624,2.5733 -0.35485,0.8576005 -1.224508,-0.216 -0.64725,-0.7284 0.01868,-0.3794 -0.01834,-1.3264 -0.370249,-1.3272 -0.123187,0.7586 -0.152778,1.547 -0.10869,2.3154 0.270285,0.6662005 1.310741,0.7653005 1.060553,1.6763005 -0.03493,0.9801 0.294343,1.9505 0.148048,2.9272 -0.320479,0.2406 -0.79575,0.097 -1.185062,0.1512 -0.165725,0.3657 -0.40138,0.921 -1.020848,0.6744 -0.564671,0.1141 -1.246404,-0.266 -0.578559,-0.7715 0.679736,-0.5602 0.898618,-1.5362 0.687058,-2.3673 -0.529674,-1.108 -1.275984,-2.0954005 -1.839206,-3.1831005 -0.634619,-0.1004 -1.251945,0.6779 -1.956789,0.7408 -0.6065893,-0.038 -1.0354363,-0.06 -0.8495673,0.6969005 0.01681,0.711 0.152396,1.3997 0.157345,2.1104 0.07947,0.7464 0.171287,1.4944 0.238271,2.2351 0.237411,1.0076 -0.687542,1.1488 -1.414811,0.8598 z m 6.8675483,-1.8379 c 0.114364,-0.3658 0.206751,-1.2704 -0.114466,-1.3553 -0.152626,0.5835 -0.225018,1.1888 -0.227537,1.7919 0.147087,-0.1166 0.265559,-0.2643 0.342003,-0.4366 z"});e.add(r)}function Oa(e,t,n){t+=4,n+=2;var r=new pa.a.Path({x:t,y:n,opacity:1,fill:"#bd4848",data:"M 8,0 C 3.581722,0 0,3.5817 0,8 c 0,4.4183 3.581722,8 8,8 4.418278,0 8,-3.5817 8,-8 L 16,7.6562 C 15.813571,3.3775 12.282847,0 8,0 z M 5.1875,2.7812 8,7.3437 10.8125,2.7812 c 1.323522,0.4299 2.329453,1.5645 2.8125,2.8438 1.136151,2.8609 -0.380702,6.4569 -3.25,7.5937 -0.217837,-0.6102 -0.438416,-1.2022 -0.65625,-1.8125 0.701032,-0.2274 1.313373,-0.6949 1.71875,-1.3125 0.73624,-1.2317 0.939877,-2.6305 -0.03125,-4.3125 l -2.75,4.0625 -0.65625,0 -0.65625,0 -2.75,-4 C 3.5268433,7.6916 3.82626,8.862 4.5625,10.0937 4.967877,10.7113 5.580218,11.1788 6.28125,11.4062 6.063416,12.0165 5.842837,12.6085 5.625,13.2187 2.755702,12.0819 1.238849,8.4858 2.375,5.625 2.858047,4.3457 3.863978,3.2112 5.1875,2.7812 z"});e.add(r)}function Ca(e,t,n){t+=-2,n+=-2;var r=new pa.a.Path({x:t,y:n,opacity:1,fill:"#16964d",data:"m 16.704699,5.9229055 q 0.358098,0 0.608767,0.2506681 0.250669,0.250668 0.250669,0.6087677 0,0.3580997 -0.250669,0.6087677 -0.250669,0.2506679 -0.608767,0.2506679 -0.358098,0 -0.608767,-0.2506679 -0.250669,-0.250668 -0.250669,-0.6087677 0,-0.3580997 0.250669,-0.6087677 0.250669,-0.2506681 0.608767,-0.2506681 z m 2.578308,-2.0053502 q -2.229162,0 -3.854034,0.6759125 -1.624871,0.6759067 -3.227361,2.2694472 -0.716197,0.725146 -1.575633,1.7457293 L 7.2329969,8.7876913 Q 7.0897576,8.8055849 7.000233,8.9309334 L 4.9948821,12.368677 q -0.035811,0.06267 -0.035811,0.143242 0,0.107426 0.080572,0.205905 l 0.5729577,0.572957 q 0.125334,0.116384 0.2864786,0.07162 l 2.4708789,-0.760963 2.5156417,2.515645 -0.76096,2.470876 q -0.009,0.02687 -0.009,0.08057 0,0.125338 0.08058,0.205905 l 0.572957,0.572958 q 0.170096,0.152194 0.349146,0.04476 l 3.437744,-2.005351 q 0.125335,-0.08953 0.143239,-0.232763 l 0.17905,-3.392986 q 1.02058,-0.859435 1.745729,-1.575629 1.67411,-1.6830612 2.309735,-3.2049805 0.635625,-1.5219191 0.635625,-3.8585111 0,-0.1253369 -0.08505,-0.2148575 -0.08505,-0.089526 -0.201431,-0.089526 z"});e.add(r)}function Sa(e,t,n){var r=new pa.a.Path({x:t,y:n,opacity:1,fill:"#16964d",data:"m 1,2 0,14 16,0 0,-14 z m 1.4,3 12.7,0 0,10 -12.7,0 z"});e.add(r)}function Ea(e,t,n){var r=new pa.a.Path({x:t,y:n,opacity:1,fill:"#F4F6F7",data:"M8.05,1h6.9C15.75,1,16,1.25,16,2.05v11.9c0,0.8-0.25,1.05-1.05,1.05H1.05C0.3,15,0,14.7,0,14V2  c0-0.7,0.3-1,1-1H8.05z M5,11.25H1v2.7h4V11.25z M10,14v-2.7H6.05V14H10z M11,13.95h4v-2.7h-4V13.95z M1.05,7.65v2.7H5v-2.7  C5,7.65,1.05,7.65,1.05,7.65z M11,10.35h3.8c0.05,0,0.2-0.1,0.2-0.2v-2.5h-4V10.35z M6,10.35h4V7.7H6V10.35z M5,6.75v-2.7H1V6.5  c0,0.1,0.15,0.25,0.25,0.25C1.25,6.75,5,6.75,5,6.75z M6,6.7h4V4.05H6V6.7z M14.95,6.7V4H11v2.7C11,6.7,14.95,6.7,14.95,6.7z"});e.add(r)}function Ia(e,t){t.eventDefinition&&t.eventDefinition.type&&("timer"===t.eventDefinition.type?xa(e,t):"error"===t.eventDefinition.type?$a(e,t):"signal"===t.eventDefinition.type?Ta(e,t):"message"===t.eventDefinition.type&&Da(e,t))}function xa(e,t){var n=new pa.a.Path({x:t.x,y:t.y,opacity:1,fill:"#fff",data:"M22.509999999999998 14.990000000000002  h-7.65  V7.370000000000001  c0 -0.64 -0.52 -1.15 -1.14 -1.15  s-1.14 0.52 -1.14 1.15  v8.6  c0 0.03 0 0.06 0 0.09  s0 0.06 0 0.09  c0 0.64 0.52 1.15 1.14 1.15  h8.79  c0.63 0 1.14 -0.52 1.14 -1.15  C23.65 15.52 23.15 14.990000000000002 22.509999999999998 14.990000000000002  z"});e.add(n)}function $a(e,t){var n="#fff",r=t.x-1,o=t.y-1;"EndEvent"===t.type&&(n="black",r-=1,o-=1);var a=new pa.a.Path({x:r,y:o,opacity:1,stroke:"black",strokeWidth:0,fill:n,data:"M 22.820839,11.171502 L 19.36734,24.58992 L 13.54138,14.281819 L 9.3386512,20.071607 L 13.048949,6.8323057 L 18.996148,16.132659 L 22.820839,11.171502 z"});return e.add(a),a}function Ta(e,t){var n="none";"ThrowEvent"===t.type&&(n="black");var r=new pa.a.Path({x:t.x-1,y:t.y-1,opacity:1,stroke:"black",strokeWidth:1,fill:n,data:"M 8.7124971,21.247342 L 23.333334,21.247342 L 16.022915,8.5759512 L 8.7124971,21.247342 z"});return e.add(r),r}function Da(e,t){var n="#fff";"ThrowEvent"===t.type&&(n="black");var r=new pa.a.Path({x:t.x,y:t.y,opacity:1,fill:n,data:"M19.759999999999998 9.36  h-9.52  c-1.34 0 -2.45 1.09 -2.45 2.45  v6.38  c0 1.34 1.09 2.45 2.45 2.45  h9.52  c1.34 0 2.45 -1.09 2.45 -2.45  v-6.38  C22.200000000000003 10.47 21.11 9.36 19.759999999999998 9.36  z M19.299999999999997 10.59  l-4.5 3.67  l-4.31 -3.67  H19.299999999999997  z M20.979999999999997 18.19  c0 0.67 -0.55 1.22 -1.22 1.22  h-9.52  c-0.67 0 -1.22 -0.55 -1.22 -1.22  v-6.38  c0 -0.17 0.04 -0.34 0.1 -0.48  l5.63 4.46  h0.04  h0.04  l6.02 -4.54  c0.09 0.17 0.14 0.36 0.14 0.57  C20.979999999999997 11.82 20.979999999999997 18.19 20.979999999999997 18.19  z"});return e.add(r),r}function ja(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Pa(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ra(e,t,n){return t&&Pa(e.prototype,t),n&&Pa(e,n),e}var Na=1,La=1.5,Aa=2,Ma=1,Ua=2,Fa=3,Ba="#2632aa",Ka="#017501",Wa="#bbbbbb",Ga="#f9f9f9",Va="#585858",Xa="#EC662C",za=3,Ha=4,qa={ApprovedColor:"rgba(140,220,51,0.35)",ProcessColor:"rgba(23,140,255,0.35)"},Ya=function(){function e(t,n){ja(this,e),this.showState=!1,this.layer=t,this.showState=n}return Ra(e,[{key:"bpmnGetColor",value:function(e,t){var n;return n=e.current?Ka:e.completed?Ba:t,n}},{key:"drawStartEvent",value:function(e){var t=this.drawEvent(e,Na,15,"#7EBF36");this.layer.add(t)}},{key:"drawEndEvent",value:function(e){var t=this.drawEvent(e,Fa,14,"#E72123");this.layer.add(t)}},{key:"drawEvent",value:function(e,t,n,r){var o=e.x+e.width/2,a=e.y+e.height/2,i=this.bpmnGetColor(e,Va),s=this.determineCustomFillColor(e,r||"#ffffff"),c=new pa.a.Group,u=new pa.a.Circle({id:e.id,x:o,y:a,radius:n,fill:s,stroke:i,strokeWidth:t});return c.add(u),Ia(c,e),c}},{key:"drawScriptTask",value:function(e){var t=new pa.a.Group;this.drawTask(t,e),_a(t,e.x+4,e.y+4),this.layer.add(t)}},{key:"drawBusinessRuleTask",value:function(e){var t=new pa.a.Group;this.drawTask(t,e),ba(t,e.x+4,e.y+4),this.layer.add(t)}},{key:"drawManualTask",value:function(e){var t=new pa.a.Group;this.drawTask(t,e),va(t,e.x+4,e.y+4),this.layer.add(t)}},{key:"drawSendTask",value:function(e){var t=new pa.a.Group;this.drawTask(t,e),ga(t,e.x+4,e.y+4),this.layer.add(t)}},{key:"drawReceiveTask",value:function(e){var t=new pa.a.Group;this.drawTask(t,e),wa(t,e.x,e.y),this.layer.add(t)}},{key:"drawServiceTask",value:function(e){var t=new pa.a.Group;this.drawTask(t,e),"mail"===e.taskType?ga(t,e.x+4,e.y+4):"camel"===e.taskType?ka(t,e.x+4,e.y+4):"mule"===e.taskType?Oa(t,e.x+4,e.y+4):"http"===e.taskType?Ca(t,e.x+4,e.y+4):"shell"===e.taskType?Sa(t,e.x+4,e.y+4):"dmn"===e.taskType?Ea(t,e.x+4,e.y+4):ma(t,e.x+4,e.y+4),this.layer.add(t)}},{key:"drawHttpServiceTask",value:function(e){var t=new pa.a.Group;this.drawTask(t,e),Ca(t,e.x+4,e.y+4),this.layer.add(t)}},{key:"drawUserTask",value:function(e){var t=new pa.a.Group;this.drawTask(t,e),fa(t,e.x+4,e.y+4),e.properties.forEach((function(n){"Sequential"===n.name&&("true"===n.value?ha(t,e.x,e.y-4):ya(t,e.x,e.y-4))})),this.layer.add(t)}},{key:"drawTask",value:function(e,t){var n,r=this.bpmnGetColor(t,Wa);n=r===Wa?Ma:Ua;var o=t.width-n/2,a=t.height-n/2,i=this.determineCustomFillColor(t,Ga),s=new pa.a.Rect({id:t.id,x:t.x,y:t.y,width:o,height:a,stroke:r,strokeWidth:n,fill:i,cornerRadius:4});this.showState&&(e.on("mouseover",(function(n){if(t.tasks){s.shadowColor("black"),s.shadowBlur(5),s.shadowOffset({x:3,y:3}),s.shadowOpacity(.2);var r=e.getLayer();if(r){var o=r.find("#tooltip")[0];o.x(t.x+t.width/2),o.y(t.y+t.height+10),o.width(t.width);var a=o.find("#tooltip-text")[0],i="",c=t.tasks.filter((function(e){return!e.roleId}));c.forEach((function(e,n){console.log("task",e,n),i+=(e.userName||e.userCode)+"\n",e.message&&(i+=e.message+"\n"),e.endTime&&(i+=la()(e.endTime,"YYYY-MM-DD HH:mm:ss.S").format("MM-DD HH:mm")),n<t.tasks.length-1&&(i+="\n\n")})),a.text(i),o.moveToTop(),o.show(),t.changeHeight(30*c.length),r.draw()}}})),e.on("mouseout",(function(t){s.shadowColor(""),s.shadowBlur(0),s.shadowOffset({x:0,y:0}),s.shadowOpacity(0);var n=e.getLayer();if(n){var r=n.find("#tooltip")[0];r.hide(),n.draw()}}))),e.add(s),t.name&&this.drawMultilineText(e,t.name,t.x,t.y,t.width,t.height,"middle","middle",11)}},{key:"drawExclusiveGateway",value:function(e){var t=this.drawGateway(e);this.layer.add(t);var n=new pa.a.Path({x:e.x,y:e.y,strokeWidth:0,fill:"#F7F7F7",data:"M20.3,19.3l-4.4-4.4l4.2-4.2l-0.9-1l-4.3,4.2l-4.2-4.2l-1,1l4.3,4.2l-4.5,4.4l1,1l4.4-4.4l4.4,4.4   L20.3,19.3z"});this.layer.add(n)}},{key:"drawParallelGateway",value:function(e){var t=new pa.a.Group,n=this.drawGateway(e);t.add(n);var r=new pa.a.Path({x:e.x,y:e.y,strokeWidth:0,fill:"#F7F7F7",data:"M15.8,21.8v-6.2h5.9l0.1-1.3l-6-0.1V8.2h-1.4l0.1,6l-6.3-0.1l0,1.4h6.2v6.2L15.8,21.8L15.8,21.8z"});t.add(r),this.layer.add(t)}},{key:"drawInclusiveGateway",value:function(e){var t=new pa.a.Group,n=this.drawGateway(e);t.add(n);var r=new pa.a.Path({x:e.x,y:e.y,strokeWidth:0,fill:"#F7F7F7",data:"M11.9,9.9h1.4v10.2h-1.4V9.9z M16.7,9.9H18v10.2h-1.4V9.9z"});t.add(r),this.layer.add(t)}},{key:"drawEventGateway",value:function(e){var t=new pa.a.Group,n=this.drawGateway(e);t.add(n);var r=new pa.a.Path({x:e.x,y:e.y,strokeWidth:0,fill:"#F7F7F7",data:"M 15 11.6 l 0.9 1.8 l 0.3 0.6 l 0.7 0.1 l 2 0.3 l -1.4 1.4 l -0.5 0.5 l 0.1 0.7 l 0.3 2 l -1.8 -0.9 L 15 17.7 l -0.6 0.3 L 12.6 19 l 0.3 -2 l 0.1 -0.7 l -0.5 -0.5 l -1.4 -1.4 l 2 -0.3 l 0.7 -0.1 l 0.3 -0.6 L 15 11.6 M 15 8.5 l -2.1 4.3 l -4.7 0.7 l 3.4 3.3 l -0.8 4.7 l 4.2 -2.2 l 4.2 2.2 l -0.8 -4.7 l 3.4 -3.3 l -4.7 -0.7 L 15 8.5 L 15 8.5 Z"});t.add(r),this.layer.add(t)}},{key:"drawGateway",value:function(e){this.bpmnGetColor(e,Va);var t=new pa.a.Group({id:e.id,x:e.x,y:e.y}),n=new pa.a.Path({fill:"#48B096",data:"M15,29.3c-0.4,0-0.7-0.1-1-0.4l-13-13c-0.5-0.5-0.5-1.4,0-1.9l13-13c0.5-0.5,1.4-0.5,1.9,0l13,13   c0.5,0.5,0.5,1.4,0,1.9l-13,13C15.7,29.2,15.4,29.3,15,29.3z"}),r=new pa.a.Path({strokeWidth:0,fill:"#666868",data:"M15,1.5c0.2,0,0.4,0.1,0.5,0.2l12.8,12.8c0.3,0.3,0.3,0.7,0,1L15.5,28.3c-0.3,0.3-0.7,0.3-1,0   L1.7,15.5c-0.3-0.3-0.3-0.7,0-1L14.5,1.7C14.6,1.6,14.8,1.5,15,1.5 M15,0c-0.5,0-1.1,0.2-1.4,0.6l-13,13c-0.8,0.8-0.8,2.1,0,2.9   l13,13c0.8,0.8,2.1,0.8,2.9,0l13-13c0.8-0.8,0.8-2.1,0-2.9l-13-13C16.1,0.2,15.5,0,15,0L15,0z"});return t.add(n),t.add(r),t}},{key:"drawBoundaryEvent",value:function(e){var t=new pa.a.Group,n=e.x+e.width/2,r=e.y+e.height/2,o={},a=this.bpmnGetColor(e,Va);o=e.cancelActivity?{"stroke-width":1,stroke:a,fill:Xa}:{"stroke-width":1,"stroke-dasharray":[5,5],stroke:a,fill:Xa};var i=new pa.a.Circle({id:e.id,x:n,y:r,radius:15,stroke:o.stroke,dash:o.dash,strokeWidth:o.strokeWidth,fill:o.strokeColor});t.add(i);var s={};s=e.cancelActivity?{"stroke-width":1,stroke:"#fff",fill:""}:{"stroke-width":1,"stroke-dasharray":[5,5],stroke:"#fff",fill:""};var c=new pa.a.Circle({id:e.id+"_inner",x:n,y:r,radius:12,stroke:s.stroke,dash:s.dash,strokeWidth:s.strokeWidth,fill:s.strokeColor});t.add(c),Ia(t,e),this.layer.add(t)}},{key:"drawIntermediateCatchEvent",value:function(e){var t=new pa.a.Group,n=e.x+e.width/2,r=e.y+e.height/2,o=this.bpmnGetColor(e,Va),a={};a={"stroke-width":1,stroke:o,fill:Xa};var i={};i={"stroke-width":1,stroke:"#fff",fill:"none"};var s=new pa.a.Circle({id:e.id,x:n,y:r,radius:15,stroke:a.stroke,strokeWidth:a.strokeWidth,fill:a.strokeColor});t.add(s);var c=new pa.a.Circle({id:e.id+"_inner",x:n,y:r,radius:12,stroke:i.stroke,strokeWidth:i.strokeWidth,fill:i.strokeColor});t.add(c),Ia(t,e),this.layer.add(t)}},{key:"drawThrowEvent",value:function(e){var t=new pa.a.Group,n=e.x+e.width/2,r=e.y+e.height/2,o=this.bpmnGetColor(e,Va),a={};a={"stroke-width":1,stroke:o,fill:Xa};var i=new pa.a.Circle({id:e.id,x:n,y:r,radius:15,stroke:a.stroke,strokeWidth:a.strokeWidth,fill:a.strokeColor});t.add(i);var s={"stroke-width":1,stroke:Xa,fill:"none"},c=new pa.a.Circle({id:e.id+"_inner",x:n,y:r,radius:12,stroke:s.stroke,strokeWidth:s.strokeWidth,fill:s.strokeColor});t.add(c),Ia(t,e)}},{key:"drawMultilineText",value:function(e,t,n,r,o,a,i,s,c){if(t&&""!=t){var u,l;"middle"===i?u=n+o/2:"start"===i&&(u=n),l=r+a/2;var d=new pa.a.Text({x:u+za,y:l+za,text:t,fill:"#373e48",fontFamily:"Arial",fontSize:c});"middle"===i&&d.offsetX(d.width()/2),"middle"===s&&d.offsetY(d.height()/2),e.add(d)}}},{key:"drawFlow",value:function(e){var t=[];e.waypoints.forEach((function(e){t.push(e.x,e.y)}));var n=this.bpmnGetColor(e,Va),r=new pa.a.Arrow({id:e.id,points:t,stroke:n,strokeWidth:La,fill:n,pointerLength:2*Ha,pointerWidth:2*Ha});if(this.layer.add(r),e.name){console.log("rotation",r.rotation());var o=e.waypoints.slice(-1)[0],a=e.waypoints.slice(-2)[0],i=Math.atan2(a.y-o.y,o.x-a.x),s=i*(180/Math.PI),c=new pa.a.Text({x:a.x,y:a.y,text:e.name,fontSize:12,align:"center",verticalAlign:"middle",width:Math.sqrt(Math.pow(Math.abs(o.x-a.x),2)+Math.pow(Math.abs(o.y-a.y),2)),height:22});c.rotate(-s),this.layer.add(c)}}},{key:"drawAssociation",value:function(e){var t=new pa.a.Line({id:e.id,points:e.waypoints,stroke:"#585858",strokeWidth:Aa});this.layer.add(t)}},{key:"determineCustomFillColor",value:function(e,t){if(this.showState){if(e.status==go["TaskState"].Approved)return qa.ApprovedColor;if(e.status==go["TaskState"].Process)return qa.ProcessColor}return t}}]),e}();function Ja(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Qa(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Za(e,t,n){return t&&Qa(e.prototype,t),n&&Qa(e,n),e}var ei=function(){function e(t,n,r,o){Ja(this,e),this._id=t,this._width=n,this._height=r,this._layer=new pa.a.Layer,this.drawingCore=new Ya(this._layer,o);var a=new pa.a.Label({id:"tooltip",radius:5,visible:!1,width:0,height:0}),i=new pa.a.Tag({fill:"#FFFAE3",pointerDirection:"up",stroke:"#E2D9AF",strokeWidth:1,pointerWidth:10,pointerHeight:10,lineJoin:"round",shadowColor:"black",shadowBlur:10,shadowOffset:{x:2,y:2},shadowOpacity:.5,cornerRadius:4});a.add(i),a.add(new pa.a.Text({id:"tooltip-text",text:"",fontFamily:"Calibri",fontSize:12,padding:8,lineHeight:1.5})),this._layer.add(a),this._stage=new pa.a.Stage({container:this._id,width:this._width,height:this._height}),this._stage.add(this._layer)}return Za(e,[{key:"drawShape",value:function(e){switch(e.changeHeight||(e.changeHeight=function(e){}),e.type){case"StartEvent":this.drawingCore.drawStartEvent(e);break;case"EndEvent":this.drawingCore.drawEndEvent(e);break;case"BoundaryEvent":this.drawingCore.drawBoundaryEvent(e);break;case"IntermediateCatchEvent":this.drawingCore.drawIntermediateCatchEvent(e);break;case"ThrowEvent":this.drawingCore.drawThrowEvent(e);break;case"UserTask":this.drawingCore.drawUserTask(e);break;case"ScriptTask":this.drawingCore.drawScriptTask(e);break;case"BusinessRuleTask":this.drawingCore.drawBusinessRuleTask(e);break;case"ManualTask":this.drawingCore.drawManualTask(e);break;case"SendTask":this.drawingCore.drawSendTask(e);break;case"ReceiveTask":this.drawingCore.drawReceiveTask(e);break;case"ServiceTask":this.drawingCore.drawServiceTask(e);break;case"ExclusiveGateway":this.drawingCore.drawExclusiveGateway(e);break;case"ParallelGateway":this.drawingCore.drawParallelGateway(e);break;case"InclusiveGateway":this.drawingCore.drawInclusiveGateway(e);break;case"EventGateway":this.drawingCore.drawEventGateway(e);break}}},{key:"drawFlow",value:function(e){this.drawingCore.drawFlow(e)}},{key:"drawAssociation",value:function(e){this.drawingCore.drawAssociation(e)}},{key:"render",value:function(){this._layer.draw()}},{key:"layer",get:function(){return this._layer}}]),e}();function ti(e){return ti="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ti(e)}function ni(e,t){var n;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=ri(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw a}}}}function ri(e,t){if(e){if("string"===typeof e)return oi(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?oi(e,t):void 0}}function oi(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ai(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,o)}function ii(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){ai(a,r,o,i,s,"next",e)}function s(e){ai(a,r,o,i,s,"throw",e)}i(void 0)}))}}function si(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ci(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ui(e,t,n){return t&&ci(e.prototype,t),n&&ci(e,n),e}function li(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&di(e,t)}function di(e,t){return di=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},di(e,t)}function pi(e){var t=yi();return function(){var n,r=mi(e);if(t){var o=mi(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return fi(this,n)}}function fi(e,t){return!t||"object"!==ti(t)&&"function"!==typeof t?hi(e):t}function hi(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yi(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function mi(e){return mi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},mi(e)}var _i=function(){var e=function(e){li(n,e);var t=pi(n);function n(){var e;return si(this,n),e=t.apply(this,arguments),e.data=[],e._id="",e.userIds=[],e.users=new Map,e.elements=[],e}return ui(n,[{key:"created",value:function(){this._id=Rt()}},{key:"reload",value:function(){var e=ii(ce.a.mark((function e(){var t,n,r,o,a,i;return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return Tt("workflow-trace-flowchart",["businessKey"],this.options),e.next=3,Ue(this.options.businessKey);case 3:if(this.workflowInfo=e.sent,this.workflowInfo){e.next=7;break}return Pt("查询工作流信息失败:".concat(this.options.businessKey)),e.abrupt("return",!0);case 7:return e.next=9,rt(this.workflowInfo.procInstId);case 9:if(t=e.sent,!t){e.next=21;break}if(this.data=t||[],this._drawing=new ei(this._id,t.diagramWidth,t.diagramHeight,this.showState),t.elements)for(this.elements=this.findUserIds(t.elements||[]),n=0;n<this.elements.length;n++)r=this.elements[n],this._drawing.drawShape(r);if(t.flows)for(n=0;n<t.flows.length;n++)o=t.flows[n],"sequenceFlow"===o.type?this._drawing.drawFlow(o):"association"===o.type&&this._drawing.drawAssociation(o);return this._drawing.render(),e.next=18,this.loadUserNames();case 18:a=e.sent,i=a.users,this.users=i;case 21:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"mounted",value:function(){var e=ii(ce.a.mark((function e(){return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.reload();case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"render",value:function(e){return e("div",{class:"workflow-trace-flowchart"},[e("div",{attrs:{id:this._id}})])}},{key:"findUserIds",value:function(e){var t,n=e,r=ni(e);try{for(r.s();!(t=r.n()).done;){var o=t.value;if(o.roleIds=[],o.tasks){var a,i=ni(o.tasks);try{for(i.s();!(a=i.n()).done;){var s=a.value;s.userName||(s.userCode?this.userIds.push(s.userCode):s.roleId&&(o.more=!1,o.roleIds.push(s.roleId)))}}catch(c){i.e(c)}finally{i.f()}}}}catch(c){r.e(c)}finally{r.f()}return n}},{key:"loadUserNames",value:function(){var e=ii(ce.a.mark((function e(){var t,n,r,o,a,i,s;return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=this.elements,n=new Map,r=new Map,!this.userIds){e.next=8;break}return e.next=6,pt({ids:this.userIds.join(","),type:"user"});case 6:o=e.sent,o&&o.forEach((function(e){n.set(e.userCode,e)}));case 8:a=ni(t);try{for(s=function(){var e=i.value;if(e.tasks){var t,r=ni(e.tasks);try{for(r.s();!(t=r.n()).done;){var o=t.value;if(!o.userName&&o.userCode){var a=n.get(o.userCode);o.userName=a?a.userName:o.userCode}}}catch(s){r.e(s)}finally{r.f()}e.roleIds&&e.roleIds.length>0&&e.roleIds.forEach(function(){var t=ii(ce.a.mark((function t(r){var o;return ce.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,pt({ids:r,type:"role"});case 2:o=t.sent,o&&o.forEach((function(t){e.tasks.push({userCode:t.userCode,userName:t.userName}),n.set(t.userCode,t)}));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}},a.s();!(i=a.n()).done;)s()}catch(c){a.e(c)}finally{a.f()}return e.abrupt("return",{users:n,roles:r});case 11:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}]),n}(z["d"]);return Object(X["a"])([Object(z["c"])()],e.prototype,"options",void 0),Object(X["a"])([Object(z["c"])({default:!1})],e.prototype,"showState",void 0),e=Object(X["a"])([z["a"]],e),e}(),bi=_i;function gi(e){return gi="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gi(e)}function vi(e){return Oi(e)||ki(e)||Si(e)||wi()}function wi(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ki(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function Oi(e){if(Array.isArray(e))return Ei(e)}function Ci(e,t){var n;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=Si(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw a}}}}function Si(e,t){if(e){if("string"===typeof e)return Ei(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ei(e,t):void 0}}function Ei(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ii(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function xi(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ii(Object(n),!0).forEach((function(t){$i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ii(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function $i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ti(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,o)}function Di(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){Ti(a,r,o,i,s,"next",e)}function s(e){Ti(a,r,o,i,s,"throw",e)}i(void 0)}))}}function ji(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Pi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ri(e,t,n){return t&&Pi(e.prototype,t),n&&Pi(e,n),e}function Ni(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Li(e,t)}function Li(e,t){return Li=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Li(e,t)}function Ai(e){var t=Fi();return function(){var n,r=Bi(e);if(t){var o=Bi(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Mi(this,n)}}function Mi(e,t){return!t||"object"!==gi(t)&&"function"!==typeof t?Ui(e):t}function Ui(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Fi(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function Bi(e){return Bi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Bi(e)}var Ki=5,Wi={"001":go["TaskState"].Submitted,"002":go["TaskState"].Process,"003":go["TaskState"].Process,"004":go["TaskState"].Process,"005":go["TaskState"].Approved,"006":go["TaskState"].Process,"007":go["TaskState"].Back,"008":go["TaskState"].Process,"009":go["TaskState"].NotStart,"010":go["TaskState"].Cancel,"011":go["TaskState"].Approved,"014":go["TaskState"].Approved},Gi={submitted:"已提交",submitting:"待提交",approved:"已审核",process:"审核中",cancel:"已撤销",back:"已驳回",dateTimeFormat:"MM-DD HH:mm"},Vi=function(){var e=function(e){Ni(n,e);var t=Ai(n);function n(){var e;return ji(this,n),e=t.apply(this,arguments),e.steps=[],e.userIds=[],e.users=new Map,e.userInfo={userName:""},e.flowchartVisible=!1,e.elementColumns=[{title:"",dataIndex:"isRequired",key:"isRequired",width:40,align:"center",customRender:function(t,n){return e.renderElement(n)}},{title:"审批要点名称",dataIndex:"elementName",key:"elementName",width:240}],e}return Ri(n,[{key:"onOptionsChanged",value:function(e,t){e&&this.reload()}},{key:"reload",value:function(){var e=Di(ce.a.mark((function e(){var t,n,r,o,a,i;return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(Dt("workflow-trace-full",["procInstId"],["businessKey"],this.options)){e.next=3;break}return this.options.onComplete&&this.options.onComplete({error:1,message:"无效的options参数"}),e.abrupt("return");case 3:return e.next=5,Ne();case 5:if(t=e.sent,t&&(this.adminConfig=t),n=this.options.variables||[],0!=n.length){e.next=12;break}return Pt("workflow-trace-full variables不能为空",!0),this.options.onComplete&&this.options.onComplete({error:1,message:"variables不能为空"}),e.abrupt("return",!0);case 12:return console.log("config",this.options),e.next=15,Ft(this.options,{hiddenCancelNodes:!1});case 15:if(this.config=e.sent,this.config){e.next=20;break}return Pt("查询工作流信息失败"),this.options.onComplete&&this.options.onComplete({error:1,message:"查询工作流信息失败"}),e.abrupt("return",!0);case 20:return e.next=22,Je({procInstId:this.config.procInstId,variables:this.options.variables||[]});case 22:if(r=e.sent,!r){e.next=37;break}return e.next=26,this.getSteps(r||[]);case 26:return this.steps=e.sent,console.log("steps",this.steps),e.next=30,this.loadUserNames();case 30:o=e.sent,a=o.users,this.users=a,this.loadSignData(),this.loadApproveElements(),i=document.querySelector(".task-process"),i&&i.focus();case 37:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"mounted",value:function(){var e=Di(ce.a.mark((function e(){return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.reload();case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"showUserInfo",value:function(){var e=Di(ce.a.mark((function e(t){return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.userInfo=this.users.get(t),console.log("userinfo",this.userInfo);case 2:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"renderTaskStateText",value:function(e,t,n){var r=this.getTaskState(t,n.status),o=e("div"),a=xi(xi({},Gi),this.locale);return r==go["TaskState"].Submitted?o=e("div",{class:"task-approved"},[a.submitted]):r==go["TaskState"].Submitting?o=e("div",{class:"task-process",attrs:{tabindex:"-1"}},[a.submitting]):r==go["TaskState"].Approved?o=e("div",{class:"task-approved"},[a.approved]):r==go["TaskState"].Process?o=e("div",{class:"task-process",attrs:{tabindex:"-1"}},[a.process]):r==go["TaskState"].NotStart?o=e("div",{class:"task-none"},[a.none]):r==go["TaskState"].Back?o=e("div",{class:"task-back"},[a.back]):r==go["TaskState"].Backed?o=e("div",{class:"task-process"},[a.process]):r==go["TaskState"].Cancel&&(o=e("div",{class:"task-cancel"},[a.cancel])),n.elements&&n.elements.length>0?e("aw-popover",{attrs:{trigger:"click",placement:"bottom",overlayClassName:"workflow-elements",content:e("div",[e("div",{class:"workflow-elements-title"},["审批要点: "]),e("aw-table",{attrs:{bordered:!0,rowKey:"id",pagination:!1,columns:this.elementColumns,dataSource:n.elements}})])}},[e("span",{style:"display:inline-block"},[e("span",{style:"display:inline-block"},[o])," ",e("a",{class:"workflow-link",attrs:{href:"javascript:void(0)"}},[e("aw-icon",{style:"margin-left: 5px",attrs:{type:"ordered-list"}})])])]):o}},{key:"renderTasks",value:function(e,t){var n=this;if(!t.tasks)return e("div");var r=t.tasks.filter((function(e){return!e.user})),o=r.length,a=this.options.maxUserCount||Ki;t.more||(r=r.slice(0,a)),console.log("tasks",r);var i=xi(xi({},Gi),this.locale),s=r.map((function(r){return e("div",[e("div",{class:"workflow-user"},[(r.roleName||r.roleId)&&e("span",{class:"workflow-rolename",attrs:{title:r.roleName||""}},["".concat(r.roleName||"".concat(r.roleId,"(角色)"))]),(r.userName||r.userCode)&&e("aw-popover",{attrs:{trigger:"click",placement:"leftTop",overlayClassName:"workflow-userinfo",content:n.userInfo&&e("div",[e("div",[e("span",["姓名:"]),n.userInfo.userName]),e("div",[e("span",["手机:"]),n.userInfo.phone]),e("div",[e("span",["E-Mail:"]),n.userInfo.mail]),e("div",[e("span",["电话:"]),n.userInfo.tel])])}},[e("span",{class:"workflow-username",attrs:{title:r.userName||""},on:{click:function(){return n.showUserInfo(r.userCode)}}},[r.userName||r.userCode||""])]),e("span",{class:"workflow-taskstate"},[n.renderTaskStateText(e,t,r)])]),e("div",{class:"workflow-image"},[r.manualSignImage&&e("div",{class:"workflow-manual-sign-image"},[e("img",{attrs:{src:r.manualSignImage}})]),r.signImage&&e("div",{class:"workflow-sign-image"},[e("img",{attrs:{src:r.signImage}})])]),r.status!==go["TaskState"].NotStart&&r.message?e("div",{class:"workflow-message"},[e("div",[n.options.isMessagePrefix&&e("span",{class:"workflow-messae-pre"},["意见:"]),"".concat(r.message)]),e("div",{class:"workflow-time"},[r.endTime&&la()(r.endTime,"YYYY-MM-DD HH:mm:ss.S").format(i.dateTimeFormat)||""])]):e("div",{class:"workflow-time"},[r.endTime&&la()(r.endTime,"YYYY-MM-DD HH:mm:ss.S").format(i.dateTimeFormat)||""])])}));return e("div",{class:"workflow-tasks"},[e("div",{class:"workflow-task"},[t.duration>0&&e("div",{class:"workflow-duration"},[$t(t.duration)]),s,o>a&&e("div",{class:"more",on:{click:function(){t.more=!t.more}}},[" ",t.more?e("aw-icon",{attrs:{type:"up"}}):e("aw-icon",{attrs:{type:"down"}})])])])}},{key:"renderState",value:function(e){return 1==e?"finish":2==e?"process":"wait"}},{key:"renderStepIcon",value:function(e,t,n){if("simple"!=this.iconStyle){var r=vn;switch(t){case"startEvent":r=wn;break;case"endEvent":r=kn;break;case"userTask":1==n?r=Cn:2==n?r=On:3==n&&(r=vn);break}var o="process";switch(n){case go["TaskState"].Approved:o="approved";break;case go["TaskState"].Process:o="process";break;case go["TaskState"].NotStart:o="none";break}return e("aw-icon",{attrs:{component:r},class:o})}switch(n){case go["TaskState"].Approved:return e("aw-icon",{attrs:{type:"check-circle"},class:"workflow-step-finished"});case go["TaskState"].Process:return e("aw-icon",{attrs:{type:"loading"},class:"workflow-step-processing"});case go["TaskState"].NotStart:return e("aw-icon",{attrs:{type:"minus-circle"},class:"workflow-step-finished"})}}},{key:"renderTitle",value:function(e,t){var n=t.nodeName;return e("div",{attrs:{title:t.nodeName}},[n])}},{key:"render",value:function(e){var t=this;return e("div",{class:"workflow-trace-full ".concat(this.direction," ").concat(this.size)},[e("aw-steps",{attrs:{direction:this.direction,size:"small",labelPlacement:"horizontal"},class:"workflow-steps"},[this.steps.map((function(n){return e("aw-step",{class:"workflow-step",attrs:{icon:t.renderStepIcon(e,n.actType,Number(n.status)),status:t.renderState(n.status),title:t.renderTitle(e,n),description:t.renderTasks(e,n)}})}))]),this.showChartLink&&e("div",{class:"workflow-trace-full"},[e("span",{class:"link-openchart",on:{click:function(){t.flowchartVisible=!0}}},["查看流程图"]),e("aw-modal",{attrs:{title:"流程图",visible:this.flowchartVisible,width:1e3,zIndex:9999,footer:null},on:{cancel:function(){return t.flowchartVisible=!1}}},[this.config&&this.config.procDefId&&e("div",{class:"workflow-trace-full-chart"},[e("img",{attrs:{src:mt(this.config.procDefId)}})])])])])}},{key:"getTaskState",value:function(e,t){var n=Wi[t];return e.isFirstNode&&(n==go["TaskState"].Process?n=go["TaskState"].Submitting:n==go["TaskState"].Approved&&(n=go["TaskState"].Submitted)),n}},{key:"getSteps",value:function(e){var t,n=[],r=e,o=!1,a="",i=Ci(r);try{for(i.s();!(t=i.n()).done;){var s=t.value;s.roleIds=[],s.userCodes=[],s.more=!1;var c=!1;if(o||"userTask"!=s.actType||(o=!0,a=s.nodeId,s.isFirstNode=!0),s.nodeId==a&&(s.isFirstNode=!0),s.tasks){var u,l=Ci(s.tasks);try{for(l.s();!(u=l.n()).done;){var d=u.value;if(d.signImage=null,d.manualSignImage=null,d.elements=[],!this.config.hiddenCancelNodes||"010"!=d.status&&"008"!=d.status||(c=!0),!d.userName)if(d.userCode)this.userIds.push(d.userCode);else if(d.roleId)s.more=!1,s.roleIds.push(d.roleId);else if(d.user){if(s.more=!1,d.user.roleId){var p,f=d.user.roleId.split(",");(p=s.roleIds).push.apply(p,vi(f))}if(d.user.userCode){var h,y,m=d.user.userCode.split(",");(h=this.userIds).push.apply(h,vi(m)),(y=s.userCodes).push.apply(y,vi(m))}}}}catch(_){l.e(_)}finally{l.f()}}c||n.push(s)}}catch(_){i.e(_)}finally{i.f()}return n}},{key:"loadUserNames",value:function(){var e=Di(ce.a.mark((function e(){var t,n,r,o,a,i,s,c=this;return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=this.steps,n=new Map,r=new Map,!this.userIds){e.next=8;break}return e.next=6,pt({procInstId:this.config.procInstId,ids:this.userIds.join(","),type:"user"});case 6:o=e.sent,o&&o.forEach((function(e){n.set(e.userCode,e)}));case 8:a=Ci(t),e.prev=9,s=ce.a.mark((function e(){var t,r,o,a,s,u,l,d,p,f;return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=i.value,r=new Map,!c.options.showDelegatedUserName||t.status!==go["TaskState"].Process){e.next=11;break}return o=t.tasks.map((function(e){return e.taskId})).join(","),e.next=6,ft(o);case 6:if(a=e.sent,!(a&&a.length>0)){e.next=11;break}return e.next=10,a.reduce(function(){var e=Di(ce.a.mark((function e(t,r){var o,a;return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,pt({procInstId:c.config.procInstId,ids:r.delegatedUserCode,type:"user"});case 2:return o=e.sent,o&&(a=o[0],t.set(r.delegateUserCode,a),n.set(a.userCode,a)),e.abrupt("return",t);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),new Map);case 10:r=e.sent;case 11:if(!t.tasks){e.next=28;break}s=Ci(t.tasks);try{for(s.s();!(u=s.n()).done;)l=u.value,l.userName||l.userCode&&(d=n.get(l.userCode),d&&c.showUser(l,r,d.userName))}catch(h){s.e(h)}finally{s.f()}if(!(t.roleIds&&t.roleIds.length>0)){e.next=27;break}if(!c.options.showRoleName){e.next=23;break}if(!c.adminConfig){e.next=21;break}return e.next=19,ht(c.adminConfig.platform.baseUrl,{ids:t.roleIds.join(",")});case 19:p=e.sent,p&&(p.forEach((function(e){console.log("node.tasks.push",e.roleId,e.roleName),t.tasks.push({roleId:e.roleId,roleName:e.roleName})})),console.log(t.tasks));case 21:e.next=27;break;case 23:return e.next=25,pt({procInstId:c.config.procInstId,ids:t.roleIds.join(","),type:"role"});case 25:f=e.sent,f&&f.forEach((function(e){var o={userCode:e.userCode,userName:e.userName};c.showUser(o,r,e.userName),t.tasks.push(o),n.set(e.userCode,e)}));case 27:t.userCodes&&t.userCodes.length>0&&t.userCodes.forEach(function(){var e=Di(ce.a.mark((function e(o){var a,i;return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:a=n.get(o),a&&(i={userCode:a.userCode,userName:a.userName},c.showUser(i,r,a.userName),t.tasks.push(i));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 28:case"end":return e.stop()}}),e)})),a.s();case 12:if((i=a.n()).done){e.next=16;break}return e.delegateYield(s(),"t0",14);case 14:e.next=12;break;case 16:e.next=21;break;case 18:e.prev=18,e.t1=e["catch"](9),a.e(e.t1);case 21:return e.prev=21,a.f(),e.finish(21);case 24:return e.abrupt("return",{users:n,roles:r});case 25:case"end":return e.stop()}}),e,this,[[9,18,21,24]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"loadSignData",value:function(){var e=Di(ce.a.mark((function e(){var t,n,r,o,a,i,s,c,u,l,d,p,f;return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.config.procInstId){e.next=10;break}return e.next=3,fn(this.config.procInstId);case 3:if(t=e.sent,n=new Map,r=new Map,t&&t.length>0){o=Ci(t);try{for(o.s();!(a=o.n()).done;)i=a.value,i.signImage&&n.set(i.taskId,"data:image/gif;base64,"+i.signImage),i.manualSignImage&&r.set(i.taskId,"data:image/gif;base64,"+i.manualSignImage)}catch(h){o.e(h)}finally{o.f()}}s=this.steps,c=Ci(s);try{for(c.s();!(u=c.n()).done;)if(l=u.value,l.tasks){d=Ci(l.tasks);try{for(d.s();!(p=d.n()).done;)f=p.value,n.has(f.taskId)&&(f.signImage=n.get(f.taskId)),r.has(f.taskId)&&(f.manualSignImage=r.get(f.taskId))}catch(h){d.e(h)}finally{d.f()}}}catch(h){c.e(h)}finally{c.f()}case 10:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"renderElement",value:function(e){var t=this.$createElement;return"1"===e.isRequired?t("aw-icon",{class:"workflow-element-check",attrs:{type:"check"}}):t("div")}},{key:"loadApproveElements",value:function(){var e=Di(ce.a.mark((function e(){var t,n,r,o,a,i,s,c;return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.config.procInstId){e.next=8;break}return console.log("loadApproveElements",this.config.procInstId),e.next=4,bn(this.config.procInstId);case 4:t=e.sent,n=this.steps,r=Ci(n);try{for(r.s();!(o=r.n()).done;)if(a=o.value,a.tasks){i=Ci(a.tasks);try{for(i.s();!(s=i.n()).done;)c=s.value,t[c.taskId]&&(console.log("task.elements",t[c.taskId]),c.elements=t[c.taskId])}catch(u){i.e(u)}finally{i.f()}}}catch(u){r.e(u)}finally{r.f()}case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"showUser",value:function(e,t,n){if(this.options.showDelegatedUserName&&t.has(e.userCode)){var r=t.get(e.userCode);e.userCode=r.userCode,e.userName=r.userName}else e.userName=n}}]),n}(z["d"]);return Object(X["a"])([Object(z["c"])()],e.prototype,"options",void 0),Object(X["a"])([Object(z["c"])({default:"default"})],e.prototype,"size",void 0),Object(X["a"])([Object(z["c"])({default:"default"})],e.prototype,"iconStyle",void 0),Object(X["a"])([Object(z["c"])()],e.prototype,"locale",void 0),Object(X["a"])([Object(z["c"])({default:"horizontal"})],e.prototype,"direction",void 0),Object(X["a"])([Object(z["c"])({default:!0})],e.prototype,"showChartLink",void 0),Object(X["a"])([Object(z["e"])("options")],e.prototype,"onOptionsChanged",null),e=Object(X["a"])([Object(z["a"])({components:{"workflow-flowchart":bi}})],e),e}(),Xi=Vi;function zi(e){return zi="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zi(e)}function Hi(e){return Ji(e)||Yi(e)||Zi(e)||qi()}function qi(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Yi(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function Ji(e){if(Array.isArray(e))return es(e)}function Qi(e,t){var n;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=Zi(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw a}}}}function Zi(e,t){if(e){if("string"===typeof e)return es(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?es(e,t):void 0}}function es(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ts(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,o)}function ns(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){ts(a,r,o,i,s,"next",e)}function s(e){ts(a,r,o,i,s,"throw",e)}i(void 0)}))}}function rs(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function os(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function as(e,t,n){return t&&os(e.prototype,t),n&&os(e,n),e}function is(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ss(e,t)}function ss(e,t){return ss=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ss(e,t)}function cs(e){var t=ds();return function(){var n,r=ps(e);if(t){var o=ps(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return us(this,n)}}function us(e,t){return!t||"object"!==zi(t)&&"function"!==typeof t?ls(e):t}function ls(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ds(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function ps(e){return ps=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ps(e)}var fs=3,hs=function(){var e=function(e){is(n,e);var t=cs(n);function n(){var e;return rs(this,n),e=t.apply(this,arguments),e.steps=[],e.userIds=[],e.users=new Map,e}return as(n,[{key:"reload",value:function(){var e=ns(ce.a.mark((function e(){var t,n,r;return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return Tt("workflow-trace-form",["businessKeys"],this.options),e.next=3,Ze(this.options);case 3:if(t=e.sent,!t){e.next=11;break}return this.steps=this.getSteps(t||[]),e.next=8,this.loadUserNames();case 8:n=e.sent,r=n.users,this.users=r;case 11:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"mounted",value:function(){var e=ns(ce.a.mark((function e(){return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.reload();case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"renderStep",value:function(e,t){if(!t.tasks)return e("div");var n=t.tasks.filter((function(e){return!e.roleId&&!e.user})),r=n.length;t.more||(n=n.slice(0,fs));var o=n.map((function(n){return n.roleId?e("div"):e("div",{class:"workflow-task"},[e("aw-icon",{attrs:{type:"user"},class:1==t.status?"workflow-step-finished":"workflow-step-processing"}),e("span",{class:"username",attrs:{title:n.userName||""}},[n.userName||""])," ",e("span",[n.message])])}));return e("div",[e("div",[o]),r>fs&&e("div",{class:"more",on:{click:function(){t.more=!t.more}}},[" ",t.more?e("aw-icon",{attrs:{type:"up"}}):e("aw-icon",{attrs:{type:"down"}})])])}},{key:"renderState",value:function(e){return 1==e?"finish":2==e?"process":"wait"}},{key:"renderStepIcon",value:function(e,t){return e("aw-icon",1==t?{attrs:{type:"check-circle"},class:"workflow-step-finished"}:{attrs:{type:"loading"},class:"workflow-step-processing"})}},{key:"render",value:function(e){var t=this;return e("div",{class:"workflow-trace-form ".concat(this.direction," ").concat(this.size)},[e("aw-steps",{attrs:{direction:this.direction,size:"small",labelPlacement:"horizontal"},class:"workflow-steps"},[this.steps.map((function(n){return e("aw-step",{class:"workflow-step",attrs:{icon:t.renderStepIcon(e,n.status),status:t.renderState(n.status),title:n.nodeName,description:t.renderStep(e,n)}})}))])])}},{key:"getSteps",value:function(e){var t,n=e,r=Qi(n);try{for(r.s();!(t=r.n()).done;){var o=t.value;if(o.roleIds=[],o.userCodes=[],o.tasks){var a,i=Qi(o.tasks);try{for(i.s();!(a=i.n()).done;){var s=a.value;if(!s.userName)if(s.userCode)this.userIds.push(s.userCode);else if(s.roleId)o.more=!1,o.roleIds.push(s.roleId);else if(s.user){if(o.more=!1,s.user.roleId){var c,u=s.user.roleId.split(",");(c=o.roleIds).push.apply(c,Hi(u))}if(s.user.userCode){var l,d,p=s.user.userCode.split(",");(l=this.userIds).push.apply(l,Hi(p)),(d=o.userCodes).push.apply(d,Hi(p))}}}}catch(f){i.e(f)}finally{i.f()}}}}catch(f){r.e(f)}finally{r.f()}return n}},{key:"loadUserNames",value:function(){var e=ns(ce.a.mark((function e(){var t,n,r,o,a,i,s;return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=this.steps,n=new Map,r=new Map,!this.userIds){e.next=8;break}return e.next=6,pt({ids:this.userIds.join(","),type:"user"});case 6:o=e.sent,o&&o.forEach((function(e){n.set(e.userCode,e)}));case 8:a=Qi(t),e.prev=9,s=ce.a.mark((function e(){var t,r,o,a,s,c;return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=i.value,!t.tasks){e.next=10;break}r=Qi(t.tasks);try{for(r.s();!(o=r.n()).done;)a=o.value,a.userName||a.userCode&&(s=n.get(a.userCode),a.userName=s?s.userName:a.userCode)}catch(u){r.e(u)}finally{r.f()}if(!(t.roleIds&&t.roleIds.length>0)){e.next=9;break}return e.next=7,pt({ids:t.roleIds.join(","),type:"role"});case 7:c=e.sent,c&&c.forEach((function(e){t.tasks.push({userCode:e.userCode,userName:e.userName}),n.set(e.userCode,e)}));case 9:t.userCodes&&t.userCodes.length>0&&t.userCodes.forEach(function(){var e=ns(ce.a.mark((function e(r){var o;return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:o=n.get(r),t.tasks.push({userCode:o.userCode,userName:o.userName});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 10:case"end":return e.stop()}}),e)})),a.s();case 12:if((i=a.n()).done){e.next=16;break}return e.delegateYield(s(),"t0",14);case 14:e.next=12;break;case 16:e.next=21;break;case 18:e.prev=18,e.t1=e["catch"](9),a.e(e.t1);case 21:return e.prev=21,a.f(),e.finish(21);case 24:return e.abrupt("return",{users:n,roles:r});case 25:case"end":return e.stop()}}),e,this,[[9,18,21,24]])})));function t(){return e.apply(this,arguments)}return t}()}]),n}(z["d"]);return Object(X["a"])([Object(z["c"])({default:""})],e.prototype,"size",void 0),Object(X["a"])([Object(z["c"])()],e.prototype,"options",void 0),Object(X["a"])([Object(z["c"])({default:"horizontal"})],e.prototype,"direction",void 0),e=Object(X["a"])([z["a"]],e),e}(),ys=hs;function ms(e){return ms="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ms(e)}function _s(e,t){var n;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=bs(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw a}}}}function bs(e,t){if(e){if("string"===typeof e)return gs(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?gs(e,t):void 0}}function gs(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function vs(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,o)}function ws(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){vs(a,r,o,i,s,"next",e)}function s(e){vs(a,r,o,i,s,"throw",e)}i(void 0)}))}}function ks(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Os(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ks(Object(n),!0).forEach((function(t){Cs(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ks(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Cs(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ss(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Es(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Is(e,t,n){return t&&Es(e.prototype,t),n&&Es(e,n),e}function xs(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$s(e,t)}function $s(e,t){return $s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},$s(e,t)}function Ts(e){var t=Ps();return function(){var n,r=Rs(e);if(t){var o=Rs(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ds(this,n)}}function Ds(e,t){return!t||"object"!==ms(t)&&"function"!==typeof t?js(e):t}function js(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ps(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function Rs(e){return Rs=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Rs(e)}var Ns={"001":go["TaskState"].Submitted,"002":go["TaskState"].Process,"003":go["TaskState"].Process,"004":go["TaskState"].Process,"005":go["TaskState"].Approved,"006":go["TaskState"].Back,"007":go["TaskState"].Back,"008":go["TaskState"].Cancel,"009":go["TaskState"].NotStart,"010":go["TaskState"].Cancel,"011":go["TaskState"].Approved,"014":go["TaskState"].Approved},Ls={submitted:"已提交",approved:"已审核",process:"审核中",cancel:"已撤销",back:"已驳回",dateTimeFormat:"MM-DD HH:mm"},As=function(){var e=function(e){xs(n,e);var t=Ts(n);function n(){var e;return Ss(this,n),e=t.apply(this,arguments),e.columns=[{title:"序号",dataIndex:"index",width:"70px",customRender:function(e,t,n){return n+1}},{title:"节点名称",dataIndex:"taskName",key:"taskName"},{title:"审批状态",dataIndex:"state",key:"state",customRender:function(t,n,r){return e.renderTaskStateText(n.state)}},{title:"审批人",dataIndex:"opUserName",key:"opUserName",customRender:function(e,t,n){return t.userName||t.userCode||""}},{title:"审批意见",dataIndex:"message",key:"message",width:"350px"},{title:"审批时间",align:"right",dataIndex:"endTime",key:"endTime",customRender:function(t,n,r){var o=Os(Os({},Ls),e.locale);return la()(n.endTime,"YYYY-MM-DD HH:mm:ss.S").format(o.dateTimeFormat)||""}}],e.tasks=[],e}return Is(n,[{key:"onOptionsChanged",value:function(e,t){e&&this.reload()}},{key:"reload",value:function(){var e=ws(ce.a.mark((function e(){var t;return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(Dt("workflow-trace-list",["procInstId"],["businessKey"],this.options)){e.next=3;break}return this.options.onComplete&&this.options.onComplete({error:1,message:"无效的options参数"}),e.abrupt("return");case 3:return e.next=5,Ft(this.options);case 5:if(this.config=e.sent,this.config){e.next=10;break}return Pt("查询工作流信息失败"),this.options.onComplete&&this.options.onComplete({error:1,message:"查询工作流信息失败"}),e.abrupt("return",!0);case 10:return e.next=12,tt({procInstId:this.config.procInstId,sort:this.sort});case 12:t=e.sent,t&&(this.tasks=t||[],this.updateUserNames(this.tasks));case 14:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"mounted",value:function(){var e=ws(ce.a.mark((function e(){return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.reload();case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"render",value:function(e){return e("div",{class:"workflow-trace-list"},[e("aw-table",{attrs:{bordered:!0,columns:this.columns,dataSource:this.tasks,rowKey:"taskId",locale:{emptyText:this.emptyText},pagination:!1}})])}},{key:"renderTaskStateText",value:function(e){var t=this.$createElement,n=Ns[e],r=t("div"),o=Os(Os({},Ls),this.locale);return n==go["TaskState"].Submitted?r=t("div",{class:"task-approved"},[o.submitted]):n==go["TaskState"].Approved?r=t("div",{class:"task-approved"},[o.approved]):n==go["TaskState"].Process?r=t("div",{class:"task-process"},[o.process]):n==go["TaskState"].NotStart?r=t("div",{class:"task-none"},[o.none]):n==go["TaskState"].Back?r=t("div",{class:"task-back"},[o.back]):n==go["TaskState"].Backed?r=t("div",{class:"task-process"},[o.process]):n==go["TaskState"].Cancel&&(r=t("div",{class:"task-cancel"},[o.cancel])),r}},{key:"updateUserNames",value:function(){var e=ws(ce.a.mark((function e(t){var n,r,o,a,i,s,c,u,l,d,p,f,h,y;return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:n={},r=0,o=_s(t);try{for(o.s();!(a=o.n()).done;)i=a.value,i.userName||(n[i.userCode]=i,r++)}catch(m){o.e(m)}finally{o.f()}if(!(r>0)){e.next=13;break}return e.next=7,pt({ids:Object.keys(n).join(","),type:"user"});case 7:s=e.sent,c={},u=_s(s);try{for(u.s();!(l=u.n()).done;)d=l.value,c[d.userCode]=d}catch(m){u.e(m)}finally{u.f()}p=_s(t);try{for(p.s();!(f=p.n()).done;)h=f.value,h.userName||(y=c[h.userCode],y&&(h.userName=y.userName))}catch(m){p.e(m)}finally{p.f()}case 13:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()}]),n}(z["d"]);return Object(X["a"])([Object(z["c"])()],e.prototype,"options",void 0),Object(X["a"])([Object(z["c"])({default:"desc"})],e.prototype,"sort",void 0),Object(X["a"])([Object(z["c"])()],e.prototype,"locale",void 0),Object(X["a"])([Object(z["c"])({default:"没有审批记录"})],e.prototype,"emptyText",void 0),Object(X["a"])([Object(z["e"])("options")],e.prototype,"onOptionsChanged",null),e=Object(X["a"])([z["a"]],e),e}(),Ms=As;function Us(e){return Us="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Us(e)}function Fs(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,o)}function Bs(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){Fs(a,r,o,i,s,"next",e)}function s(e){Fs(a,r,o,i,s,"throw",e)}i(void 0)}))}}function Ks(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ws(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Gs(e,t,n){return t&&Ws(e.prototype,t),n&&Ws(e,n),e}function Vs(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Xs(e,t)}function Xs(e,t){return Xs=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Xs(e,t)}function zs(e){var t=Ys();return function(){var n,r=Js(e);if(t){var o=Js(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Hs(this,n)}}function Hs(e,t){return!t||"object"!==Us(t)&&"function"!==typeof t?qs(e):t}function qs(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ys(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function Js(e){return Js=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Js(e)}var Qs="approve",Zs=function(){var e=function(e){Vs(n,e);var t=zs(n);function n(){var e;return Ks(this,n),e=t.apply(this,arguments),e.approveText="",e.maxMessageCount=100,e.remarks=[],e.searchText="",e.userPage=0,e.userPageCount=1,e.userTotal=0,e.saveBusying=!1,e.signObject=null,e}return Gs(n,[{key:"onVisibleChanged",value:function(e,t){e&&this.reinit(this.options)}},{key:"onOptionsChanged",value:function(e,t){this.visible&&e&&this.reinit(e)}},{key:"onOk",value:function(){var e=Bs(ce.a.mark((function e(t){var n,r,o;return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n={error:0,message:""},e.prev=1,this.options&&this.options.list&&0!=this.options.list.length){e.next=4;break}throw{code:1,msg:"请选择批量送审的单据"};case 4:if(r=this.options.list.map((function(e){return e.taskId})),r&&0!=r.length){e.next=7;break}throw{code:1,msg:"请选择批量送审的单据"};case 7:if(!this.options.signType||!this.options.signRequired||this.signObject&&this.signObject.signImage){e.next=9;break}throw{error:1,message:"请签章后再审批"};case 9:return this.signObject||(this.signObject={signMessage:this.approveText}),this.saveBusying=!0,o={userCode:we.userCode,signObject:this.signObject,message:this.approveText,taskFormRequests:this.options.list.map((function(e){return{businessKey:e.businessKey,variables:e.variables}}))},e.next=14,_t(r.join(","),o);case 14:return e.abrupt("return",n);case 17:e.prev=17,e.t0=e["catch"](1),n=Gt(e.t0);case 20:return e.prev=20,this.saveBusying=!1,e.finish(20);case 23:return e.abrupt("return",n);case 24:case"end":return e.stop()}}),e,this,[[1,17,20,23]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"onCancel",value:function(e){return!1}},{key:"mounted",value:function(){var e=Bs(ce.a.mark((function e(){return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.visible&&this.reinit(this.options);case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"destroyed",value:function(){Zt(this.options.signType||"")}},{key:"reinit",value:function(){var e=Bs(ce.a.mark((function e(t){var n=this;return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.options=t,console.log("options",this.options),this.options.signType&&Qt(this.options.signType||""),this.approveText=we.getData("approve.text")||"",this.maxMessageCount=we.getData("general.maxMessageCount")||100,this.getRemarkList().then((function(e){e&&e.length>0&&(n.approveText=e[0].text||"")}));case 6:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"handleWordChange",value:function(e){console.log("selected",e),this.approveText=e}},{key:"onInputChange",value:function(e){console.log("onInputChange",e),this.approveText=e.target.value}},{key:"starRemarkItem",value:function(){var e=Bs(ce.a.mark((function e(t){return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log("starRemarkItem",t),e.next=3,xt({id:t.id,flag:1==t.flag?0:1});case 3:W["a"].success(1==t.flag?"取消批语星标成功":"添加批语星标成功"),this.getRemarkList();case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"deleteRemarkItem",value:function(){var e=Bs(ce.a.mark((function e(t){var n=this;return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:console.log("deleteRemarkItem",t),b["a"].confirm({title:"确定要删除该批语吗?",okText:"确认",cancelText:"取消",onOk:function(){var e=Bs(ce.a.mark((function e(){return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,St(t.id);case 2:W["a"].success("批语删除成功"),n.getRemarkList();case 4:case"end":return e.stop()}}),e)})));function r(){return e.apply(this,arguments)}return r}(),onCancel:function(){}});case 2:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"selectRemarkItem",value:function(e){console.log("selectRemarkItem",e),this.approveText=e.text}},{key:"render",value:function(e){var t=this;return e("aw-modal",{attrs:{centered:!0,title:this.options.title||"审批",visible:this.visible,maskClosable:!1,footer:[e("aw-button",{key:"back",on:{click:this.onCancel}},["取消"]),e("aw-button",{key:"submit",attrs:{loading:this.saveBusying,type:"primary"},on:{click:function(e){t.onOk(e)}}},["确定"])]},class:"workflow workflow-approve",on:{cancel:this.onCancel}},[e("aw-row",{class:"workflow-line"},[e("aw-col",{attrs:{span:3},class:"title"},["常用批语: "]),e("aw-col",{attrs:{span:21}},[e("aw-dropdown",{class:"workflow-remark-button"},[e("aw-menu",{slot:"overlay",class:"workflow-remark"},[this.remarks&&this.remarks.length>0?this.remarks.map((function(n){return e("aw-menu-item",{key:n.id},[e("span",{class:"workflow-remark-text",on:{click:function(e){t.selectRemarkItem(n)}}},[Kt(n.text)]),"private"==n.type&&e("span",{class:"workflow-remark-actions"},[e("aw-icon",{attrs:{title:"星标批语",type:"star",theme:n.flag&&"filled"},on:{click:function(e){t.starRemarkItem(n)}}}),e("aw-icon",{attrs:{title:"删除批语",type:"delete"},on:{click:function(){return t.deleteRemarkItem(n)}}})])])})):e("aw-menu-item",["当前还没有批语"])]),e("aw-button",{style:"margin-left: 8px"},["请选择常用批语 ",e("aw-icon",{attrs:{type:"down"}})])])])]),e("aw-row",{class:"workflow-line"},[e("aw-col",{attrs:{id:"message-container"}},[e("aw-textarea",{attrs:{id:"approve-message",maxLength:this.maxMessageCount,rows:2,value:this.approveText,placeholder:"请输入批语"},ref:"approveMessage",on:{change:this.onInputChange}})])]),e("aw-row",{class:"workflow-line"},[e("aw-col",[e("aw-button",{attrs:{disabled:!this.approveText},on:{click:function(){var e=Bs(ce.a.mark((function e(){return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,It({appCode:we.appCode,comLang:t.approveText,type:Qs});case 3:e.next=9;break;case 5:return e.prev=5,e.t0=e["catch"](0),W["a"].error("批语已存在, 不能保存重复批语"),e.abrupt("return");case 9:return e.next=11,Et({appCode:we.appCode,text:t.approveText,type:Qs});case 11:W["a"].success("批语保存成功"),t.getRemarkList();case 13:case"end":return e.stop()}}),e,null,[[0,5]])})));function n(){return e.apply(this,arguments)}return n}()}},["另存为新批语"]),this.options.signType&&e("aw-button",{style:"margin-left:8px",attrs:{type:"primary"},on:{click:function(){var e=Bs(ce.a.mark((function e(){var n;return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:e.prev=0,n=t.$refs.approveMessage,t.options.signImage?(t.signObject={signImage:t.options.signImage,signType:t.options.signType,signMessage:t.approveText},en({signImage:t.options.signImage,elementId:"approve-message",left:n.$el.clientWidth-119,top:n.$el.clientHeight-42,imgWidth:119,imgHeight:42,containerElementId:"message-container"},(function(){t.signObject.signImage=null}))):Jt(t.options.signType||"",{left:n.$el.clientWidth-80,top:n.$el.clientHeight-40,imgWidth:80,imgHeight:40,defaultSignText:" ",containerId:"message-container",fieldId:"approve-message",onSuccess:function(){var e=Bs(ce.a.mark((function e(n,r,o){return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.signObject={signImage:o,signType:t.options.signType,signMethod:r,signMessage:t.approveText,signData:n};case 1:case"end":return e.stop()}}),e)})));function n(t,n,r){return e.apply(this,arguments)}return n}()}),e.next=9;break;case 5:return e.prev=5,e.t0=e["catch"](0),W["a"].error(e.t0.message),e.abrupt("return");case 9:case"end":return e.stop()}}),e,null,[[0,5]])})));function n(){return e.apply(this,arguments)}return n}()}},["签章"])])])])}},{key:"getRemarkList",value:function(){var e=Bs(ce.a.mark((function e(){return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Ct({appCode:we.appCode,userCode:we.userCode,size:10,type:Qs});case 2:return this.remarks=e.sent,e.abrupt("return",this.remarks);case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"saveSignData",value:function(){var e=Bs(ce.a.mark((function e(t){return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",pn(t));case 1:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()}]),n}(z["d"]);return Object(X["a"])([Object(z["c"])({default:""})],e.prototype,"title",void 0),Object(X["a"])([Object(z["c"])({default:!1})],e.prototype,"visible",void 0),Object(X["a"])([Object(z["c"])()],e.prototype,"options",void 0),Object(X["a"])([Object(z["e"])("visible")],e.prototype,"onVisibleChanged",null),Object(X["a"])([Object(z["e"])("options")],e.prototype,"onOptionsChanged",null),Object(X["a"])([Object(z["b"])("complete")],e.prototype,"onOk",null),Object(X["a"])([Object(z["b"])("cancel")],e.prototype,"onCancel",null),e=Object(X["a"])([z["a"]],e),e}(),ec=Zs;function tc(e){return tc="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tc(e)}function nc(e){return ic(e)||ac(e)||oc(e)||rc()}function rc(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function oc(e,t){if(e){if("string"===typeof e)return sc(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?sc(e,t):void 0}}function ac(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function ic(e){if(Array.isArray(e))return sc(e)}function sc(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function cc(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function uc(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?cc(Object(n),!0).forEach((function(t){lc(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):cc(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function lc(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function dc(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,o)}function pc(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){dc(a,r,o,i,s,"next",e)}function s(e){dc(a,r,o,i,s,"throw",e)}i(void 0)}))}}function fc(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function yc(e,t,n){return t&&hc(e.prototype,t),n&&hc(e,n),e}function mc(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_c(e,t)}function _c(e,t){return _c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},_c(e,t)}function bc(e){var t=wc();return function(){var n,r=kc(e);if(t){var o=kc(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return gc(this,n)}}function gc(e,t){return!t||"object"!==tc(t)&&"function"!==typeof t?vc(e):t}function vc(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wc(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function kc(e){return kc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},kc(e)}var Oc=10,Cc=[{title:"单位",dataIndex:"unitName",key:"unitName",width:180},{title:"部门",dataIndex:"deptName",key:"deptName",width:130},{title:"姓名",dataIndex:"userName",key:"userName"},{title:"编号",dataIndex:"userCode",key:"userCode"}],Sc=function(){var e=function(e){mc(n,e);var t=bc(n);function n(){var e;return fc(this,n),e=t.apply(this,arguments),e.approveText="",e.searchText="",e.userPage=0,e.userPageCount=1,e.userTotal=0,e.userList=[],e.currentUsers=[],e.userMap=new Map,e.steps=[],e.selectedNodeId="",e.defaultUnit="",e.units=[],e.orgs=[],e.defaultOrgId="",e.defaultOrgType="",e.buttonBusying=!1,e}return yc(n,[{key:"onVisibleChanged",value:function(e,t){e&&this.reload(this.options)}},{key:"onOptionsChanged",value:function(e,t){this.visible&&e&&this.reload(e)}},{key:"onOk",value:function(){var e=pc(ce.a.mark((function e(t){var n,r,o,a,i,s,c;return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n={error:0,message:""},e.prev=1,this.buttonBusying=!0,r=this.config.taskId?this.config.taskId:this.config.businessKey,r){e.next=7;break}throw we.debug&&G["a"].error({message:"错误",description:"taskId|businessKey not found"}),{code:1,msg:"taskId|businessKey not found"};case 7:if(o=[],this.currentUsers&&this.currentUsers.length>0&&(o=this.currentUsers.map((function(e){return{assignee:e.userCode,assigneeName:e.userName,assigneeType:"user"}}))),this.action){e.next=11;break}throw{code:1,msg:"未设置action(delegate|transfer)"};case 11:if(0!=o.length){e.next=13;break}throw{code:1,msg:"请选择".concat(this.title,"人员")};case 13:return a=[],this.options.variables&&(a=this.options.variables.map((function(e){return uc(uc({},e),{},{name:e.name.replace("$_","fvar_")})}))),i="",s="",this.options.bizExtra&&(i=this.options.bizExtra.bizTitle||"",s=this.options.bizExtra.bizUrl||""),c=this.config.taskId?ot:at,e.next=21,c(r,{action:this.action,variables:a,bizUrl:s,bizTitle:i,assignment:o?o[0]:null,message:this.approveText});case 21:e.next=28;break;case 23:e.prev=23,e.t0=e["catch"](1),n.error=e.t0.code||1,n.message=e.t0.message,e.t0.code&&(n.message=e.t0.msg);case 28:return e.prev=28,this.buttonBusying=!1,e.finish(28);case 31:return e.abrupt("return",n);case 32:case"end":return e.stop()}}),e,this,[[1,23,28,31]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"onCancel",value:function(e){return!1}},{key:"mounted",value:function(){var e=pc(ce.a.mark((function e(){return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.visible&&this.reload(this.options);case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"reload",value:function(){var e=pc(ce.a.mark((function e(t){return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.options=t,Dt("workflow-delegate",["taskId","unitCode"],["businessKey","unitCode"],t)){e.next=4;break}return this.options.onComplete&&this.options.onComplete({error:1,message:"无效的options参数"}),e.abrupt("return");case 4:return e.next=6,Ft(t);case 6:return this.config=e.sent,console.log("config",t,this.config),"delegate"==this.action?this.approveText=we.getData("delegate.text")||"":"transfer"==this.action&&(this.approveText=we.getData("transfer.text")||""),e.next=11,rn(this.options.unitCode,"");case 11:if(this.units=e.sent,!(this.units&&this.units.length>0)){e.next=18;break}return this.defaultUnit=this.units[0].value,e.next=16,an(this.defaultUnit,"",!0);case 16:this.orgs=e.sent,this.orgs&&this.orgs.length>0&&(this.defaultOrgId=this.orgs[0].value,this.defaultOrgType=this.orgs[0].type,this.searchUserList(this.defaultOrgType,this.defaultOrgId,1,""));case 18:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"selectDeptTreeNode",value:function(){var e=pc(ce.a.mark((function e(t,n){return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:console.log("selectTreeNode",n.node),t&&t.length>0&&(this.defaultOrgId=t[0]),this.defaultOrgType=n.node.$attrs.type,this.searchText="",this.searchUserList(this.defaultOrgType,this.defaultOrgId,1,"");case 5:case"end":return e.stop()}}),e,this)})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"handleUnitChange",value:function(){var e=pc(ce.a.mark((function e(t){return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log("handleUnitChange",t),this.defaultUnit=t,e.next=4,an(t,"",!0);case 4:this.orgs=e.sent,this.orgs&&this.orgs.length>0&&this.selectDeptTreeNode([this.orgs[0].id],{node:{$attrs:{type:this.orgs[0].type}}});case 6:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"onSearch",value:function(e){console.log("search",e),this.searchText=e,this.searchUserList(this.defaultOrgType,this.defaultOrgId,1,e)}},{key:"onInputChange",value:function(e){console.log("onInputChange",e),this.approveText=e.target.value}},{key:"onRemoveUser",value:function(e){console.log("onRemoveUser",e);var t=this.currentUsers.findIndex((function(t){return t.userCode===e.userCode}));t>-1&&this.currentUsers.splice(t,1)}},{key:"render",value:function(e){var t=this,n=this.options.isTextMessage;return e("aw-modal",{attrs:{centered:!0,title:this.options.title||"",visible:this.visible,maskClosable:!1,footer:[e("aw-button",{key:"back",on:{click:this.onCancel}},["取消"]),e("aw-button",{key:"submit",attrs:{type:"primary",loading:this.buttonBusying},on:{click:function(e){t.onOk(e)}}},["确定"])]},class:"workflow workflow-delegate",on:{cancel:this.onCancel}},[e("div",[e("aw-row",{class:"workflow-line bottom"},[e("aw-col",{attrs:{span:6},class:"workflow-delegate-tree"},[e("aw-tree-select",{attrs:{showSearch:!0,searchPlaceholder:"搜索",treeDefaultExpandAll:!0,value:this.defaultUnit,treeData:this.units,filterTreeNode:function(e,t){return-1!==t.data.props.title.indexOf(e)}},class:"worklfow-units",on:{change:this.handleUnitChange}}),e("aw-tree",{class:"workflow-orgs",attrs:{showLine:!0,selectedKeys:[this.defaultOrgId],defaultExpandAll:!0,treeDefaultExpandAll:!0},on:{select:this.selectDeptTreeNode}},[this.showTreeNode(e,this.orgs)])]),e("aw-col",{attrs:{span:18},class:"workflow-user-list"},[e("div",{class:"workflow-user-list-header"},[e("aw-input-search",{attrs:{placeholder:"请输入姓名进行搜索"},on:{search:this.onSearch},style:{width:200}})]),e("div",[e("aw-table",{attrs:{bordered:!0,rowKey:"userCode",locale:{emptyText:e("aw-empty",{attrs:{height:180}})},pagination:{current:this.userPage,pageSize:Oc,total:this.userTotal,size:"middle",onChange:function(e){t.userPage=e,console.log("page",e),t.searchUserList(t.defaultOrgType,t.defaultOrgId,e,t.searchText)}},rowSelection:this.rowSelection,dataSource:nc(this.userList),columns:Cc,scroll:{y:150,x:500}},class:"workflow-user-list-table"})])])]),e("aw-row",{class:"workflow-delegate-select"},[e("aw-col",{attrs:{span:2}},["已选人员: "]),e("aw-col",{attrs:{span:22}},[e("div",{class:"workflow-delegate-tags"},[this.users.map((function(n){return e("aw-tag",{attrs:{closable:!0},on:{close:function(){return t.onRemoveUser(n)}}},[n.userName])}))])])])]),n&&e("div",[e("aw-row",{class:"workflow-line"},[e("aw-col",{attrs:{span:24},class:"title left-tag"},["意见"])]),e("aw-row",{class:"workflow-line"},[e("aw-col",[e("aw-textarea",{attrs:{rows:2,value:this.approveText,placeholder:"请输入意见"},on:{change:this.onInputChange}})])])])])}},{key:"searchUserList",value:function(){var e=pc(ce.a.mark((function e(t,n,r,o){var a;return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,sn(this.searchText,t,this.options.unitCode,n,r,Oc);case 2:a=e.sent,a&&(this.userList=a.rows||[],this.userTotal=a.records,this.userPage=a.page);case 4:case"end":return e.stop()}}),e,this)})));function t(t,n,r,o){return e.apply(this,arguments)}return t}()},{key:"showTreeNode",value:function(e,t){var n=this;return t.map((function(t){return t.children&&t.children.length>0?e("aw-tree-node",{key:t.id,attrs:{value:t.id,title:t.name,type:t.type}},[n.showTreeNode(e,t.children)]):e("aw-tree-node",{key:t.id,attrs:{value:t.id,title:t.name,type:t.type}})}))}},{key:"locale",get:function(){return{emptyText:"当前没有数据"}}},{key:"users",get:function(){return this.currentUsers}},{key:"rowSelection",get:function(){var e=this;return{type:"radio",onChange:function(t,n){var r=(e.userList||[]).map((function(e){return e.userCode})).filter((function(e){return!t.includes(e)})),o=e.currentUsers.filter((function(e){return-1==r.indexOf(e.userCode)}));n.forEach((function(t){-1==o.findIndex((function(e){return e.userCode===t.userCode}))&&o.push(t),e.userMap.has(t.userCode)||e.userMap.set(t.userCode,t)})),e.currentUsers=o},selectedRowKeys:this.currentUsers.map((function(e){return e.userCode}))}}}]),n}(z["d"]);return Object(X["a"])([Object(z["c"])({default:""})],e.prototype,"title",void 0),Object(X["a"])([Object(z["c"])({default:function(){return[]}})],e.prototype,"variables",void 0),Object(X["a"])([Object(z["c"])({default:!1})],e.prototype,"visible",void 0),Object(X["a"])([Object(z["c"])()],e.prototype,"options",void 0),Object(X["a"])([Object(z["c"])()],e.prototype,"action",void 0),Object(X["a"])([Object(z["e"])("visible")],e.prototype,"onVisibleChanged",null),Object(X["a"])([Object(z["e"])("options")],e.prototype,"onOptionsChanged",null),Object(X["a"])([Object(z["b"])("complete")],e.prototype,"onOk",null),Object(X["a"])([Object(z["b"])("cancel")],e.prototype,"onCancel",null),e=Object(X["a"])([Object(z["a"])({components:{"aw-empty":_r}})],e),e}(),Ec=Sc;function Ic(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function xc(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ic(Object(n),!0).forEach((function(t){$c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ic(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function $c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Tc(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,o)}function Dc(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){Tc(a,r,o,i,s,"next",e)}function s(e){Tc(a,r,o,i,s,"throw",e)}i(void 0)}))}}var jc={approveFirstNode:!0,unitCode:"",deptCode:""};function Pc(e){return Rc.apply(this,arguments)}function Rc(){return Rc=Dc(ce.a.mark((function e(t){var n,r,o,a,i,s,c,u,l,d,p,f,h,y,m,_,b,g,v,w;return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n={error:0,message:""},r=xc(xc({},jc),t),Tt("startWorkflow",["bizTypeCode","businessKey","userCode","rgCode"],r)){e.next=5;break}return r.onComplete&&(n.error=1,n.message="options中缺少必要参数",r.onComplete(n)),e.abrupt("return");case 5:return e.prev=5,o=[],t.variables&&(o=t.variables.map((function(e){return xc(xc({},e),{},{name:e.name.replace("$_","fvar_")})}))),a="",i="",r.bizExtra&&(a=r.bizExtra.bizTitle||"",i=r.bizExtra.bizUrl||""),e.next=13,Ae(r.businessKey);case 13:if(s=e.sent,!s){e.next=19;break}n.error=1,n.message="流程已经启动",e.next=57;break;case 19:return e.next=21,Ge({appCode:we.appCode,bizTypeCode:r.bizTypeCode,rgCode:r.rgCode,unitCode:r.unitCode,userCode:r.userCode,variables:o});case 21:if(c=e.sent,c){e.next=27;break}return n.error=1,n.message="查询流程定义第一节点错误",r.onComplete(n),e.abrupt("return");case 27:if(!r.approveFirstNode){e.next=52;break}if(u="1"===c.isCheckUsers,l=!0===r.isTextMessage,d="1"===c.sign,!(u||l||d)){e.next=43;break}return p=document.createElement("div"),f=document.createElement("div"),p.appendChild(f),document.body.appendChild(p),y=function(){h&&(h.$destroy(),p.parentNode&&p.parentNode.removeChild(p))},m=function(e){return new V["a"]({el:f,render:function(t){return t(bo,{attrs:{options:e.options,variables:e.variables,visible:e.visible},on:{cancel:e.onCancel,selected:e.onSelected}})}})},_={visible:!0,variables:o,options:{mode:"select",title:r.title,businessKey:r.businessKey,nodeId:c.nodeId,procDefId:c.procDefId,creatorCode:c.creatorCode,userCode:r.userCode,bizTypeCode:r.bizTypeCode,rgCode:r.rgCode,unitCode:r.unitCode,signType:r.signType,signRequired:r.signRequired,signImage:r.signImage,isTextMessage:r.isTextMessage,bizExtra:r.bizExtra,isSupportManualSign:r.isSupportManualSign,manualSignOptions:r.manualSignOptions},onCancel:function(){y(),r.onCancel&&r.onCancel()},onSelected:function(){var e=Dc(ce.a.mark((function e(t){return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return 0==t.error&&y(),r.onComplete(t),e.abrupt("return");case 3:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},h=m(_),e.abrupt("return");case 43:return b={appCode:we.appCode,bizTypeCode:r.bizTypeCode,businessKey:r.businessKey,rgCode:r.rgCode,unitCode:r.unitCode,userCode:r.userCode,creatorCode:c.creatorCode,variables:o,bizTitle:a,bizUrl:i},e.next=46,Fe(b);case 46:return g=e.sent,e.next=49,ot(g.taskId,{action:"complete",message:"",variables:o,deptCode:r.deptCode,bizTitle:a,bizUrl:i});case 49:n.extra={procInstId:g.id,businessKey:t.businessKey,procDefId:g.processDefinitionId,nodeId:g.nodeId,taskId:g.taskId};case 50:e.next=57;break;case 52:return v={appCode:we.appCode,bizTypeCode:r.bizTypeCode,businessKey:r.businessKey,rgCode:r.rgCode,unitCode:r.unitCode,userCode:r.userCode,variables:o,bizTitle:a,bizUrl:i},e.next=55,Fe(v);case 55:w=e.sent,n.extra={procInstId:w.id,businessKey:t.businessKey,procDefId:w.processDefinitionId,nodeId:w.nodeId,taskId:w.taskId};case 57:e.next=62;break;case 59:e.prev=59,e.t0=e["catch"](5),n=Gt(e.t0);case 62:r.onComplete&&r.onComplete(n);case 63:case"end":return e.stop()}}),e,null,[[5,59]])}))),Rc.apply(this,arguments)}function Nc(e){return Lc.apply(this,arguments)}function Lc(){return Lc=Dc(ce.a.mark((function e(t){var n,r,o,a,i,s,c,u,l,d,p,f,h,y,m,_;return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n={error:0,message:""},e.prev=1,Dt("workflow.approve",["businessKey","taskId","procDefId","nodeId"],["businessKey","menuId"],t)){e.next=4;break}throw{code:1,msg:"【缺少参数】businessKey, taskId, procDefId, nodeId或businessKey, menuId"};case 4:return e.next=6,Ft(t);case 6:if(r=e.sent,r){e.next=10;break}return Pt("查询工作流信息失败"),e.abrupt("return");case 10:return e.next=12,We({procDefId:r.procDefId,nodeId:r.nodeId});case 12:if(o=e.sent,a=[],t.variables&&(a=t.variables.map((function(e){return xc(xc({},e),{},{name:e.name.replace("$_","fvar_")})}))),i=!0===t.isTextMessage,i||"1"!==o.isFirstUserTaskNode||"0"!==o.isCheckUsers){e.next=31;break}if(s=t.taskId?t.taskId:t.businessKey,c=t.taskId?ot:at,s){e.next=21;break}throw{code:1,msg:"【请求参数】缺少taskId或businessKey"};case 21:return u={},t.taskId||(u={menuId:t.menuId||""}),l="",d="",t.bizExtra&&(l=t.bizExtra.bizTitle||"",d=t.bizExtra.bizUrl||""),e.next=28,c(s,xc({action:"complete",message:"",variables:a,deptCode:t.deptCode||"",bizTitle:l,bizUrl:d},u));case 28:t.onComplete&&t.onComplete(n),e.next=40;break;case 31:return p=document.createElement("div"),f=document.createElement("div"),p.appendChild(f),document.body.appendChild(p),y=function(){h&&(h.$destroy(),p.parentNode&&p.parentNode.removeChild(p))},m=function(e){return new V["a"]({el:f,render:function(t){return t(bo,{attrs:{options:e.options,visible:e.visible,variables:e.variables},on:{cancel:e.onCancel,complete:e.onComplete}})}})},_={visible:!0,options:t,variables:a,onCancel:function(){y(),t.onCancel&&t.onCancel()},onComplete:function(){var e=Dc(ce.a.mark((function e(n){return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return 0==n.error&&y(),t.onComplete&&t.onComplete(n),e.abrupt("return");case 3:case"end":return e.stop()}}),e)})));function n(t){return e.apply(this,arguments)}return n}()},h=m(_),e.abrupt("return");case 40:e.next=46;break;case 42:e.prev=42,e.t0=e["catch"](1),n=Gt(e.t0),t.onComplete&&t.onComplete(n);case 46:case"end":return e.stop()}}),e,null,[[1,42]])}))),Lc.apply(this,arguments)}function Ac(e){return Mc.apply(this,arguments)}function Mc(){return Mc=Dc(ce.a.mark((function e(t){var n,r,o,a,i,s,c;return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n={error:0},e.prev=1,Dt("workflow-delegate",["taskId","unitCode"],["businessKey","unitCode"],t)){e.next=4;break}throw{code:1,msg:"taskId, unitCode或businessKey, unitCode"};case 4:t.title=t.title||"代办",r=document.createElement("div"),o=document.createElement("div"),r.appendChild(o),document.body.appendChild(r),i=function(){a&&(a.$destroy(),r.parentNode&&r.parentNode.removeChild(r))},s=function(e){return new V["a"]({el:o,render:function(t){return t(Ec,{attrs:{action:"delegate",options:e.options,visible:e.visible},on:{cancel:e.onCancel,complete:e.onComplete}})}})},c={visible:!0,options:t,onCancel:function(){i(),t.onCancel&&t.onCancel()},onComplete:function(){var e=Dc(ce.a.mark((function e(n){return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return 0==n.error&&i(),t.onComplete&&t.onComplete(n),e.abrupt("return");case 3:case"end":return e.stop()}}),e)})));function n(t){return e.apply(this,arguments)}return n}()},a=s(c),e.next=19;break;case 15:e.prev=15,e.t0=e["catch"](1),n=Gt(e.t0),t.onComplete&&t.onComplete(n);case 19:case"end":return e.stop()}}),e,null,[[1,15]])}))),Mc.apply(this,arguments)}function Uc(e){return Fc.apply(this,arguments)}function Fc(){return Fc=Dc(ce.a.mark((function e(t){var n,r,o,a,i,s,c;return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n={error:0},e.prev=1,Dt("workflow-delegate",["taskId","unitCode"],["businessKey","unitCode"],t)){e.next=4;break}throw{code:1,msg:"taskId, unitCode或businessKey, unitCode"};case 4:t.title=t.title||"转办",r=document.createElement("div"),o=document.createElement("div"),r.appendChild(o),document.body.appendChild(r),i=function(){a&&(a.$destroy(),r.parentNode&&r.parentNode.removeChild(r))},s=function(e){return new V["a"]({el:o,render:function(t){return t(Ec,{attrs:{action:"transfer",options:e.options,visible:e.visible},on:{cancel:e.onCancel,complete:e.onComplete}})}})},c={visible:!0,options:t,onCancel:function(){i(),t.onCancel&&t.onCancel()},onComplete:function(){var e=Dc(ce.a.mark((function e(n){return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return 0==n.error&&i(),t.onComplete&&t.onComplete(n),e.abrupt("return");case 3:case"end":return e.stop()}}),e)})));function n(t){return e.apply(this,arguments)}return n}()},a=s(c),e.next=19;break;case 15:e.prev=15,e.t0=e["catch"](1),n=Gt(e.t0),t.onComplete&&t.onComplete(n);case 19:case"end":return e.stop()}}),e,null,[[1,15]])}))),Fc.apply(this,arguments)}function Bc(e){return Kc.apply(this,arguments)}function Kc(){return Kc=Dc(ce.a.mark((function e(t){var n;return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(Tt("canTaskRevoke",["businessKey","taskId"],t)){e.next=2;break}throw{code:1,msg:"无效的options参数: 需要businessKey和taskId两个参数"};case 2:return e.next=4,dt(t.businessKey,t.taskId);case 4:return n=e.sent,e.abrupt("return",n&&"1"===n.permitCancel);case 6:case"end":return e.stop()}}),e)}))),Kc.apply(this,arguments)}function Wc(e){return Gc.apply(this,arguments)}function Gc(){return Gc=Dc(ce.a.mark((function e(t){var n,r,o,a,i;return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n={error:0,message:"",extra:{}},e.prev=1,Dt("revoke",["businessKey"],["procDefId","procInstId","nodeId"],t)){e.next=4;break}throw{code:1,msg:"procDefId, procInstId, nodeId或businessKey"};case 4:if(r="",o="",t.bizExtra&&(r=t.bizExtra.bizTitle||"",o=t.bizExtra.bizUrl||""),a=(t.variables||[]).map((function(e){return xc(xc({},e),{},{name:e.name.replace("$_","fvar_")})})),!t.businessKey){e.next=14;break}return e.next=11,ut(t.businessKey,{variables:a,bizUrl:o,bizTitle:r});case 11:n.extra=e.sent,e.next=21;break;case 14:return e.next=16,Xe({procDefId:t.procDefId,nodeId:t.nodeId,procInstId:t.procInstId});case 16:if(i=e.sent,!(i&&i.length>0)){e.next=21;break}return e.next=20,ct(t.procInstId,{variables:a,bizUrl:o,bizTitle:r,currentActivityIds:[i[0].nodeId],targetActivityIds:[t.nodeId]});case 20:n.extra=e.sent;case 21:e.next=26;break;case 23:e.prev=23,e.t0=e["catch"](1),n=Gt(e.t0);case 26:t.onComplete&&t.onComplete(n);case 27:case"end":return e.stop()}}),e,null,[[1,23]])}))),Gc.apply(this,arguments)}function Vc(e){return Xc.apply(this,arguments)}function Xc(){return Xc=Dc(ce.a.mark((function e(t){var n,r,o;return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n={error:0,message:""},e.prev=1,Tt("activateWorkflow",["businessKey"],t)){e.next=4;break}throw{code:1,msg:"【缺少参数】 businessKey"};case 4:return r=(t.variables||[]).map((function(e){return xc(xc({},e),{},{name:e.name.replace("$_","fvar_")})})),e.next=7,yt(t.businessKey,{variables:r});case 7:o=e.sent,n.extra={taskId:o.taskId},e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](1),n=Gt(e.t0);case 14:t.onComplete&&t.onComplete(n);case 15:case"end":return e.stop()}}),e,null,[[1,11]])}))),Xc.apply(this,arguments)}function zc(e){return Hc.apply(this,arguments)}function Hc(){return Hc=Dc(ce.a.mark((function e(t){var n,r,o,a,i,s,c;return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(console.log("workflow.back",t),n={error:0,message:""},e.prev=2,Tt("back",["procInstId","procDefId","nodeId","taskId"],t)){e.next=5;break}throw{code:1,msg:"【缺少参数】procInstId, procDefId, nodeId, taskId"};case 5:r=document.createElement("div"),o=document.createElement("div"),r.appendChild(o),document.body.appendChild(r),i=function(){a&&(a.$destroy(),r.parentNode&&r.parentNode.removeChild(r))},s=function(e){return new V["a"]({el:o,render:function(t){return t(Uo,{attrs:{options:e.options,visible:e.visible},on:{cancel:e.onCancel,complete:e.onComplete}})}})},c={visible:!0,options:t,onCancel:function(){i(),t.onCancel&&t.onCancel()},onComplete:function(){var e=Dc(ce.a.mark((function e(n){return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return 0==n.error&&i(),t.onComplete&&t.onComplete(n),e.abrupt("return");case 3:case"end":return e.stop()}}),e)})));function n(t){return e.apply(this,arguments)}return n}()},a=s(c),e.next=19;break;case 15:e.prev=15,e.t0=e["catch"](2),n=Gt(e.t0),t.onComplete&&t.onComplete(n);case 19:case"end":return e.stop()}}),e,null,[[2,15]])}))),Hc.apply(this,arguments)}function qc(e){return Yc.apply(this,arguments)}function Yc(){return Yc=Dc(ce.a.mark((function e(t){var n,r,o,a,i,s,c,u,l,d,p;return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(console.log("workflow.batchApprove",t),n={error:0,message:""},e.prev=2,r=void 0===t.isTextMessage||!0===t.isTextMessage,o=t.signType&&!0===t.signRequired,!r&&!o){e.next=16;break}a=document.createElement("div"),i=document.createElement("div"),a.appendChild(i),document.body.appendChild(a),c=function(){s&&(s.$destroy(),a.parentNode&&a.parentNode.removeChild(a))},u=function(e){return new V["a"]({el:i,render:function(t){return t(ec,{attrs:{options:e.options,visible:e.visible},on:{cancel:e.onCancel,complete:e.onComplete}})}})},l={visible:!0,options:t,onCancel:function(){c(),t.onCancel&&t.onCancel()},onComplete:function(){var e=Dc(ce.a.mark((function e(n){return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return 0==n.error&&c(),t.onComplete&&t.onComplete(n),e.abrupt("return");case 3:case"end":return e.stop()}}),e)})));function n(t){return e.apply(this,arguments)}return n}()},s=u(l),e.next=25;break;case 16:if(t.list&&0!=t.list.length){e.next=18;break}throw{code:1,msg:"请选择批量送审的单据"};case 18:if(d=t.list.map((function(e){return e.taskId})),d&&0!=d.length){e.next=21;break}throw{code:1,msg:"请选择批量送审的单据"};case 21:return p={userCode:we.userCode,signObject:null,message:"",taskFormRequests:t.list.map((function(e){return{businessKey:e.businessKey,variables:e.variables,bizTitle:e.bizTitle||"",bizUrl:e.bizUrl||""}}))},e.next=24,_t(d.join(","),p);case 24:t.onComplete&&t.onComplete(n);case 25:e.next=31;break;case 27:e.prev=27,e.t0=e["catch"](2),n=Gt(e.t0),t.onComplete&&t.onComplete(n);case 31:case"end":return e.stop()}}),e,null,[[2,27]])}))),Yc.apply(this,arguments)}function Jc(e){return Qc.apply(this,arguments)}function Qc(){return Qc=Dc(ce.a.mark((function e(t){var n,r,o,a,i,s;return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(console.log("workflow.back",t),n={error:0,message:""},e.prev=2,Tt("workflow.back",["taskId"],t)){e.next=5;break}throw{code:1,msg:"【缺少参数】taskId"};case 5:return e.next=7,gt(t.taskId);case 7:if(r=e.sent,o=!!r&&"1"===r.isBackTask,o){e.next=11;break}throw{code:1,msg:"当前任务不支持直接送审"};case 11:return a="",i="",t.bizExtra&&(a=t.bizExtra.bizTitle||"",i=t.bizExtra.bizUrl||""),s=[],t.variables&&(s=t.variables.map((function(e){return xc(xc({},e),{},{name:e.name.replace("$_","fvar_")})}))),e.next=18,bt(t.taskId,{bizTitle:a,bizUrl:i,variables:s,userCode:we.userCode});case 18:t.onComplete&&t.onComplete(n),e.next=25;break;case 21:e.prev=21,e.t0=e["catch"](2),n=Gt(e.t0),t.onComplete&&t.onComplete(n);case 25:case"end":return e.stop()}}),e,null,[[2,21]])}))),Qc.apply(this,arguments)}function Zc(e){return eu.apply(this,arguments)}function eu(){return eu=Dc(ce.a.mark((function e(t){var n;return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(console.log("workflow.suspend",t),n={error:0,message:""},e.prev=2,Tt("workflow.suspend",["businessKey"],t)){e.next=5;break}throw{code:1,msg:"【缺少参数】businessKey"};case 5:return e.next=7,Be(t.businessKey);case 7:t.onComplete&&t.onComplete(n),e.next=14;break;case 10:e.prev=10,e.t0=e["catch"](2),n=Gt(e.t0),t.onComplete&&t.onComplete(n);case 14:case"end":return e.stop()}}),e,null,[[2,10]])}))),eu.apply(this,arguments)}function tu(e){return nu.apply(this,arguments)}function nu(){return nu=Dc(ce.a.mark((function e(t){var n;return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(console.log("workflow.resume",t),n={error:0,message:""},e.prev=2,Tt("workflow.resume",["businessKey"],t)){e.next=5;break}throw{code:1,msg:"【缺少参数】businessKey"};case 5:return e.next=7,Ke(t.businessKey);case 7:t.onComplete&&t.onComplete(n),e.next=14;break;case 10:e.prev=10,e.t0=e["catch"](2),n=Gt(e.t0),t.onComplete&&t.onComplete(n);case 14:case"end":return e.stop()}}),e,null,[[2,10]])}))),nu.apply(this,arguments)}function ru(e){return ou.apply(this,arguments)}function ou(){return ou=Dc(ce.a.mark((function e(t){return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Ue(t));case 1:case"end":return e.stop()}}),e)}))),ou.apply(this,arguments)}function au(e){return iu.apply(this,arguments)}function iu(){return iu=Dc(ce.a.mark((function e(t){var n,r,o;return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=[],r=new Map,e.prev=2,e.next=5,hn(t);case 5:if(e.t0=e.sent,e.t0){e.next=8;break}e.t0=[];case 8:if(n=e.t0,!(n.length>0)){e.next=14;break}return e.next=12,pt({ids:n.map((function(e){return e.userCode})).join(","),type:"user"});case 12:o=e.sent,o&&o.forEach((function(e){r.set(e.userCode,e.userName)}));case 14:return e.abrupt("return",n.map((function(e){var t=la()(e.createTime,"YYYY-MM-DD HH:mm:ss.S"),n="";return e.userCode&&r.has(e.userCode)&&(n=r.get(e.userCode)||""),{nodeId:e.nodeId,nodeName:e.nodeName,signImage:e.signImage,manualSignImage:e.manualSignImage,createTime:e.createTime,date:t.format("YYYY-M-D"),time:t.format("HH:mm:ss"),userCode:e.userCode,userName:n,signMessage:e.signMessage}})));case 17:return e.prev=17,e.t1=e["catch"](2),e.abrupt("return",[]);case 20:case"end":return e.stop()}}),e,null,[[2,17]])}))),iu.apply(this,arguments)}function su(){return cu.apply(this,arguments)}function cu(){return cu=Dc(ce.a.mark((function e(){return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",yn());case 1:case"end":return e.stop()}}),e)}))),cu.apply(this,arguments)}function uu(e){return lu.apply(this,arguments)}function lu(){return lu=Dc(ce.a.mark((function e(t){var n;return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Ue(t);case 2:if(n=e.sent,!n){e.next=7;break}return e.next=6,vt(n.procInstId);case 6:return e.abrupt("return",e.sent);case 7:return e.abrupt("return",[]);case 8:case"end":return e.stop()}}),e)}))),lu.apply(this,arguments)}function du(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,o)}function pu(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){du(a,r,o,i,s,"next",e)}function s(e){du(a,r,o,i,s,"throw",e)}i(void 0)}))}}function fu(e){return hu.apply(this,arguments)}function hu(){return hu=pu(ce.a.mark((function e(t){return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.abrupt("return",Me(t));case 4:return e.prev=4,e.t0=e["catch"](0),e.abrupt("return",!1);case 7:case"end":return e.stop()}}),e,null,[[0,4]])}))),hu.apply(this,arguments)}function yu(e){return mu.apply(this,arguments)}function mu(){return mu=pu(ce.a.mark((function e(t){return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.abrupt("return",Ae(t));case 4:return e.prev=4,e.t0=e["catch"](0),e.abrupt("return",!1);case 7:case"end":return e.stop()}}),e,null,[[0,4]])}))),mu.apply(this,arguments)}function _u(e){return bu.apply(this,arguments)}function bu(){return bu=pu(ce.a.mark((function e(t){var n;return ce.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,gt(t);case 3:return n=e.sent,e.abrupt("return",!!n&&"1"===n.isBackTask);case 7:return e.prev=7,e.t0=e["catch"](0),e.abrupt("return",!1);case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),bu.apply(this,arguments)}function gu(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function vu(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?gu(Object(n),!0).forEach((function(t){wu(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gu(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function wu(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ku={debug:!1};function Ou(e){var t=vu(vu({},ku),e);we.setDebug(t.debug),Tt("workflow.config",["userCode","appCode","rgCode","flowModelerBaseUrl","flowProcessBaseUrl"],t)&&($e.onError((function(e,n){var r=n.message;n.code&&(r="".concat(n.code,":").concat(n.msg)),t.debug&&(r+=" ".concat(e," ")),Pt(r)})),we.setBaseAddress(t.flowModelerBaseUrl,t.flowProcessBaseUrl),t.userCode&&we.setUserCode(t.userCode),t.appCode&&we.setAppCode(t.appCode),t.rgCode&&we.setRegionCode(t.rgCode),t.token&&we.setAuthToken(t.token),su().then((function(e){e&&we.setData(e)})))}var Cu={useAntd:!0};function Su(e,t){vu(vu({},Cu),t);e.component("workflow-approve",bo),e.component("workflow-reject",Uo),e.component("workflow-flow",ca),e.component("workflow-trace-simple",ca),e.component("workflow-trace-full",Xi),e.component("workflow-trace-form",ys),e.component("workflow-trace-list",Ms),V["a"].component("aw-button",N["a"]),V["a"].component("aw-checkbox",D["a"]),V["a"].component("aw-col",T["a"]),V["a"].component("aw-dropdown",I["a"]),V["a"].component("aw-form",E["a"]),V["a"].component("aw-icon",S["a"]),V["a"].component("aw-input",C["a"]),V["a"].component("aw-textarea",C["a"].TextArea),V["a"].component("aw-input-search",C["a"].Search),V["a"].component("aw-list",w["b"]),V["a"].component("aw-list-item",w["b"].Item),V["a"].component("aw-menu",g["a"]),V["a"].component("aw-menu-item",g["a"].Item),V["a"].component("aw-modal",b["a"]),V["a"].component("aw-pagination",_["a"]),V["a"].component("aw-popover",y["a"]),V["a"].component("aw-radio",h["a"]),V["a"].component("aw-radio-group",h["a"].Group),V["a"].component("aw-row",f["a"]),V["a"].component("aw-select",p["d"]),V["a"].component("aw-select-option",p["d"].Option),V["a"].component("aw-steps",l["a"]),V["a"].component("aw-step",l["a"].Step),V["a"].component("aw-table",c["a"]),V["a"].component("aw-tree",s["a"]),V["a"].component("aw-tree-select",i["a"]),V["a"].component("aw-tree-node",s["a"].TreeNode),V["a"].component("aw-tabs",a["a"]),V["a"].component("aw-tab-panel",a["a"].TabPane),V["a"].component("aw-tag",o["a"])}var Eu={install:Su,config:Ou,ready:function(e){},start:Pc,approve:Nc,delegate:Ac,transfer:Uc,cancel:Wc,activate:Vc,back:zc,batchApprove:qc,suspend:Zc,resume:tu,directApprove:Jc,validator:{canTaskCancel:Bc,isWorkflowStarted:yu,isWorkflowEnded:fu,isTaskDirectApprove:_u},extra:{getWorkflowInfo:ru,getProcessVariables:uu},getWorkflowInfo:ru,getSignData:au};n("ef07");function Iu(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function $u(e,t,n){return t&&xu(e.prototype,t),n&&xu(e,n),e}var Tu=function(){function e(){Iu(this,e),this._events=new Map}return $u(e,[{key:"on",value:function(e,t){console.log("on",e),this._events.has(e)&&this._events.delete(e),this._events.set(e,t)}},{key:"emit",value:function(e,t){console.log("emit",e),this._events.has(e)&&this._events.get(e)(t)}},{key:"off",value:function(e){console.log("off",e),this._events.has(e)&&this._events.delete(e)}}]),e}(),Du=new Tu;window.emiter=window.emiter||Du;var ju=Du;function Pu(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ru(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Pu(Object(n),!0).forEach((function(t){Nu(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Pu(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Nu(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}ju.on("config",(function(e){Eu.config(e)})),ju.on("start",(function(e){Eu.start(e)})),ju.on("approve",(function(e){Eu.approve(e)})),ju.on("cancel",(function(e){Eu.cancel(e)})),ju.on("back",(function(e){Eu.back(e)})),ju.on("activate",(function(e){Eu.activate(e)})),ju.on("batchApprove",(function(e){Eu.batchApprove(e)})),ju.on("delegate",(function(e){Eu.delegate(e)})),ju.on("transfer",(function(e){Eu.transfer(e)})),ju.on("suspend",(function(e){Eu.suspend(e)})),ju.on("resume",(function(e){Eu.resume(e)})),ju.on("directApprove",(function(e){Eu.directApprove(e)})),ju.on("canTaskCancel",(function(e){Eu.validator.canTaskCancel(e).then((function(t){e.onComplete(t)}))})),ju.on("isWorkflowStarted",(function(e){Eu.validator.isWorkflowStarted(e.businessKey).then((function(t){e.onComplete(t)}))})),ju.on("isWorkflowEnded",(function(e){Eu.validator.isWorkflowEnded(e.businessKey).then((function(t){e.onComplete(t)}))})),ju.on("activateWorkflow",(function(e){Vc(e).then((function(t){e.onComplete(t)}))})),ju.on("workflow-trace-full",(function(e){new V["a"]({render:function(t){return t("workflow-trace-full",{attrs:{options:Ru(Ru({},e),{},{id:void 0})}})}}).$mount(e.id)})),ju.on("workflow-trace-list",(function(e){new V["a"]({render:function(t){return t("workflow-trace-list",{attrs:{options:Ru(Ru({},e),{},{id:void 0})}})}}).$mount(e.id)})),V["a"].config.productionTip=!1,V["a"].prototype.$notification=G["a"],V["a"].prototype.$message=W["a"],V["a"].use(K["a"]),V["a"].use(B["a"]),V["a"].use(F["a"]),V["a"].use(U["a"]),V["a"].use(M["a"]),V["a"].use(A["a"]),V["a"].use(L["a"]),V["a"].use(N["a"]),V["a"].use(R["a"]),V["a"].use(P["a"]),V["a"].use(j["a"]),V["a"].use(D["a"]),V["a"].use(T["a"]),V["a"].use($["a"]),V["a"].use(x["a"]),V["a"].use(I["a"]),V["a"].use(E["a"]),V["a"].use(S["a"]),V["a"].use(C["a"]),V["a"].use(O["a"]),V["a"].use(k["a"]),V["a"].use(w["b"]),V["a"].use(v["b"]),V["a"].use(g["a"]),V["a"].use(b["a"]),V["a"].use(_["a"]),V["a"].use(m["a"]),V["a"].use(y["a"]),V["a"].use(h["a"]),V["a"].use(f["a"]),V["a"].use(p["d"]),V["a"].use(d["a"]),V["a"].use(l["a"]),V["a"].use(u["a"]),V["a"].use(c["a"]),V["a"].use(s["a"]),V["a"].use(i["a"]),V["a"].use(a["a"]),V["a"].use(o["a"]),V["a"].use(r["a"]),V["a"].use(Eu),new V["a"]({render:function(e){return e(ie)}}).$mount("#app")},d933:function(e,t){},df75:function(e,t){},ea81:function(e,t){},ef07:function(e,t,n){},feaa:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e["NotStart"]=0]="NotStart",e[e["Approved"]=1]="Approved",e[e["Process"]=2]="Process",e[e["Back"]=3]="Back",e[e["Backed"]=4]="Backed",e[e["Cancel"]=5]="Cancel",e[e["Submitted"]=6]="Submitted",e[e["Submitting"]=7]="Submitting",e[e["Discard"]=8]="Discard"}(r||(r={}))},fee2:function(e,t,n){"use strict";n("ea81");var r=n("80f3");n.d(t,"FbpmStatus",(function(){return r["a"]}));n("df75");var o=n("feaa");n.d(t,"TaskState",(function(){return o["a"]}));n("7af9"),n("4054"),n("372e"),n("b73b"),n("d933")}});